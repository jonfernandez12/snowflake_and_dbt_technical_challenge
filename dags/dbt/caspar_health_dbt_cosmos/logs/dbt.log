[0m11:51:36.744967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11089d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11358bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11358bd90>]}


============================== 11:51:36.814454 | e395d8f9-12bb-4c24-9ab8-2d2685f58b16 ==============================
[0m11:51:36.814454 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:51:36.815166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt init', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:51:49.809417 [debug] [MainThread]: Starter project path: /Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.13/site-packages/dbt/include/starter_project
[0m11:51:49.835839 [info ] [MainThread]: 
Your new dbt project "caspar_health_dbt" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m11:51:49.836345 [info ] [MainThread]: Setting up your profile.
[0m11:52:37.921950 [info ] [MainThread]: Profile caspar_health_dbt written to /Users/jonfernandez/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m11:52:37.924814 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 61.25999, "process_in_blocks": "0", "process_kernel_time": 1.070293, "process_mem_max_rss": "122929152", "process_out_blocks": "0", "process_user_time": 3.187711}
[0m11:52:37.925623 [debug] [MainThread]: Command `dbt init` succeeded at 11:52:37.925384 after 61.26 seconds
[0m11:52:37.926199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113870180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110862690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136f69c0>]}
[0m11:52:37.926727 [debug] [MainThread]: Flushing usage events
[0m15:59:47.378330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108371400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afc3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afc3ed0>]}


============================== 15:59:47.384475 | 05e004b7-0072-472e-aa0f-e895bf9e61a4 ==============================
[0m15:59:47.384475 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:59:47.385130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:59:47.385958 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /Users/jonfernandez/Documents/caspar_health_technical_challenge/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m15:59:47.386630 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.10019673, "process_in_blocks": "0", "process_kernel_time": 0.361666, "process_mem_max_rss": "91766784", "process_out_blocks": "0", "process_user_time": 1.339177}
[0m15:59:47.387188 [debug] [MainThread]: Command `dbt deps` failed at 15:59:47.387067 after 0.10 seconds
[0m15:59:47.387581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afca3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae9a210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10accbac0>]}
[0m15:59:47.387937 [debug] [MainThread]: Flushing usage events
[0m16:01:41.344047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104979400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b3ed0>]}


============================== 16:01:41.350274 | 76458318-aa64-4f5c-bad2-77cf200e38c2 ==============================
[0m16:01:41.350274 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:01:41.350855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:01:41.495084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76458318-aa64-4f5c-bad2-77cf200e38c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c7820>]}
[0m16:01:41.545018 [debug] [MainThread]: Set downloads directory='/var/folders/vq/_7867sy93s99l5mt0dcp4ddh0000gp/T/dbt-downloads-rui40r73'
[0m16:01:41.545809 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:01:41.844203 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:01:41.845055 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:01:41.883046 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:01:41.895572 [info ] [MainThread]: Updating lock file in file path: /Users/jonfernandez/Documents/caspar_health_technical_challenge/package-lock.yml
[0m16:01:41.898403 [debug] [MainThread]: Set downloads directory='/var/folders/vq/_7867sy93s99l5mt0dcp4ddh0000gp/T/dbt-downloads-9q1z0o10'
[0m16:01:41.901455 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:01:42.533466 [info ] [MainThread]: Installed from version 1.3.0
[0m16:01:42.534141 [info ] [MainThread]: Up to date!
[0m16:01:42.535004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '76458318-aa64-4f5c-bad2-77cf200e38c2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107717460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107717790>]}
[0m16:01:42.537496 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2788274, "process_in_blocks": "0", "process_kernel_time": 0.439449, "process_mem_max_rss": "97595392", "process_out_blocks": "0", "process_user_time": 1.507966}
[0m16:01:42.538180 [debug] [MainThread]: Command `dbt deps` succeeded at 16:01:42.538031 after 1.28 seconds
[0m16:01:42.538759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107731f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107490500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772d9a0>]}
[0m16:01:42.539196 [debug] [MainThread]: Flushing usage events
[0m16:24:56.305697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107769400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3a3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3a3ed0>]}


============================== 16:24:56.313430 | da802385-7b75-48c3-bd17-5a90fa4a9627 ==============================
[0m16:24:56.313430 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:24:56.314150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:24:56.590215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da802385-7b75-48c3-bd17-5a90fa4a9627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109279ba0>]}
[0m16:24:56.646075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da802385-7b75-48c3-bd17-5a90fa4a9627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a43c050>]}
[0m16:24:56.649769 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:24:56.770488 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:24:56.771528 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:24:56.771918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'da802385-7b75-48c3-bd17-5a90fa4a9627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af88050>]}
[0m16:24:57.970004 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.caspar_health_technical_challenge.enhanced_patients' (models/transform/enhanced_patients.sql) depends on a node named 'patients' which was not found
[0m16:24:57.971147 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7509098, "process_in_blocks": "0", "process_kernel_time": 0.386165, "process_mem_max_rss": "105369600", "process_out_blocks": "0", "process_user_time": 2.617388}
[0m16:24:57.972005 [debug] [MainThread]: Command `dbt run` failed at 16:24:57.971747 after 1.75 seconds
[0m16:24:57.972489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afd5f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afd73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2bfe70>]}
[0m16:24:57.972880 [debug] [MainThread]: Flushing usage events
[0m16:44:35.083337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107402000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107401cd0>]}


============================== 16:44:35.131479 | 0a5c3d87-0496-444d-895f-874ae76e2e47 ==============================
[0m16:44:35.131479 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:44:35.132500 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:44:37.807634 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "caspar_health_technical_challenge", target "dev" invalid: 'database' is a required property
[0m16:44:37.809790 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8110592, "process_in_blocks": "0", "process_kernel_time": 1.189493, "process_mem_max_rss": "126509056", "process_out_blocks": "0", "process_user_time": 3.515356}
[0m16:44:37.810406 [debug] [MainThread]: Command `dbt run` failed at 16:44:37.810290 after 2.81 seconds
[0m16:44:37.810848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a1a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e81c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653fb30>]}
[0m16:44:37.811237 [debug] [MainThread]: Flushing usage events
[0m16:45:07.198298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa2ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110544740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110544410>]}


============================== 16:45:07.204661 | f4daab33-a561-46f6-a558-cdc293e9dce8 ==============================
[0m16:45:07.204661 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:45:07.205377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:45:07.391904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4daab33-a561-46f6-a558-cdc293e9dce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb36a20>]}
[0m16:45:07.576396 [debug] [MainThread]: Set downloads directory='/var/folders/vq/_7867sy93s99l5mt0dcp4ddh0000gp/T/dbt-downloads-0f4ei8qa'
[0m16:45:07.576891 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:45:07.652775 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:45:07.653570 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:45:07.685893 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:45:07.689953 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:45:08.071936 [info ] [MainThread]: Installed from version 1.3.0
[0m16:45:08.072439 [info ] [MainThread]: Up to date!
[0m16:45:08.072843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f4daab33-a561-46f6-a558-cdc293e9dce8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110556510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110556090>]}
[0m16:45:08.074390 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9590073, "process_in_blocks": "0", "process_kernel_time": 0.473246, "process_mem_max_rss": "98467840", "process_out_blocks": "0", "process_user_time": 1.568914}
[0m16:45:08.074915 [debug] [MainThread]: Command `dbt deps` succeeded at 16:45:08.074797 after 0.96 seconds
[0m16:45:08.075286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb36a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa2ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11058de20>]}
[0m16:45:08.075633 [debug] [MainThread]: Flushing usage events
[0m16:46:06.430674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121cbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11223c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11223c1a0>]}


============================== 16:46:06.439199 | 18c2fcd5-22f4-4d22-8393-31d14e2fa055 ==============================
[0m16:46:06.439199 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:46:06.439880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt init', 'send_anonymous_usage_stats': 'True'}
[0m16:46:06.524595 [info ] [MainThread]: Setting up your profile.
[0m16:48:35.850468 [info ] [MainThread]: Profile caspar_health_technical_challenge written to /Users/jonfernandez/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m16:48:35.860525 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 149.51056, "process_in_blocks": "0", "process_kernel_time": 0.422425, "process_mem_max_rss": "108871680", "process_out_blocks": "0", "process_user_time": 1.543909}
[0m16:48:35.863013 [debug] [MainThread]: Command `dbt init` succeeded at 16:48:35.862443 after 149.52 seconds
[0m16:48:35.865310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11286e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121ebe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112624800>]}
[0m16:48:35.867100 [debug] [MainThread]: Flushing usage events
[0m16:49:04.111663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103916870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044385f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104438200>]}


============================== 16:49:04.119549 | 49aa1b7f-2749-4697-b287-ee728eeaf947 ==============================
[0m16:49:04.119549 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:49:04.120194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:49:04.796238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49aa1b7f-2749-4697-b287-ee728eeaf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f13e60>]}
[0m16:49:04.851943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49aa1b7f-2749-4697-b287-ee728eeaf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a7560>]}
[0m16:49:04.856437 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:49:05.011559 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:49:05.013150 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:49:05.013690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49aa1b7f-2749-4697-b287-ee728eeaf947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fff7d0>]}
[0m16:49:06.474517 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.caspar_health_technical_challenge.enhanced_patients' (models/transform/enhanced_patients.sql) depends on a node named 'patients' which was not found
[0m16:49:06.475327 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4527755, "process_in_blocks": "0", "process_kernel_time": 0.527238, "process_mem_max_rss": "119418880", "process_out_blocks": "0", "process_user_time": 2.973507}
[0m16:49:06.476000 [debug] [MainThread]: Command `dbt run` failed at 16:49:06.475875 after 2.45 seconds
[0m16:49:06.476404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104438290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10538bda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524a270>]}
[0m16:49:06.476862 [debug] [MainThread]: Flushing usage events
[0m16:49:24.031990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a11a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4289e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4286b0>]}


============================== 16:49:24.040284 | 536eee62-e03a-4060-9418-7fd444f47f27 ==============================
[0m16:49:24.040284 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:49:24.041529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:49:24.702638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '536eee62-e03a-4060-9418-7fd444f47f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107808b60>]}
[0m16:49:24.759857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '536eee62-e03a-4060-9418-7fd444f47f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab60a70>]}
[0m16:49:24.761968 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:49:24.906592 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:49:24.907718 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:49:24.908407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '536eee62-e03a-4060-9418-7fd444f47f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109568a40>]}
[0m16:49:26.024396 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m16:49:26.030466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '536eee62-e03a-4060-9418-7fd444f47f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109994cb0>]}
[0m16:49:26.125753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '536eee62-e03a-4060-9418-7fd444f47f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3d3c50>]}
[0m16:49:26.126346 [info ] [MainThread]: Found 577 macros
[0m16:49:26.126748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '536eee62-e03a-4060-9418-7fd444f47f27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b311100>]}
[0m16:49:26.128247 [info ] [MainThread]: 
[0m16:49:26.128815 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:49:26.129523 [debug] [MainThread]: Command end result
[0m16:49:26.166059 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2279196, "process_in_blocks": "0", "process_kernel_time": 0.53247, "process_mem_max_rss": "118624256", "process_out_blocks": "0", "process_user_time": 2.968682}
[0m16:49:26.166891 [debug] [MainThread]: Command `dbt run` succeeded at 16:49:26.166741 after 2.23 seconds
[0m16:49:26.167361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109932cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b288e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ca720>]}
[0m16:49:26.167733 [debug] [MainThread]: Flushing usage events
[0m16:55:27.271319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf0a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff28a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff286b0>]}


============================== 16:55:27.280100 | e27a6afe-61ac-4c18-8091-3967829fe3d9 ==============================
[0m16:55:27.280100 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:55:27.280790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:28.008171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e27a6afe-61ac-4c18-8091-3967829fe3d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104d15b0>]}
[0m16:55:28.065851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e27a6afe-61ac-4c18-8091-3967829fe3d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edda2d0>]}
[0m16:55:28.067845 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:55:28.226655 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:55:28.412154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:28.412799 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:28.413579 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m16:55:28.419423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e27a6afe-61ac-4c18-8091-3967829fe3d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a456d0>]}
[0m16:55:28.814765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e27a6afe-61ac-4c18-8091-3967829fe3d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c18bf0>]}
[0m16:55:28.815668 [info ] [MainThread]: Found 577 macros
[0m16:55:28.816145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e27a6afe-61ac-4c18-8091-3967829fe3d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ad69f0>]}
[0m16:55:28.818064 [info ] [MainThread]: 
[0m16:55:28.818554 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:55:28.820793 [debug] [MainThread]: Command end result
[0m16:55:28.851466 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6640742, "process_in_blocks": "0", "process_kernel_time": 0.459218, "process_mem_max_rss": "155656192", "process_out_blocks": "0", "process_user_time": 2.052664}
[0m16:55:28.852257 [debug] [MainThread]: Command `dbt test` succeeded at 16:55:28.852110 after 1.67 seconds
[0m16:55:28.852913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd83890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106d88c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106567b0>]}
[0m16:55:28.853346 [debug] [MainThread]: Flushing usage events
[0m16:55:44.193325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10992b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c3c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c3c530>]}


============================== 16:55:44.199941 | 43f1c8ca-dc65-4a9e-9c41-e33f6052c2f0 ==============================
[0m16:55:44.199941 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:55:44.200936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:44.965885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43f1c8ca-dc65-4a9e-9c41-e33f6052c2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a50d520>]}
[0m16:55:45.025129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43f1c8ca-dc65-4a9e-9c41-e33f6052c2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c092b0>]}
[0m16:55:45.026739 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:55:45.217755 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:55:45.369622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:45.370105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:45.370603 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m16:55:45.376477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43f1c8ca-dc65-4a9e-9c41-e33f6052c2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8370e0>]}
[0m16:55:45.503357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43f1c8ca-dc65-4a9e-9c41-e33f6052c2f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7113a0>]}
[0m16:55:45.504270 [info ] [MainThread]: Found 577 macros
[0m16:55:45.507018 [info ] [MainThread]: 
[0m16:55:45.507684 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:55:45.510132 [debug] [MainThread]: Command end result
[0m16:55:45.539402 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.4242655, "process_in_blocks": "0", "process_kernel_time": 0.614029, "process_mem_max_rss": "119144448", "process_out_blocks": "0", "process_user_time": 2.153978}
[0m16:55:45.540559 [debug] [MainThread]: Command `dbt build` succeeded at 16:55:45.540392 after 1.43 seconds
[0m16:55:45.541049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2d6c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c3c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c3c830>]}
[0m16:55:45.541565 [debug] [MainThread]: Flushing usage events
[0m17:01:12.880267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c17b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f28a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f28710>]}


============================== 17:01:12.886544 | 711dad48-bd9d-4c98-addc-311e4fd0dde5 ==============================
[0m17:01:12.886544 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:01:12.887246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:01:13.556485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '711dad48-bd9d-4c98-addc-311e4fd0dde5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ef4320>]}
[0m17:01:13.614784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '711dad48-bd9d-4c98-addc-311e4fd0dde5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114546c30>]}
[0m17:01:13.616281 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:01:13.768785 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:01:13.939185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:01:13.939645 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:01:13.940123 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m17:01:13.945663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '711dad48-bd9d-4c98-addc-311e4fd0dde5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b728d0>]}
[0m17:01:14.033246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '711dad48-bd9d-4c98-addc-311e4fd0dde5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e7e300>]}
[0m17:01:14.033787 [info ] [MainThread]: Found 577 macros
[0m17:01:14.034168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '711dad48-bd9d-4c98-addc-311e4fd0dde5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b0db80>]}
[0m17:01:14.035859 [info ] [MainThread]: 
[0m17:01:14.036277 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:01:14.038099 [debug] [MainThread]: Command end result
[0m17:01:14.065013 [info ] [MainThread]: 
[0m17:01:14.065682 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:01:14.066084 [info ] [MainThread]: 
[0m17:01:14.066481 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m17:01:14.067376 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.2705996, "process_in_blocks": "0", "process_kernel_time": 0.51581, "process_mem_max_rss": "117112832", "process_out_blocks": "0", "process_user_time": 2.030484}
[0m17:01:14.068267 [debug] [MainThread]: Command `dbt seed` succeeded at 17:01:14.068141 after 1.27 seconds
[0m17:01:14.068847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113eafe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113adb530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142b69f0>]}
[0m17:01:14.069365 [debug] [MainThread]: Flushing usage events
[0m17:02:05.031023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9e930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091786b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109178380>]}


============================== 17:02:05.040140 | b14f3ef9-57f4-4021-a87d-063988d5362b ==============================
[0m17:02:05.040140 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:02:05.040925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:02:05.818199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b14f3ef9-57f4-4021-a87d-063988d5362b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c7bc20>]}
[0m17:02:05.883985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b14f3ef9-57f4-4021-a87d-063988d5362b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914cd10>]}
[0m17:02:05.885655 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:02:06.044861 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:02:06.203844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m17:02:06.204545 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://seeds/patients.csv
[0m17:02:06.204976 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://seeds/exercises.csv
[0m17:02:06.205334 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://seeds/steps.csv
[0m17:02:06.434777 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m17:02:06.441664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b14f3ef9-57f4-4021-a87d-063988d5362b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1d71a0>]}
[0m17:02:06.542010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b14f3ef9-57f4-4021-a87d-063988d5362b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de96a0>]}
[0m17:02:06.542614 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m17:02:06.543168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b14f3ef9-57f4-4021-a87d-063988d5362b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c76360>]}
[0m17:02:06.545387 [info ] [MainThread]: 
[0m17:02:06.546298 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:02:06.551625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:02:06.566711 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:02:06.567185 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:02:06.567519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:08.232162 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:02:08.232645 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:02:08.233093 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:02:08.233428 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:02:08.233838 [debug] [ThreadPool]: On list_CASPAR_HEALTH: No close available on handle
[0m17:02:08.234655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:02:08.235034 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:02:08.235385 [info ] [MainThread]: 
[0m17:02:08.235887 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m17:02:08.236523 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    250003 (08001): 404 Not Found: post https://ZU61684.snowflakecomputing.com:443/session/v1/login-request?request_id=ba3cf639-5f7c-4720-a227-1e5c5d141cf8&databaseName=CASPAR_HEALTH&schemaName=PUBLIC&warehouse=dbt_developer_warehouse&roleName=dbt_developer_role&request_guid=976733dc-1d48-4dce-a1e4-fb1033ef6d26
[0m17:02:08.237292 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.2935216, "process_in_blocks": "0", "process_kernel_time": 0.678635, "process_mem_max_rss": "132136960", "process_out_blocks": "0", "process_user_time": 2.687403}
[0m17:02:08.238005 [debug] [MainThread]: Command `dbt seed` failed at 17:02:08.237867 after 3.29 seconds
[0m17:02:08.238538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091785c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a15b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d8b7d0>]}
[0m17:02:08.238973 [debug] [MainThread]: Flushing usage events
[0m17:03:07.894863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c2f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f38800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f384d0>]}


============================== 17:03:07.901164 | 67059a13-80e7-4a39-85f3-64044776a92b ==============================
[0m17:03:07.901164 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:03:07.901854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:03:08.548140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67059a13-80e7-4a39-85f3-64044776a92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bcb60>]}
[0m17:03:08.608139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67059a13-80e7-4a39-85f3-64044776a92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a95d9a0>]}
[0m17:03:08.609752 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:03:08.763009 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:03:08.964643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:03:08.965193 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:03:08.971271 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m17:03:08.990379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67059a13-80e7-4a39-85f3-64044776a92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3ba9c0>]}
[0m17:03:09.083841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67059a13-80e7-4a39-85f3-64044776a92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9cdbb0>]}
[0m17:03:09.084486 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m17:03:09.085127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67059a13-80e7-4a39-85f3-64044776a92b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106782180>]}
[0m17:03:09.087148 [info ] [MainThread]: 
[0m17:03:09.087869 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:03:09.093015 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:03:09.110248 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:03:09.110845 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:03:09.111192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:10.100465 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:03:10.100938 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:03:10.101380 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:03:10.101693 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:03:10.102088 [debug] [ThreadPool]: On list_CASPAR_HEALTH: No close available on handle
[0m17:03:10.102813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:10.103180 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:03:10.103518 [info ] [MainThread]: 
[0m17:03:10.103900 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m17:03:10.104423 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    250003 (08001): 404 Not Found: post https://ZU61684.snowflakecomputing.com:443/session/v1/login-request?request_id=5e919f70-7b1f-403f-8ca4-80859aaf7e48&databaseName=CASPAR_HEALTH&schemaName=PUBLIC&warehouse=dbt_developer_warehouse&roleName=dbt_developer_role&request_guid=1b285cec-b277-403d-a889-82870ad5e387
[0m17:03:10.105105 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.2908823, "process_in_blocks": "0", "process_kernel_time": 0.543619, "process_mem_max_rss": "127754240", "process_out_blocks": "0", "process_user_time": 2.183084}
[0m17:03:10.105667 [debug] [MainThread]: Command `dbt seed` failed at 17:03:10.105557 after 2.29 seconds
[0m17:03:10.106080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f38680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d90bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af35cd0>]}
[0m17:03:10.106437 [debug] [MainThread]: Flushing usage events
[0m17:05:01.999391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bb5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a258a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2586e0>]}


============================== 17:05:02.006154 | 229141c4-b84e-4969-b657-72d30352e188 ==============================
[0m17:05:02.006154 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:05:02.006870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:05:02.579747 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "caspar_health_technical_challenge", target "dev" invalid: None is not of type 'string'
[0m17:05:02.580996 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.66597235, "process_in_blocks": "0", "process_kernel_time": 0.425689, "process_mem_max_rss": "108253184", "process_out_blocks": "0", "process_user_time": 1.600604}
[0m17:05:02.581881 [debug] [MainThread]: Command `dbt seed` failed at 17:05:02.581697 after 0.67 seconds
[0m17:05:02.582561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7c6a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a998ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a984d10>]}
[0m17:05:02.583326 [debug] [MainThread]: Flushing usage events
[0m17:08:30.212838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdd2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c454740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c454410>]}


============================== 17:08:30.219978 | 5c919366-2aab-436e-8a82-4e4ab567c2c6 ==============================
[0m17:08:30.219978 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:08:30.220681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:08:30.946282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c919366-2aab-436e-8a82-4e4ab567c2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c42d280>]}
[0m17:08:31.009635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c919366-2aab-436e-8a82-4e4ab567c2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9a7200>]}
[0m17:08:31.011264 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:08:31.216541 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:08:31.292349 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:08:31.292931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5c919366-2aab-436e-8a82-4e4ab567c2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d36b7d0>]}
[0m17:08:32.686258 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m17:08:32.692324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c919366-2aab-436e-8a82-4e4ab567c2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d340e90>]}
[0m17:08:32.801440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c919366-2aab-436e-8a82-4e4ab567c2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d499d90>]}
[0m17:08:32.802020 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m17:08:32.802429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c919366-2aab-436e-8a82-4e4ab567c2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c42eae0>]}
[0m17:08:32.804418 [info ] [MainThread]: 
[0m17:08:32.805143 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:08:32.809888 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:08:32.824667 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:08:32.825317 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:08:32.825702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:08:33.940004 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:08:33.940500 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:08:33.940992 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:08:33.941335 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:08:33.941726 [debug] [ThreadPool]: On list_CASPAR_HEALTH: No close available on handle
[0m17:08:33.942515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:08:33.943015 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:08:33.943424 [info ] [MainThread]: 
[0m17:08:33.944295 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m17:08:33.944951 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    250003 (08001): 404 Not Found: post https://ZU61684.snowflakecomputing.com:443/session/v1/login-request?request_id=506a78e0-761e-4707-b29f-3a42f969be42&databaseName=CASPAR_HEALTH&schemaName=rehabilitation_data&warehouse=dbt_developer_warehouse&roleName=dbt_developer_role&request_guid=4e5dc802-36ea-4ca8-80c7-fdde307dc498
[0m17:08:33.945719 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.8173532, "process_in_blocks": "0", "process_kernel_time": 0.58836, "process_mem_max_rss": "128360448", "process_out_blocks": "0", "process_user_time": 3.395965}
[0m17:08:33.946317 [debug] [MainThread]: Command `dbt seed` failed at 17:08:33.946190 after 3.82 seconds
[0m17:08:33.946754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b59c230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d544c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d11b8c0>]}
[0m17:08:33.947136 [debug] [MainThread]: Flushing usage events
[0m17:09:01.899451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d677a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706c4d0>]}


============================== 17:09:01.905790 | 4a82dd25-43b3-4968-a2e3-f5bd3a68f4f5 ==============================
[0m17:09:01.905790 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:09:01.906457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:09:02.553296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a82dd25-43b3-4968-a2e3-f5bd3a68f4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a67dd0>]}
[0m17:09:02.614780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a82dd25-43b3-4968-a2e3-f5bd3a68f4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078792b0>]}
[0m17:09:02.616673 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:09:02.776136 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:09:02.862739 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:09:02.863927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a82dd25-43b3-4968-a2e3-f5bd3a68f4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0bbf0>]}
[0m17:09:04.309995 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m17:09:04.316048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a82dd25-43b3-4968-a2e3-f5bd3a68f4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e97470>]}
[0m17:09:04.418073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a82dd25-43b3-4968-a2e3-f5bd3a68f4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706dcd0>]}
[0m17:09:04.418643 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m17:09:04.419038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a82dd25-43b3-4968-a2e3-f5bd3a68f4f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045375f0>]}
[0m17:09:04.420901 [info ] [MainThread]: 
[0m17:09:04.421585 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:09:04.425731 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:09:04.441326 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:09:04.441997 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:09:04.442445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:05.444428 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:09:05.444930 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:09:05.445365 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:09:05.445669 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:09:05.446041 [debug] [ThreadPool]: On list_CASPAR_HEALTH: No close available on handle
[0m17:09:05.446753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:05.447117 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:09:05.447446 [info ] [MainThread]: 
[0m17:09:05.448212 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m17:09:05.448789 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    250003 (08001): 404 Not Found: post https://ZU61684.snowflakecomputing.com:443/session/v1/login-request?request_id=dfe1ffef-28fb-42b6-86dc-014b0caabc36&databaseName=CASPAR_HEALTH&schemaName=rehabilitation_data&warehouse=dbt_developer_warehouse&roleName=dbt_developer_role&request_guid=4ab73058-9967-4c28-86e9-3b5ea92c4903
[0m17:09:05.449423 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.6305547, "process_in_blocks": "0", "process_kernel_time": 0.573076, "process_mem_max_rss": "129003520", "process_out_blocks": "0", "process_user_time": 3.385245}
[0m17:09:05.449906 [debug] [MainThread]: Command `dbt seed` failed at 17:09:05.449804 after 3.63 seconds
[0m17:09:05.450327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080884a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e17f0>]}
[0m17:09:05.450716 [debug] [MainThread]: Flushing usage events
[0m17:12:07.685134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058122d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087547d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087544a0>]}


============================== 17:12:07.695689 | 6011e354-a6bf-4cd5-8bf7-593de47ed739 ==============================
[0m17:12:07.695689 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:12:07.696935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:12:08.394816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6011e354-a6bf-4cd5-8bf7-593de47ed739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109178110>]}
[0m17:12:08.461110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6011e354-a6bf-4cd5-8bf7-593de47ed739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ca5d00>]}
[0m17:12:08.462925 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:12:08.628931 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:12:08.692339 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:12:08.693008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6011e354-a6bf-4cd5-8bf7-593de47ed739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9a3c0>]}
[0m17:12:10.122706 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m17:12:10.129033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6011e354-a6bf-4cd5-8bf7-593de47ed739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10967ae70>]}
[0m17:12:10.229266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6011e354-a6bf-4cd5-8bf7-593de47ed739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109788050>]}
[0m17:12:10.229858 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m17:12:10.230279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6011e354-a6bf-4cd5-8bf7-593de47ed739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109695400>]}
[0m17:12:10.232382 [info ] [MainThread]: 
[0m17:12:10.233445 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:12:10.239494 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:12:10.256978 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:12:10.257478 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:12:10.257834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:11.216263 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:12:11.216731 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:12:11.217184 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:12:11.217535 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:12:11.217922 [debug] [ThreadPool]: On list_CASPAR_HEALTH: No close available on handle
[0m17:12:11.218624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:11.218979 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:12:11.219311 [info ] [MainThread]: 
[0m17:12:11.220135 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m17:12:11.220676 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    250003 (08001): 404 Not Found: post https://RG94457.snowflakecomputing.com:443/session/v1/login-request?request_id=f6a4d82a-a246-4f7f-9460-99431f60ee4a&databaseName=CASPAR_HEALTH&schemaName=rehabilitation_data&warehouse=dbt_developer_warehouse&roleName=dbt_developer_role&request_guid=7d5c7b36-3b0e-41d2-a325-dc6fad27b6fa
[0m17:12:11.221318 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.6250343, "process_in_blocks": "0", "process_kernel_time": 0.661311, "process_mem_max_rss": "130240512", "process_out_blocks": "0", "process_user_time": 3.55185}
[0m17:12:11.221996 [debug] [MainThread]: Command `dbt seed` failed at 17:12:11.221853 after 3.63 seconds
[0m17:12:11.222429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d6c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930d5b0>]}
[0m17:12:11.222810 [debug] [MainThread]: Flushing usage events
[0m17:12:48.664119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ece8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e3c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e3c4d0>]}


============================== 17:12:48.671233 | 8db72d86-8405-419f-8e0d-68768aae7dd9 ==============================
[0m17:12:48.671233 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:12:48.671904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:12:49.285817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8db72d86-8405-419f-8e0d-68768aae7dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128c7da0>]}
[0m17:12:49.346551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8db72d86-8405-419f-8e0d-68768aae7dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11212daf0>]}
[0m17:12:49.348228 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:12:49.511459 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:12:49.590506 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:12:49.591154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8db72d86-8405-419f-8e0d-68768aae7dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c5f2f0>]}
[0m17:12:51.006367 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m17:12:51.012329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8db72d86-8405-419f-8e0d-68768aae7dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112246000>]}
[0m17:12:51.102822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8db72d86-8405-419f-8e0d-68768aae7dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d89d90>]}
[0m17:12:51.103342 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m17:12:51.103705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8db72d86-8405-419f-8e0d-68768aae7dd9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129eec60>]}
[0m17:12:51.105530 [info ] [MainThread]: 
[0m17:12:51.106193 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:12:51.110704 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:12:51.124534 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:12:51.125040 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:12:51.125392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:52.511089 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:12:52.511568 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:12:52.511997 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:12:52.512330 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:12:52.512714 [debug] [ThreadPool]: On list_CASPAR_HEALTH: No close available on handle
[0m17:12:52.513401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:52.513763 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:12:52.514104 [info ] [MainThread]: 
[0m17:12:52.514492 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m17:12:52.514978 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    250003 (08001): 404 Not Found: post https://RG94457.snowflakecomputing.com:443/session/v1/login-request?request_id=19ee366a-2caa-4812-a2c9-efd7bac22ddd&databaseName=CASPAR_HEALTH&schemaName=rehabilitation_data&warehouse=dbt_developer_warehouse&roleName=dbt_developer_role&request_guid=59c24e32-4220-4b94-9fcb-edcc7b70b860
[0m17:12:52.515569 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.934019, "process_in_blocks": "0", "process_kernel_time": 0.531618, "process_mem_max_rss": "128544768", "process_out_blocks": "0", "process_user_time": 3.447247}
[0m17:12:52.516074 [debug] [MainThread]: Command `dbt seed` failed at 17:12:52.515970 after 3.93 seconds
[0m17:12:52.516473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e3c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128fbe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128c6d20>]}
[0m17:12:52.516831 [debug] [MainThread]: Flushing usage events
[0m17:14:06.748775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c307170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f65c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f65c530>]}


============================== 17:14:06.756825 | 55f1b45f-d15c-408d-9415-86cf3f042631 ==============================
[0m17:14:06.756825 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:14:06.757762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m17:14:07.462850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55f1b45f-d15c-408d-9415-86cf3f042631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e506660>]}
[0m17:14:07.526351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55f1b45f-d15c-408d-9415-86cf3f042631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f20dbb0>]}
[0m17:14:07.528287 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:14:07.686021 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:14:07.752226 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:14:07.752824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '55f1b45f-d15c-408d-9415-86cf3f042631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11056ba10>]}
[0m17:14:09.129928 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m17:14:09.136123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55f1b45f-d15c-408d-9415-86cf3f042631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110438ef0>]}
[0m17:14:09.229571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55f1b45f-d15c-408d-9415-86cf3f042631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11069a8d0>]}
[0m17:14:09.230118 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m17:14:09.230494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55f1b45f-d15c-408d-9415-86cf3f042631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110302ed0>]}
[0m17:14:09.232324 [info ] [MainThread]: 
[0m17:14:09.233002 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:14:09.237286 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:14:09.252554 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:14:09.253012 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:14:09.253647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:10.722884 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:14:10.723367 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:14:10.723812 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:14:10.724127 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:14:10.724512 [debug] [ThreadPool]: On list_CASPAR_HEALTH: No close available on handle
[0m17:14:10.725213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:10.725587 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:14:10.725931 [info ] [MainThread]: 
[0m17:14:10.726320 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m17:14:10.726809 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    250003 (08001): 404 Not Found: post https://rg94457.snowflakecomputing.com:443/session/v1/login-request?request_id=3fd3b784-be20-4394-91a7-03bf4eb645f4&databaseName=CASPAR_HEALTH&schemaName=rehabilitation_data&warehouse=dbt_developer_warehouse&roleName=dbt_developer_role&request_guid=1435305f-cb00-48db-905d-2465ceba97f8
[0m17:14:10.727426 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 4.0634475, "process_in_blocks": "0", "process_kernel_time": 0.625906, "process_mem_max_rss": "128823296", "process_out_blocks": "0", "process_user_time": 3.562792}
[0m17:14:10.727922 [debug] [MainThread]: Command `dbt seed` failed at 17:14:10.727815 after 4.06 seconds
[0m17:14:10.728322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efb5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11049e360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110745fd0>]}
[0m17:14:10.728688 [debug] [MainThread]: Flushing usage events
[0m17:14:15.025834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1a7f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa584a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa58170>]}


============================== 17:14:15.031517 | c26aaa2a-d992-485a-bda4-2bc8eff528b5 ==============================
[0m17:14:15.031517 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:14:15.032214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:14:15.594950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c26aaa2a-d992-485a-bda4-2bc8eff528b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11023bce0>]}
[0m17:14:15.657902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c26aaa2a-d992-485a-bda4-2bc8eff528b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa05c10>]}
[0m17:14:15.659263 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:14:15.792891 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:14:15.910350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:14:15.910795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:14:15.916162 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m17:14:15.934452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c26aaa2a-d992-485a-bda4-2bc8eff528b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108387a0>]}
[0m17:14:16.016346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c26aaa2a-d992-485a-bda4-2bc8eff528b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110838f50>]}
[0m17:14:16.016922 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m17:14:16.017685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c26aaa2a-d992-485a-bda4-2bc8eff528b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108a7110>]}
[0m17:14:16.019977 [info ] [MainThread]: 
[0m17:14:16.020665 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:14:16.024782 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:14:16.041265 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:14:16.041826 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:14:16.042176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:17.031984 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:14:17.032486 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:14:17.032943 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:14:17.033252 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:14:17.033639 [debug] [ThreadPool]: On list_CASPAR_HEALTH: No close available on handle
[0m17:14:17.034348 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:17.034704 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:14:17.035036 [info ] [MainThread]: 
[0m17:14:17.035392 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m17:14:17.035869 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    250003 (08001): 404 Not Found: post https://rg94457.snowflakecomputing.com:443/session/v1/login-request?request_id=41fafb50-56db-4ba7-82f7-b9776ba2fc57&databaseName=CASPAR_HEALTH&schemaName=rehabilitation_data&warehouse=dbt_developer_warehouse&roleName=dbt_developer_role&request_guid=1e4e86c2-f699-4008-a504-473a23f60753
[0m17:14:17.036515 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.0883713, "process_in_blocks": "0", "process_kernel_time": 0.432408, "process_mem_max_rss": "128143360", "process_out_blocks": "0", "process_user_time": 2.152928}
[0m17:14:17.037087 [debug] [MainThread]: Command `dbt seed` failed at 17:14:17.036978 after 2.09 seconds
[0m17:14:17.037497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa583e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7ce3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110abf9b0>]}
[0m17:14:17.037862 [debug] [MainThread]: Flushing usage events
[0m17:15:39.033491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a82a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108758710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087582f0>]}


============================== 17:15:39.041447 | 1745ba39-e69c-471b-b56a-52aa8c63e4bd ==============================
[0m17:15:39.041447 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:15:39.042223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:15:39.772072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1745ba39-e69c-471b-b56a-52aa8c63e4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10905b5c0>]}
[0m17:15:39.838901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1745ba39-e69c-471b-b56a-52aa8c63e4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076058e0>]}
[0m17:15:39.841158 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:15:40.007849 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:15:40.214476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:40.214968 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:40.221282 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m17:15:40.244255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1745ba39-e69c-471b-b56a-52aa8c63e4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093cecf0>]}
[0m17:15:40.349934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1745ba39-e69c-471b-b56a-52aa8c63e4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844d5e0>]}
[0m17:15:40.350550 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m17:15:40.351181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1745ba39-e69c-471b-b56a-52aa8c63e4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109393dd0>]}
[0m17:15:40.353123 [info ] [MainThread]: 
[0m17:15:40.353827 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:15:40.358291 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:15:40.375483 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:15:40.376019 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:15:40.376491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:41.464905 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:15:41.465387 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:15:41.465827 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:15:41.466135 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:15:41.466515 [debug] [ThreadPool]: On list_CASPAR_HEALTH: No close available on handle
[0m17:15:41.467234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:41.467589 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:15:41.467930 [info ] [MainThread]: 
[0m17:15:41.468369 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m17:15:41.468860 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    250003 (08001): 404 Not Found: post https://rg94457.snowflakecomputing.com:443/session/v1/login-request?request_id=2a84c061-d2fc-46ca-ae16-4d42911a605e&databaseName=CASPAR_HEALTH&schemaName=rehabilitation_data&warehouse=dbt_developer_warehouse&roleName=dbt_developer_role&request_guid=ef115d5b-8818-4b9d-bb12-91eb16d3323e
[0m17:15:41.469501 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.5239031, "process_in_blocks": "0", "process_kernel_time": 0.623407, "process_mem_max_rss": "127569920", "process_out_blocks": "0", "process_user_time": 2.299645}
[0m17:15:41.470043 [debug] [MainThread]: Command `dbt seed` failed at 17:15:41.469931 after 2.52 seconds
[0m17:15:41.470447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10807ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10957f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10981cef0>]}
[0m17:15:41.470799 [debug] [MainThread]: Flushing usage events
[0m17:16:23.436217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106420e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3c4a0>]}


============================== 17:16:23.443452 | 00c93a1a-84ef-41d8-987e-e2ce79c0e386 ==============================
[0m17:16:23.443452 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:16:23.444190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:16:24.135223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00c93a1a-84ef-41d8-987e-e2ce79c0e386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e1c920>]}
[0m17:16:24.198275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00c93a1a-84ef-41d8-987e-e2ce79c0e386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a012630>]}
[0m17:16:24.200182 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:16:24.358376 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:16:24.423358 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:16:24.423948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '00c93a1a-84ef-41d8-987e-e2ce79c0e386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f6e2a0>]}
[0m17:16:25.781296 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m17:16:25.786914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00c93a1a-84ef-41d8-987e-e2ce79c0e386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a0d100>]}
[0m17:16:25.879973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00c93a1a-84ef-41d8-987e-e2ce79c0e386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a542660>]}
[0m17:16:25.880513 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m17:16:25.880906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00c93a1a-84ef-41d8-987e-e2ce79c0e386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a830170>]}
[0m17:16:25.882670 [info ] [MainThread]: 
[0m17:16:25.883296 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:16:25.887485 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:16:25.901733 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:16:25.902219 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:16:25.902576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:26.939874 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:16:26.940526 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:16:26.941326 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:16:26.941699 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:16:26.942112 [debug] [ThreadPool]: On list_CASPAR_HEALTH: No close available on handle
[0m17:16:26.942833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:26.943169 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:16:26.943489 [info ] [MainThread]: 
[0m17:16:26.944299 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m17:16:26.944855 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    250003 (08001): 404 Not Found: post https://rg94457.snowflakecomputing.com:443/session/authenticator-request?request_guid=f7e40e9b-c6ac-4b23-abcf-7c139f44fa6d
[0m17:16:26.945508 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.5986435, "process_in_blocks": "0", "process_kernel_time": 0.583055, "process_mem_max_rss": "131366912", "process_out_blocks": "0", "process_user_time": 3.419515}
[0m17:16:26.945998 [debug] [MainThread]: Command `dbt seed` failed at 17:16:26.945895 after 3.60 seconds
[0m17:16:26.946377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a92d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8db710>]}
[0m17:16:26.946757 [debug] [MainThread]: Flushing usage events
[0m17:17:10.105950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104673710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104907a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104978500>]}


============================== 17:17:10.111916 | b58efb72-6ce4-4f90-b610-7663b63a3e37 ==============================
[0m17:17:10.111916 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:17:10.112579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m17:17:10.813526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b58efb72-6ce4-4f90-b610-7663b63a3e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101d34aa0>]}
[0m17:17:10.876899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b58efb72-6ce4-4f90-b610-7663b63a3e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd1a30>]}
[0m17:17:10.878569 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:17:11.031479 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:17:11.102704 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:17:11.103378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b58efb72-6ce4-4f90-b610-7663b63a3e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ebe090>]}
[0m17:17:12.512487 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m17:17:12.518625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b58efb72-6ce4-4f90-b610-7663b63a3e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105914ec0>]}
[0m17:17:12.613904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b58efb72-6ce4-4f90-b610-7663b63a3e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594e450>]}
[0m17:17:12.614429 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m17:17:12.614807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b58efb72-6ce4-4f90-b610-7663b63a3e37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105512660>]}
[0m17:17:12.616988 [info ] [MainThread]: 
[0m17:17:12.617699 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:17:12.621787 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:17:12.635613 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:17:12.636159 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:17:12.636533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:13.102301 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:17:13.102763 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:17:13.103202 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:17:13.103520 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:17:13.103906 [debug] [ThreadPool]: On list_CASPAR_HEALTH: No close available on handle
[0m17:17:13.104648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:13.105023 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:17:13.105352 [info ] [MainThread]: 
[0m17:17:13.106154 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m17:17:13.106783 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    390190 (08001): Failed to connect to DB: RG94457.EU-CENTRAL-1.snowflakecomputing.com:443, There was an error related to the SAML Identity Provider account parameter. Contact Snowflake support.
[0m17:17:13.107417 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.0851662, "process_in_blocks": "0", "process_kernel_time": 0.561125, "process_mem_max_rss": "130584576", "process_out_blocks": "0", "process_user_time": 3.423979}
[0m17:17:13.107904 [debug] [MainThread]: Command `dbt seed` failed at 17:17:13.107799 after 3.09 seconds
[0m17:17:13.108286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103abc230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b92a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b92d20>]}
[0m17:17:13.108639 [debug] [MainThread]: Flushing usage events
[0m17:18:14.038957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9f1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0586b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c058380>]}


============================== 17:18:14.046333 | 6afa0df9-9f75-477e-80f3-425353cbb4c8 ==============================
[0m17:18:14.046333 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:18:14.047106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:18:14.726844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6afa0df9-9f75-477e-80f3-425353cbb4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc0aa80>]}
[0m17:18:14.786530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6afa0df9-9f75-477e-80f3-425353cbb4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4842c0>]}
[0m17:18:14.788609 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:18:14.944996 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:18:15.010367 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:18:15.010993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6afa0df9-9f75-477e-80f3-425353cbb4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b59a420>]}
[0m17:18:16.388167 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m17:18:16.394170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6afa0df9-9f75-477e-80f3-425353cbb4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d021040>]}
[0m17:18:16.485006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6afa0df9-9f75-477e-80f3-425353cbb4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc0a180>]}
[0m17:18:16.485545 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m17:18:16.485936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6afa0df9-9f75-477e-80f3-425353cbb4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfd9c40>]}
[0m17:18:16.487751 [info ] [MainThread]: 
[0m17:18:16.488402 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:18:16.492642 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:18:16.507629 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:18:16.508091 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:18:16.508472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:17.039664 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:18:17.040169 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:18:17.040716 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:18:17.041032 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:18:17.041439 [debug] [ThreadPool]: On list_CASPAR_HEALTH: No close available on handle
[0m17:18:17.042277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:17.042586 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:18:17.042904 [info ] [MainThread]: 
[0m17:18:17.043251 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m17:18:17.043854 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    250001 (08001): Failed to connect to DB: RG94457.EU-CENTRAL-1.snowflakecomputing.com:443. Role 'DBT_DEVELOPER_ROLE' specified in the connect string is not granted to this user. Contact your local system administrator, or attempt to login with another role, e.g. PUBLIC.
[0m17:18:17.044578 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.0914352, "process_in_blocks": "0", "process_kernel_time": 0.563701, "process_mem_max_rss": "128475136", "process_out_blocks": "0", "process_user_time": 3.370452}
[0m17:18:17.045245 [debug] [MainThread]: Command `dbt seed` failed at 17:18:17.045132 after 3.09 seconds
[0m17:18:17.045664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0585f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8ab020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd020c0>]}
[0m17:18:17.046035 [debug] [MainThread]: Flushing usage events
[0m17:18:32.223675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c38350>]}


============================== 17:18:32.230806 | 030ff1c5-28d0-4331-8896-1e6360b20419 ==============================
[0m17:18:32.230806 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:18:32.231617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m17:18:33.009480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '030ff1c5-28d0-4331-8896-1e6360b20419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104020950>]}
[0m17:18:33.070573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '030ff1c5-28d0-4331-8896-1e6360b20419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f8380>]}
[0m17:18:33.072295 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:18:33.225141 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:18:33.291931 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:18:33.304739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '030ff1c5-28d0-4331-8896-1e6360b20419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10617a2a0>]}
[0m17:18:34.672454 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m17:18:34.677779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '030ff1c5-28d0-4331-8896-1e6360b20419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be4620>]}
[0m17:18:34.767915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '030ff1c5-28d0-4331-8896-1e6360b20419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c03320>]}
[0m17:18:34.768571 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m17:18:34.769019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '030ff1c5-28d0-4331-8896-1e6360b20419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107830c50>]}
[0m17:18:34.771064 [info ] [MainThread]: 
[0m17:18:34.771812 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:18:34.776127 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:18:34.791606 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:18:34.792146 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:18:34.792501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:35.239710 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:18:35.240193 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:18:35.240636 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:18:35.240952 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:18:35.241327 [debug] [ThreadPool]: On list_CASPAR_HEALTH: No close available on handle
[0m17:18:35.242087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:35.242470 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:18:35.242819 [info ] [MainThread]: 
[0m17:18:35.243195 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m17:18:35.243811 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    250001 (08001): Failed to connect to DB: RG94457.EU-CENTRAL-1.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m17:18:35.244488 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.0984614, "process_in_blocks": "0", "process_kernel_time": 0.562587, "process_mem_max_rss": "129761280", "process_out_blocks": "0", "process_user_time": 3.398888}
[0m17:18:35.245050 [debug] [MainThread]: Command `dbt seed` failed at 17:18:35.244927 after 3.10 seconds
[0m17:18:35.245477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc4230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3d220>]}
[0m17:18:35.246198 [debug] [MainThread]: Flushing usage events
[0m17:18:48.892585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107024e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c5c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c5c440>]}


============================== 17:18:48.898810 | b846c7ed-fac4-489a-ac4f-6c9d9ab5f322 ==============================
[0m17:18:48.898810 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:18:48.899570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:18:49.562692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b846c7ed-fac4-489a-ac4f-6c9d9ab5f322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111404830>]}
[0m17:18:49.623099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b846c7ed-fac4-489a-ac4f-6c9d9ab5f322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c2d640>]}
[0m17:18:49.624612 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:18:49.773844 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:18:49.940707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:18:49.941160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:18:49.946623 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m17:18:49.964687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b846c7ed-fac4-489a-ac4f-6c9d9ab5f322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118c9cd0>]}
[0m17:18:50.059823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b846c7ed-fac4-489a-ac4f-6c9d9ab5f322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a96d20>]}
[0m17:18:50.060372 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m17:18:50.060955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b846c7ed-fac4-489a-ac4f-6c9d9ab5f322', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11191a120>]}
[0m17:18:50.062859 [info ] [MainThread]: 
[0m17:18:50.063514 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:18:50.068623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:18:50.086369 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:18:50.086863 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:18:50.087199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:51.477403 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89c52-0203-b526-0000-000318c2a3d9
[0m17:18:51.477903 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:18:51.478392 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:18:51.478706 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:18:51.479091 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m17:18:51.750881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:51.751367 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:18:51.751708 [info ] [MainThread]: 
[0m17:18:51.752127 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m17:18:51.752729 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m17:18:51.753399 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.946105, "process_in_blocks": "0", "process_kernel_time": 0.532888, "process_mem_max_rss": "128401408", "process_out_blocks": "0", "process_user_time": 2.246212}
[0m17:18:51.754188 [debug] [MainThread]: Command `dbt seed` failed at 17:18:51.754046 after 2.95 seconds
[0m17:18:51.754649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115309e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d6baa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e98ef0>]}
[0m17:18:51.755036 [debug] [MainThread]: Flushing usage events
[0m17:20:03.648358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102473e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051446b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105144380>]}


============================== 17:20:03.656482 | 7c2b92b8-7384-45f6-95e7-f033287ba466 ==============================
[0m17:20:03.656482 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:20:03.657241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:20:04.384947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c2b92b8-7384-45f6-95e7-f033287ba466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b0440>]}
[0m17:20:04.446004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c2b92b8-7384-45f6-95e7-f033287ba466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f1b50>]}
[0m17:20:04.449769 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:20:04.612721 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:20:04.817413 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m17:20:04.818001 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://seeds/patients.csv
[0m17:20:04.818505 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/steps.csv
[0m17:20:05.029764 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m17:20:05.035312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c2b92b8-7384-45f6-95e7-f033287ba466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10601dd60>]}
[0m17:20:05.128152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c2b92b8-7384-45f6-95e7-f033287ba466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624eea0>]}
[0m17:20:05.128701 [info ] [MainThread]: Found 2 seeds, 577 macros
[0m17:20:05.129072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c2b92b8-7384-45f6-95e7-f033287ba466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf74d0>]}
[0m17:20:05.131025 [info ] [MainThread]: 
[0m17:20:05.131804 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:20:05.136396 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:20:05.150337 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:20:05.151278 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:20:05.151814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:05.712050 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89c54-0203-b576-0003-18c200010196
[0m17:20:05.712530 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:20:05.712990 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:20:05.713299 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:20:05.713704 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m17:20:05.804179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:05.804648 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:20:05.805013 [info ] [MainThread]: 
[0m17:20:05.805378 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m17:20:05.805909 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m17:20:05.806613 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.253653, "process_in_blocks": "0", "process_kernel_time": 0.587747, "process_mem_max_rss": "130502656", "process_out_blocks": "0", "process_user_time": 2.39322}
[0m17:20:05.807181 [debug] [MainThread]: Command `dbt seed` failed at 17:20:05.807076 after 2.25 seconds
[0m17:20:05.807611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051444d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10624ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064884d0>]}
[0m17:20:05.807957 [debug] [MainThread]: Flushing usage events
[0m17:20:21.339713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122eed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112638650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112638320>]}


============================== 17:20:21.347778 | 8382a087-e450-49a3-ab20-861aa20b78eb ==============================
[0m17:20:21.347778 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:20:21.348471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:20:22.045870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8382a087-e450-49a3-ab20-861aa20b78eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125e4080>]}
[0m17:20:22.111477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8382a087-e450-49a3-ab20-861aa20b78eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f653d0>]}
[0m17:20:22.113014 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:20:22.295270 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:20:22.500002 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m17:20:22.501032 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://seeds/exercises.csv
[0m17:20:22.501866 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/steps.csv
[0m17:20:22.701186 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m17:20:22.706502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8382a087-e450-49a3-ab20-861aa20b78eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113174350>]}
[0m17:20:22.811581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8382a087-e450-49a3-ab20-861aa20b78eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11345d850>]}
[0m17:20:22.812226 [info ] [MainThread]: Found 1 seed, 577 macros
[0m17:20:22.812677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8382a087-e450-49a3-ab20-861aa20b78eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135b3440>]}
[0m17:20:22.815266 [info ] [MainThread]: 
[0m17:20:22.816194 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:20:22.817236 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:20:22.837200 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:20:22.838165 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:20:22.838803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:23.714866 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89c54-0203-b579-0000-000318c2f0d9
[0m17:20:23.734913 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:20:23.735592 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:20:23.735947 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:20:23.736349 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m17:20:23.938691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:23.939151 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:20:23.939485 [info ] [MainThread]: 
[0m17:20:23.939852 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m17:20:23.940562 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m17:20:23.941308 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.6901047, "process_in_blocks": "0", "process_kernel_time": 0.633096, "process_mem_max_rss": "129634304", "process_out_blocks": "0", "process_user_time": 2.592994}
[0m17:20:23.941959 [debug] [MainThread]: Command `dbt seed` failed at 17:20:23.941814 after 2.69 seconds
[0m17:20:23.942452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126382f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135b3f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137d4ef0>]}
[0m17:20:23.942885 [debug] [MainThread]: Flushing usage events
[0m17:20:37.835600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf0e180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef30830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef30500>]}


============================== 17:20:37.843230 | 88ac15eb-363e-48ca-aa15-6f433311280d ==============================
[0m17:20:37.843230 [info ] [MainThread]: Running with dbt=1.8.9
[0m17:20:37.844041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:20:38.578090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88ac15eb-363e-48ca-aa15-6f433311280d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa2e9c0>]}
[0m17:20:38.657530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88ac15eb-363e-48ca-aa15-6f433311280d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea2ed20>]}
[0m17:20:38.659365 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:20:38.820162 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m17:20:39.028400 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m17:20:39.029029 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://seeds/exercises.csv
[0m17:20:39.029410 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://seeds/steps.csv
[0m17:20:39.270059 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m17:20:39.277670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88ac15eb-363e-48ca-aa15-6f433311280d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc89730>]}
[0m17:20:39.377939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88ac15eb-363e-48ca-aa15-6f433311280d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc70890>]}
[0m17:20:39.378503 [info ] [MainThread]: Found 1 seed, 577 macros
[0m17:20:39.378883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88ac15eb-363e-48ca-aa15-6f433311280d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd13500>]}
[0m17:20:39.381038 [info ] [MainThread]: 
[0m17:20:39.381809 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:20:39.382815 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m17:20:39.399995 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m17:20:39.400606 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m17:20:39.400996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:40.698184 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89c54-0203-b42e-0000-000318c29f51
[0m17:20:40.698808 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:20:40.699911 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:20:40.700647 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:20:40.701101 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m17:20:40.853123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:40.853687 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m17:20:40.854077 [info ] [MainThread]: 
[0m17:20:40.854440 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m17:20:40.854990 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m17:20:40.855733 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.1056006, "process_in_blocks": "0", "process_kernel_time": 0.644626, "process_mem_max_rss": "129310720", "process_out_blocks": "0", "process_user_time": 2.61543}
[0m17:20:40.856285 [debug] [MainThread]: Command `dbt seed` failed at 17:20:40.856176 after 3.11 seconds
[0m17:20:40.856747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed87aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd138f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffcfd70>]}
[0m17:20:40.857130 [debug] [MainThread]: Flushing usage events
[0m20:45:26.308379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b11e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0c7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e138470>]}


============================== 20:45:26.317075 | 75d50ad5-7527-42fe-a0a0-07159c63bb10 ==============================
[0m20:45:26.317075 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:45:26.318306 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:45:27.244078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75d50ad5-7527-42fe-a0a0-07159c63bb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5673b0>]}
[0m20:45:27.316738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75d50ad5-7527-42fe-a0a0-07159c63bb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfea570>]}
[0m20:45:27.319043 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:45:27.511622 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:45:27.798367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m20:45:27.799204 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://seeds/steps.csv
[0m20:45:27.799662 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://seeds/patients.csv
[0m20:45:28.055164 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m20:45:28.061489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75d50ad5-7527-42fe-a0a0-07159c63bb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f024440>]}
[0m20:45:28.175096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75d50ad5-7527-42fe-a0a0-07159c63bb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed0ec00>]}
[0m20:45:28.175676 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m20:45:28.176128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75d50ad5-7527-42fe-a0a0-07159c63bb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d650ec0>]}
[0m20:45:28.178825 [info ] [MainThread]: 
[0m20:45:28.179872 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:45:28.186957 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m20:45:28.206404 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m20:45:28.207208 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m20:45:28.207883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:28.854666 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d21-0203-b42e-0003-18c2000125da
[0m20:45:28.855345 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:45:28.855909 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m20:45:28.856443 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:45:28.857121 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m20:45:29.125908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:29.126558 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m20:45:29.127134 [info ] [MainThread]: 
[0m20:45:29.128861 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m20:45:29.130506 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m20:45:29.131615 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.9597948, "process_in_blocks": "0", "process_kernel_time": 0.862649, "process_mem_max_rss": "129409024", "process_out_blocks": "0", "process_user_time": 3.208299}
[0m20:45:29.132559 [debug] [MainThread]: Command `dbt seed` failed at 20:45:29.132364 after 2.96 seconds
[0m20:45:29.133265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d752960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef88c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f38c3e0>]}
[0m20:45:29.134353 [debug] [MainThread]: Flushing usage events
[0m20:45:50.498223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cada60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106068680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106068440>]}


============================== 20:45:50.504331 | f286eb44-96f6-4600-9b2d-66a2f69b8c83 ==============================
[0m20:45:50.504331 [info ] [MainThread]: Running with dbt=1.8.9
[0m20:45:50.505986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m20:45:51.314238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f286eb44-96f6-4600-9b2d-66a2f69b8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103474cb0>]}
[0m20:45:51.388716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f286eb44-96f6-4600-9b2d-66a2f69b8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10699ffb0>]}
[0m20:45:51.390492 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:45:51.599729 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m20:45:51.811218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:45:51.811711 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:45:51.817614 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m20:45:51.848631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f286eb44-96f6-4600-9b2d-66a2f69b8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d32750>]}
[0m20:45:51.980953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f286eb44-96f6-4600-9b2d-66a2f69b8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edf110>]}
[0m20:45:51.981867 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m20:45:51.982546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f286eb44-96f6-4600-9b2d-66a2f69b8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706e7b0>]}
[0m20:45:51.986985 [info ] [MainThread]: 
[0m20:45:51.988321 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:45:51.997599 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH_rehabilitation_data'
[0m20:45:52.025908 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_rehabilitation_data"
[0m20:45:52.026607 [debug] [ThreadPool]: On list_CASPAR_HEALTH_rehabilitation_data: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_rehabilitation_data"} */
show objects in CASPAR_HEALTH.rehabilitation_data limit 10000
[0m20:45:52.027086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:52.657179 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d21-0203-b526-0000-000318c2aac5
[0m20:45:52.657668 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:45:52.658155 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:45:52.658519 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:45:52.658905 [debug] [ThreadPool]: On list_CASPAR_HEALTH_rehabilitation_data: Close
[0m20:45:52.915419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f286eb44-96f6-4600-9b2d-66a2f69b8c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070beb40>]}
[0m20:45:52.916144 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:45:52.916621 [info ] [MainThread]: 
[0m20:45:52.927576 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.exercises
[0m20:45:52.928527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_rehabilitation_data, now seed.caspar_health_technical_challenge.exercises)
[0m20:45:52.929469 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.exercises
[0m20:45:52.941709 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.exercises
[0m20:45:52.943458 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.exercises
[0m20:45:52.944266 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.patients
[0m20:45:52.945477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.exercises, now seed.caspar_health_technical_challenge.patients)
[0m20:45:52.946209 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.patients
[0m20:45:52.949037 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.patients
[0m20:45:52.950335 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.patients
[0m20:45:52.950960 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.steps
[0m20:45:52.951613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.patients, now seed.caspar_health_technical_challenge.steps)
[0m20:45:52.952418 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.steps
[0m20:45:52.954602 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.steps
[0m20:45:52.955677 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.steps
[0m20:45:52.957022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:52.957443 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.steps' was properly closed.
[0m20:45:52.958374 [debug] [MainThread]: Command end result
[0m20:45:53.002438 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.6077762, "process_in_blocks": "0", "process_kernel_time": 0.722199, "process_mem_max_rss": "128462848", "process_out_blocks": "0", "process_user_time": 2.845004}
[0m20:45:53.003119 [debug] [MainThread]: Command `dbt compile` succeeded at 20:45:53.002988 after 2.61 seconds
[0m20:45:53.003565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105661ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106068740>]}
[0m20:45:53.003962 [debug] [MainThread]: Flushing usage events
[0m21:03:33.896592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba79c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd5c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd5c5f0>]}


============================== 21:03:33.904296 | bc45a7a6-116e-4076-b721-846b881fd44b ==============================
[0m21:03:33.904296 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:03:33.905103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:03:34.676481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc45a7a6-116e-4076-b721-846b881fd44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091bc860>]}
[0m21:03:34.740055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc45a7a6-116e-4076-b721-846b881fd44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c77ae70>]}
[0m21:03:34.742631 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:03:34.900781 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:03:34.972817 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:03:34.973373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc45a7a6-116e-4076-b721-846b881fd44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc8c050>]}
[0m21:03:36.614603 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:03:36.620096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc45a7a6-116e-4076-b721-846b881fd44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c995190>]}
[0m21:03:36.742060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc45a7a6-116e-4076-b721-846b881fd44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9642c0>]}
[0m21:03:36.742675 [info ] [MainThread]: Found 1 model, 3 seeds, 577 macros
[0m21:03:36.743101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc45a7a6-116e-4076-b721-846b881fd44b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b29bfe0>]}
[0m21:03:36.745088 [info ] [MainThread]: 
[0m21:03:36.745817 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:03:36.750112 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:03:36.765712 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:03:36.766600 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:03:36.767031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:37.542519 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d33-0203-b56e-0003-18c20001362e
[0m21:03:37.543032 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:03:37.543517 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m21:03:37.543837 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:03:37.544232 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:03:37.630932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:37.631394 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m21:03:37.631748 [info ] [MainThread]: 
[0m21:03:37.632554 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m21:03:37.633171 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m21:03:37.633940 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.8561697, "process_in_blocks": "0", "process_kernel_time": 0.713842, "process_mem_max_rss": "132489216", "process_out_blocks": "0", "process_user_time": 3.739256}
[0m21:03:37.634750 [debug] [MainThread]: Command `dbt seed` failed at 21:03:37.634532 after 3.86 seconds
[0m21:03:37.635257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b23a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdfb260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0442f0>]}
[0m21:03:37.635713 [debug] [MainThread]: Flushing usage events
[0m21:03:49.487100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11317f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c40500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c402c0>]}


============================== 21:03:49.493526 | 12c60fda-b3db-41b8-8004-853e7e073356 ==============================
[0m21:03:49.493526 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:03:49.494182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:03:50.192830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12c60fda-b3db-41b8-8004-853e7e073356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11473da00>]}
[0m21:03:50.250165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12c60fda-b3db-41b8-8004-853e7e073356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114637d40>]}
[0m21:03:50.251912 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:03:50.405045 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:03:50.599063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:03:50.599547 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:03:50.605067 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:03:50.635776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12c60fda-b3db-41b8-8004-853e7e073356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114928500>]}
[0m21:03:50.748234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12c60fda-b3db-41b8-8004-853e7e073356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149d1a60>]}
[0m21:03:50.748826 [info ] [MainThread]: Found 1 model, 3 seeds, 577 macros
[0m21:03:50.749236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12c60fda-b3db-41b8-8004-853e7e073356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a5c0b0>]}
[0m21:03:50.751456 [info ] [MainThread]: 
[0m21:03:50.752524 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:03:50.757897 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:03:50.776506 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:03:50.777106 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:03:50.777709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:51.363372 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d33-0203-b526-0000-000318c2abc5
[0m21:03:51.363929 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:03:51.364511 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m21:03:51.364824 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:03:51.365260 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:03:51.588452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:51.588995 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m21:03:51.589394 [info ] [MainThread]: 
[0m21:03:51.589775 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m21:03:51.590293 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m21:03:51.591009 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.1873207, "process_in_blocks": "0", "process_kernel_time": 0.549641, "process_mem_max_rss": "129339392", "process_out_blocks": "0", "process_user_time": 2.319304}
[0m21:03:51.591659 [debug] [MainThread]: Command `dbt seed` failed at 21:03:51.591530 after 2.19 seconds
[0m21:03:51.592109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c40110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b478f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b450d0>]}
[0m21:03:51.592481 [debug] [MainThread]: Flushing usage events
[0m21:04:41.994670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d80740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d80500>]}


============================== 21:04:42.004278 | 82cddac3-3719-4bf9-82c3-ed1888dd80ee ==============================
[0m21:04:42.004278 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:04:42.005037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:04:42.676958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82cddac3-3719-4bf9-82c3-ed1888dd80ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099114c0>]}
[0m21:04:42.736984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82cddac3-3719-4bf9-82c3-ed1888dd80ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d51f0>]}
[0m21:04:42.738620 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:04:42.884515 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:04:43.080760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:04:43.081222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:04:43.086951 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:04:43.118223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82cddac3-3719-4bf9-82c3-ed1888dd80ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10987bef0>]}
[0m21:04:43.227686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82cddac3-3719-4bf9-82c3-ed1888dd80ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b8b290>]}
[0m21:04:43.228226 [info ] [MainThread]: Found 1 model, 3 seeds, 577 macros
[0m21:04:43.228597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82cddac3-3719-4bf9-82c3-ed1888dd80ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109838b00>]}
[0m21:04:43.230624 [info ] [MainThread]: 
[0m21:04:43.231273 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:04:43.236131 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH_public'
[0m21:04:43.256784 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m21:04:43.257333 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m21:04:43.257887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:43.758856 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d34-0203-b56e-0003-18c20001364a
[0m21:04:43.759466 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:04:43.760033 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:04:43.760617 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:04:43.761053 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m21:04:43.837588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_transform)
[0m21:04:43.841878 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m21:04:43.842838 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m21:04:43.843887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:04:44.106204 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d34-0203-b576-0003-18c2000108e6
[0m21:04:44.106735 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:04:44.107252 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:04:44.107614 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:04:44.108143 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m21:04:44.187761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82cddac3-3719-4bf9-82c3-ed1888dd80ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cfc140>]}
[0m21:04:44.188490 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:04:44.188946 [info ] [MainThread]: 
[0m21:04:44.193654 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.exercises
[0m21:04:44.194437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now seed.caspar_health_technical_challenge.exercises)
[0m21:04:44.195386 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.exercises
[0m21:04:44.206713 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.exercises
[0m21:04:44.207759 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.exercises
[0m21:04:44.208278 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.patients
[0m21:04:44.208912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.exercises, now seed.caspar_health_technical_challenge.patients)
[0m21:04:44.209919 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.patients
[0m21:04:44.213329 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.patients
[0m21:04:44.214938 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.patients
[0m21:04:44.215644 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.steps
[0m21:04:44.216369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.patients, now seed.caspar_health_technical_challenge.steps)
[0m21:04:44.216790 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.steps
[0m21:04:44.221132 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.steps
[0m21:04:44.222497 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.steps
[0m21:04:44.223276 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_enhanced
[0m21:04:44.223803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.steps, now model.caspar_health_technical_challenge.patients_enhanced)
[0m21:04:44.224213 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.patients_enhanced
[0m21:04:44.269926 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_enhanced"
[0m21:04:44.270431 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_enhanced"} */
describe table CASPAR_HEALTH.public.patients
[0m21:04:44.270810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:04:44.519276 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89d34-0203-b56e-0003-18c20001364e
[0m21:04:44.519799 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'CASPAR_HEALTH' does not exist or not authorized.
[0m21:04:44.520303 [debug] [Thread-1 (]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
[0m21:04:44.520686 [debug] [Thread-1 (]: Snowflake adapter: Rolling back transaction.
[0m21:04:44.523175 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_enhanced"
[0m21:04:44.523686 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_enhanced"} */
describe table CASPAR_HEALTH.public.exercises
[0m21:04:44.594935 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89d34-0203-b42e-0003-18c20001269e
[0m21:04:44.595420 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'CASPAR_HEALTH' does not exist or not authorized.
[0m21:04:44.595893 [debug] [Thread-1 (]: Snowflake adapter: Error running SQL: macro get_columns_in_relation
[0m21:04:44.596282 [debug] [Thread-1 (]: Snowflake adapter: Rolling back transaction.
[0m21:04:44.601849 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.patients_enhanced"
[0m21:04:44.604550 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.patients_enhanced
[0m21:04:44.605395 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: Close
[0m21:04:44.674816 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_enhanced
[0m21:04:44.676027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:44.676470 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.patients_enhanced' was properly closed.
[0m21:04:44.677583 [debug] [MainThread]: Command end result
[0m21:04:44.714448 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.8474514, "process_in_blocks": "0", "process_kernel_time": 0.577888, "process_mem_max_rss": "130740224", "process_out_blocks": "0", "process_user_time": 2.491486}
[0m21:04:44.715316 [debug] [MainThread]: Command `dbt compile` succeeded at 21:04:44.715162 after 2.85 seconds
[0m21:04:44.715824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088236b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089696a0>]}
[0m21:04:44.716295 [debug] [MainThread]: Flushing usage events
[0m21:04:49.330987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f6d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111278680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111278440>]}


============================== 21:04:49.338142 | a2d6613d-e094-41d1-8dd5-e1e8e14ef27c ==============================
[0m21:04:49.338142 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:04:49.339075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:04:50.193063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2d6613d-e094-41d1-8dd5-e1e8e14ef27c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d39910>]}
[0m21:04:50.255530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2d6613d-e094-41d1-8dd5-e1e8e14ef27c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cd5a60>]}
[0m21:04:50.257266 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:04:50.408984 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:04:50.622983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:04:50.623470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:04:50.631258 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:04:50.670944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2d6613d-e094-41d1-8dd5-e1e8e14ef27c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112057fe0>]}
[0m21:04:50.794036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2d6613d-e094-41d1-8dd5-e1e8e14ef27c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ec74d0>]}
[0m21:04:50.794664 [info ] [MainThread]: Found 1 model, 3 seeds, 577 macros
[0m21:04:50.795356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2d6613d-e094-41d1-8dd5-e1e8e14ef27c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121fe480>]}
[0m21:04:50.798759 [info ] [MainThread]: 
[0m21:04:50.799860 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:04:50.806008 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:04:50.824644 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:04:50.825331 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:04:50.825700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:04:51.255869 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d34-0203-b42e-0003-18c2000126a2
[0m21:04:51.262248 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:04:51.263014 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m21:04:51.263376 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:04:51.263803 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:04:51.374046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:04:51.374557 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m21:04:51.375058 [info ] [MainThread]: 
[0m21:04:51.375485 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m21:04:51.375991 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m21:04:51.376622 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.230922, "process_in_blocks": "0", "process_kernel_time": 0.61289, "process_mem_max_rss": "128708608", "process_out_blocks": "0", "process_user_time": 2.472928}
[0m21:04:51.377252 [debug] [MainThread]: Command `dbt seed` failed at 21:04:51.377127 after 2.23 seconds
[0m21:04:51.377827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111278500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d087f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11203fbf0>]}
[0m21:04:51.378220 [debug] [MainThread]: Flushing usage events
[0m21:08:52.680237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acbbf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4b7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af34320>]}


============================== 21:08:52.687210 | e681e9c4-d4e8-4a21-ac9c-b231790cb9e4 ==============================
[0m21:08:52.687210 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:08:52.687972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:08:53.432060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e681e9c4-d4e8-4a21-ac9c-b231790cb9e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af36180>]}
[0m21:08:53.510927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e681e9c4-d4e8-4a21-ac9c-b231790cb9e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d8d460>]}
[0m21:08:53.512876 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:08:53.668276 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:08:53.887200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:08:53.887648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:08:53.893163 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:08:53.927934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e681e9c4-d4e8-4a21-ac9c-b231790cb9e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bca0830>]}
[0m21:08:54.067521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e681e9c4-d4e8-4a21-ac9c-b231790cb9e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcfff80>]}
[0m21:08:54.068103 [info ] [MainThread]: Found 1 model, 3 seeds, 577 macros
[0m21:08:54.068490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e681e9c4-d4e8-4a21-ac9c-b231790cb9e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb37020>]}
[0m21:08:54.070622 [info ] [MainThread]: 
[0m21:08:54.071392 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:08:54.076892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:08:54.093935 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:08:54.094437 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:08:54.094796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:08:54.663749 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d38-0203-b576-0003-18c200010946
[0m21:08:54.664218 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:08:54.664682 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m21:08:54.664997 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:08:54.665639 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:08:54.778461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:08:54.778938 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m21:08:54.779333 [info ] [MainThread]: 
[0m21:08:54.779733 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m21:08:54.780336 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "CASPAR_HEALTH"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m21:08:54.781058 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.1993694, "process_in_blocks": "0", "process_kernel_time": 0.584442, "process_mem_max_rss": "128331776", "process_out_blocks": "0", "process_user_time": 2.278794}
[0m21:08:54.781687 [debug] [MainThread]: Command `dbt seed` failed at 21:08:54.781536 after 2.20 seconds
[0m21:08:54.782100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af34350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bacc8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bca07d0>]}
[0m21:08:54.782512 [debug] [MainThread]: Flushing usage events
[0m21:15:11.282056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2bf020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe5c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe5c3b0>]}


============================== 21:15:11.290250 | 1991d187-dff5-42ca-9042-8c9e41c325cb ==============================
[0m21:15:11.290250 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:15:11.291602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:15:12.058624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1991d187-dff5-42ca-9042-8c9e41c325cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a094c0>]}
[0m21:15:12.123355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1991d187-dff5-42ca-9042-8c9e41c325cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a0a810>]}
[0m21:15:12.125503 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:15:12.293384 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:15:12.537352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:15:12.537808 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:15:12.543256 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:15:12.575889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1991d187-dff5-42ca-9042-8c9e41c325cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe5e0f0>]}
[0m21:15:12.691431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1991d187-dff5-42ca-9042-8c9e41c325cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c3b980>]}
[0m21:15:12.691994 [info ] [MainThread]: Found 1 model, 3 seeds, 577 macros
[0m21:15:12.692372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1991d187-dff5-42ca-9042-8c9e41c325cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110acf4d0>]}
[0m21:15:12.694827 [info ] [MainThread]: 
[0m21:15:12.695888 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:15:12.702034 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:15:12.724505 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:15:12.725163 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:15:12.725531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:13.323482 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.598 seconds
[0m21:15:13.325281 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:15:13.726927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now create_CASPAR_HEALTH_public)
[0m21:15:13.727667 [debug] [ThreadPool]: Creating schema "database: "CASPAR_HEALTH"
schema: "public"
"
[0m21:15:13.733027 [debug] [ThreadPool]: Using snowflake connection "create_CASPAR_HEALTH_public"
[0m21:15:13.733504 [debug] [ThreadPool]: On create_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "create_CASPAR_HEALTH_public"} */
create schema if not exists CASPAR_HEALTH.public
[0m21:15:13.733838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:15:14.072773 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d3f-0203-b56e-0003-18c20001372a
[0m21:15:14.073210 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on database 'CASPAR_HEALTH'
[0m21:15:14.073659 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m21:15:14.073955 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:15:14.074308 [debug] [ThreadPool]: On create_CASPAR_HEALTH_public: Close
[0m21:15:14.145264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:15:14.145777 [debug] [MainThread]: Connection 'create_CASPAR_HEALTH_public' was properly closed.
[0m21:15:14.146177 [info ] [MainThread]: 
[0m21:15:14.146705 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m21:15:14.147452 [error] [MainThread]: Encountered an error:
Database Error
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on database 'CASPAR_HEALTH'
[0m21:15:14.148393 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.9524946, "process_in_blocks": "0", "process_kernel_time": 0.659975, "process_mem_max_rss": "128708608", "process_out_blocks": "0", "process_user_time": 2.338445}
[0m21:15:14.149365 [debug] [MainThread]: Command `dbt seed` failed at 21:15:14.149160 after 2.95 seconds
[0m21:15:14.150068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efc4230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cff8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f7f8f0>]}
[0m21:15:14.150683 [debug] [MainThread]: Flushing usage events
[0m21:16:20.779192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c04e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c354650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c354410>]}


============================== 21:16:20.787046 | 2b9def62-ca47-44f6-ab5e-d6b737fc7363 ==============================
[0m21:16:20.787046 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:16:20.787699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m21:16:21.485767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b9def62-ca47-44f6-ab5e-d6b737fc7363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd53aa0>]}
[0m21:16:21.543685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b9def62-ca47-44f6-ab5e-d6b737fc7363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be029f0>]}
[0m21:16:21.545942 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:16:21.698542 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:16:21.920281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:16:21.920737 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:16:21.926068 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:16:21.963362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b9def62-ca47-44f6-ab5e-d6b737fc7363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d01fb90>]}
[0m21:16:22.076268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b9def62-ca47-44f6-ab5e-d6b737fc7363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d24ca10>]}
[0m21:16:22.076812 [info ] [MainThread]: Found 1 model, 3 seeds, 577 macros
[0m21:16:22.077177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b9def62-ca47-44f6-ab5e-d6b737fc7363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d01e090>]}
[0m21:16:22.079261 [info ] [MainThread]: 
[0m21:16:22.079931 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:16:22.084933 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:16:22.101633 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:16:22.102271 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:16:22.102669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:22.541335 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.439 seconds
[0m21:16:22.543334 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:16:22.623442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now create_CASPAR_HEALTH_public)
[0m21:16:22.624133 [debug] [ThreadPool]: Creating schema "database: "CASPAR_HEALTH"
schema: "public"
"
[0m21:16:22.629653 [debug] [ThreadPool]: Using snowflake connection "create_CASPAR_HEALTH_public"
[0m21:16:22.630131 [debug] [ThreadPool]: On create_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "create_CASPAR_HEALTH_public"} */
create schema if not exists CASPAR_HEALTH.public
[0m21:16:22.630469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:23.020848 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d40-0203-b42e-0003-18c2000127a2
[0m21:16:23.021427 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Schema 'PUBLIC' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m21:16:23.021951 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m21:16:23.022279 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:16:23.022623 [debug] [ThreadPool]: On create_CASPAR_HEALTH_public: Close
[0m21:16:23.091861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:23.092337 [debug] [MainThread]: Connection 'create_CASPAR_HEALTH_public' was properly closed.
[0m21:16:23.092664 [info ] [MainThread]: 
[0m21:16:23.093024 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m21:16:23.093577 [error] [MainThread]: Encountered an error:
Database Error
  003041 (42710): SQL compilation error:
  Schema 'PUBLIC' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m21:16:23.094219 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.4034624, "process_in_blocks": "0", "process_kernel_time": 0.60285, "process_mem_max_rss": "128724992", "process_out_blocks": "0", "process_user_time": 2.33694}
[0m21:16:23.095017 [debug] [MainThread]: Command `dbt seed` failed at 21:16:23.094840 after 2.40 seconds
[0m21:16:23.095440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c354590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cff5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1edc70>]}
[0m21:16:23.095908 [debug] [MainThread]: Flushing usage events
[0m21:18:48.238931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a988c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155c530>]}


============================== 21:18:48.246281 | b42389db-6604-49da-b98c-854201a97d96 ==============================
[0m21:18:48.246281 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:18:48.247086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:18:49.006628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b42389db-6604-49da-b98c-854201a97d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e325d0>]}
[0m21:18:49.066012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b42389db-6604-49da-b98c-854201a97d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114e3bc0>]}
[0m21:18:49.067944 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:18:49.215697 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:18:49.483908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:18:49.484738 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:18:49.512003 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:18:49.587865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b42389db-6604-49da-b98c-854201a97d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b326c0>]}
[0m21:18:49.738022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b42389db-6604-49da-b98c-854201a97d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f1910>]}
[0m21:18:49.738607 [info ] [MainThread]: Found 1 model, 3 seeds, 577 macros
[0m21:18:49.739104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b42389db-6604-49da-b98c-854201a97d96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11124f830>]}
[0m21:18:49.741410 [info ] [MainThread]: 
[0m21:18:49.742268 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:18:49.747541 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:18:49.770533 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:18:49.771273 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:18:49.771715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:50.268937 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.497 seconds
[0m21:18:50.270759 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:18:50.336424 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now create_CASPAR_HEALTH_public)
[0m21:18:50.337112 [debug] [ThreadPool]: Creating schema "database: "CASPAR_HEALTH"
schema: "public"
"
[0m21:18:50.341595 [debug] [ThreadPool]: Using snowflake connection "create_CASPAR_HEALTH_public"
[0m21:18:50.342017 [debug] [ThreadPool]: On create_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "create_CASPAR_HEALTH_public"} */
create schema if not exists CASPAR_HEALTH.public
[0m21:18:50.342342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:18:50.776653 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d42-0203-b56e-0003-18c20001377a
[0m21:18:50.777107 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Schema 'PUBLIC' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m21:18:50.777700 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m21:18:50.778050 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:18:50.778386 [debug] [ThreadPool]: On create_CASPAR_HEALTH_public: Close
[0m21:18:50.852131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:50.852595 [debug] [MainThread]: Connection 'create_CASPAR_HEALTH_public' was properly closed.
[0m21:18:50.852977 [info ] [MainThread]: 
[0m21:18:50.853352 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m21:18:50.853907 [error] [MainThread]: Encountered an error:
Database Error
  003041 (42710): SQL compilation error:
  Schema 'PUBLIC' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m21:18:50.854594 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.7253072, "process_in_blocks": "0", "process_kernel_time": 0.655749, "process_mem_max_rss": "129511424", "process_out_blocks": "0", "process_user_time": 2.458039}
[0m21:18:50.855150 [debug] [MainThread]: Command `dbt seed` failed at 21:18:50.855045 after 2.73 seconds
[0m21:18:50.855554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155c710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123a3f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125dce00>]}
[0m21:18:50.855917 [debug] [MainThread]: Flushing usage events
[0m21:19:42.323197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca78b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4c7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d538380>]}


============================== 21:19:42.330040 | c46d9fc4-6ad3-444a-99b9-33c9a669e04f ==============================
[0m21:19:42.330040 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:19:42.330717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:19:43.018674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c46d9fc4-6ad3-444a-99b9-33c9a669e04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e013440>]}
[0m21:19:43.088744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c46d9fc4-6ad3-444a-99b9-33c9a669e04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb4ec30>]}
[0m21:19:43.090810 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:19:43.258700 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:19:43.496995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:19:43.497462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:19:43.503190 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:19:43.535363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c46d9fc4-6ad3-444a-99b9-33c9a669e04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0f35f0>]}
[0m21:19:43.668586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c46d9fc4-6ad3-444a-99b9-33c9a669e04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e357e90>]}
[0m21:19:43.669265 [info ] [MainThread]: Found 1 model, 3 seeds, 577 macros
[0m21:19:43.669783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c46d9fc4-6ad3-444a-99b9-33c9a669e04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4d3380>]}
[0m21:19:43.673218 [info ] [MainThread]: 
[0m21:19:43.674422 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:19:43.681162 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:19:43.697824 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:19:43.698369 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:19:43.698720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:44.099021 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.400 seconds
[0m21:19:44.101065 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:19:44.527887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m21:19:44.538741 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m21:19:44.539203 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m21:19:44.539540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:44.898524 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.359 seconds
[0m21:19:44.900184 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m21:19:44.976691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_transform)
[0m21:19:44.979576 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m21:19:44.980035 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m21:19:44.980406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:45.329996 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d43-0203-b56e-0003-18c20001379e
[0m21:19:45.330563 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:19:45.331070 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:19:45.331403 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:19:45.331747 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m21:19:45.413809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c46d9fc4-6ad3-444a-99b9-33c9a669e04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4d03b0>]}
[0m21:19:45.414536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:19:45.414932 [info ] [MainThread]: 
[0m21:19:45.418746 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.exercises
[0m21:19:45.419365 [info ] [Thread-1 (]: 1 of 3 START seed file public.exercises ........................................ [RUN]
[0m21:19:45.419914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now seed.caspar_health_technical_challenge.exercises)
[0m21:19:45.420326 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.exercises
[0m21:19:45.420712 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.exercises
[0m21:19:45.430508 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:19:45.431158 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
show parameters like 'query_tag' in session
[0m21:19:45.431569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:45.753108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.321 seconds
[0m21:19:45.754936 [debug] [Thread-1 (]: Setting query_tag to 'exercises'. Will reset to '' after materialization.
[0m21:19:45.755814 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:19:45.756462 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
alter session set query_tag = 'exercises'
[0m21:19:45.867516 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m21:19:51.345091 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:19:51.346333 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
create table CASPAR_HEALTH.public.exercises (ID integer,PATIENT_ID integer,MINUTES integer,COMPLETED_AT timestamp without time zone,UPDATED_AT timestamp without time zone)
[0m21:19:51.443644 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89d43-0203-b42e-0003-18c2000127ee
[0m21:19:51.444171 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'PUBLIC'
[0m21:19:51.444791 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: Close
[0m21:19:51.513099 [debug] [Thread-1 (]: Database Error in seed exercises (seeds/exercises.csv)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'PUBLIC'
[0m21:19:51.514685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c46d9fc4-6ad3-444a-99b9-33c9a669e04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de3bec0>]}
[0m21:19:51.515341 [error] [Thread-1 (]: 1 of 3 ERROR loading seed file public.exercises ................................ [[31mERROR[0m in 6.09s]
[0m21:19:51.516055 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.exercises
[0m21:19:51.516590 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.patients
[0m21:19:51.518017 [info ] [Thread-1 (]: 2 of 3 START seed file public.patients ......................................... [RUN]
[0m21:19:51.518696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.exercises, now seed.caspar_health_technical_challenge.patients)
[0m21:19:51.519438 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.patients
[0m21:19:51.520013 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.patients
[0m21:19:51.529083 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:19:51.529602 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
show parameters like 'query_tag' in session
[0m21:19:51.529995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:51.789163 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.259 seconds
[0m21:19:51.790713 [debug] [Thread-1 (]: Setting query_tag to 'patients'. Will reset to '' after materialization.
[0m21:19:51.791495 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:19:51.791967 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
alter session set query_tag = 'patients'
[0m21:19:51.844550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.052 seconds
[0m21:19:51.848341 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: Close
[0m21:19:51.929829 [debug] [Thread-1 (]: Compilation Error in seed patients (seeds/patients.csv)
  Row 0 has 5 values, but Table only has 4 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by macro materialization_seed_snowflake (macros/materializations/seed.sql)
  > called by seed patients (seeds/patients.csv)
[0m21:19:51.930568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c46d9fc4-6ad3-444a-99b9-33c9a669e04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4c6750>]}
[0m21:19:51.931125 [error] [Thread-1 (]: 2 of 3 ERROR loading seed file public.patients ................................. [[31mERROR[0m in 0.41s]
[0m21:19:51.931736 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.patients
[0m21:19:51.932158 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.steps
[0m21:19:51.932736 [info ] [Thread-1 (]: 3 of 3 START seed file public.steps ............................................ [RUN]
[0m21:19:51.933251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.patients, now seed.caspar_health_technical_challenge.steps)
[0m21:19:51.933624 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.steps
[0m21:19:51.933972 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.steps
[0m21:19:51.936257 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:19:51.936737 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
show parameters like 'query_tag' in session
[0m21:19:51.937107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:52.150547 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.213 seconds
[0m21:19:52.152170 [debug] [Thread-1 (]: Setting query_tag to 'steps'. Will reset to '' after materialization.
[0m21:19:52.152927 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:19:52.153414 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
alter session set query_tag = 'steps'
[0m21:19:52.205778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.052 seconds
[0m21:19:52.979030 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:19:52.979562 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
create table CASPAR_HEALTH.public.steps (ID integer,PATIENT_ID integer,STEPS integer,SUBMITTED_AT timestamp without time zone,UPDATED_AT timestamp without time zone)
[0m21:19:53.045714 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89d43-0203-b576-0003-18c2000109e2
[0m21:19:53.046240 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'PUBLIC'
[0m21:19:53.046786 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: Close
[0m21:19:53.150149 [debug] [Thread-1 (]: Database Error in seed steps (seeds/steps.csv)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'PUBLIC'
[0m21:19:53.150814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c46d9fc4-6ad3-444a-99b9-33c9a669e04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0b4ce0>]}
[0m21:19:53.151444 [error] [Thread-1 (]: 3 of 3 ERROR loading seed file public.steps .................................... [[31mERROR[0m in 1.22s]
[0m21:19:53.152071 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.steps
[0m21:19:53.153791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:53.154206 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.steps' was properly closed.
[0m21:19:53.154605 [info ] [MainThread]: 
[0m21:19:53.154952 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 9.48 seconds (9.48s).
[0m21:19:53.155898 [debug] [MainThread]: Command end result
[0m21:19:53.188098 [info ] [MainThread]: 
[0m21:19:53.188664 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m21:19:53.189270 [info ] [MainThread]: 
[0m21:19:53.189773 [error] [MainThread]:   Database Error in seed exercises (seeds/exercises.csv)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'PUBLIC'
[0m21:19:53.190131 [info ] [MainThread]: 
[0m21:19:53.190702 [error] [MainThread]:   Compilation Error in seed patients (seeds/patients.csv)
  Row 0 has 5 values, but Table only has 4 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by macro materialization_seed_snowflake (macros/materializations/seed.sql)
  > called by seed patients (seeds/patients.csv)
[0m21:19:53.191211 [info ] [MainThread]: 
[0m21:19:53.191703 [error] [MainThread]:   Database Error in seed steps (seeds/steps.csv)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'PUBLIC'
[0m21:19:53.192080 [info ] [MainThread]: 
[0m21:19:53.193276 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m21:19:53.194338 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 10.954961, "process_in_blocks": "0", "process_kernel_time": 0.802893, "process_mem_max_rss": "286253056", "process_out_blocks": "0", "process_user_time": 8.306536}
[0m21:19:53.194962 [debug] [MainThread]: Command `dbt seed` failed at 21:19:53.194828 after 10.96 seconds
[0m21:19:53.195618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d014170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceb28a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf69a60>]}
[0m21:19:53.196408 [debug] [MainThread]: Flushing usage events
[0m21:21:16.577271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe84a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090387a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109038560>]}


============================== 21:21:16.584007 | cc64f98c-c107-4088-bde5-452da7d8905c ==============================
[0m21:21:16.584007 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:21:16.584715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m21:21:17.301538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc64f98c-c107-4088-bde5-452da7d8905c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a5e930>]}
[0m21:21:17.361775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc64f98c-c107-4088-bde5-452da7d8905c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109779700>]}
[0m21:21:17.363632 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:21:17.532004 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:21:17.757003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:21:17.757507 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:21:17.763323 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:21:17.799640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc64f98c-c107-4088-bde5-452da7d8905c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e90bf0>]}
[0m21:21:17.914332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc64f98c-c107-4088-bde5-452da7d8905c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e39730>]}
[0m21:21:17.914916 [info ] [MainThread]: Found 1 model, 3 seeds, 577 macros
[0m21:21:17.915296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc64f98c-c107-4088-bde5-452da7d8905c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109039f10>]}
[0m21:21:17.917500 [info ] [MainThread]: 
[0m21:21:17.918247 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:21:17.922556 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:21:17.938458 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:21:17.938916 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:21:17.939259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:19.389682 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.450 seconds
[0m21:21:19.391667 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:21:19.690347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m21:21:19.699378 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m21:21:19.699846 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m21:21:19.700169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:21:20.095564 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.395 seconds
[0m21:21:20.097372 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m21:21:20.349790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_transform)
[0m21:21:20.352520 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m21:21:20.352978 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m21:21:20.353329 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:21:20.649189 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d45-0203-b576-0003-18c2000109ea
[0m21:21:20.649660 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:21:20.650128 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:21:20.650436 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:21:20.650775 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m21:21:20.720045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc64f98c-c107-4088-bde5-452da7d8905c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e3b050>]}
[0m21:21:20.720824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:21:20.721223 [info ] [MainThread]: 
[0m21:21:20.724571 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.exercises
[0m21:21:20.725225 [info ] [Thread-1 (]: 1 of 3 START seed file public.exercises ........................................ [RUN]
[0m21:21:20.725806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now seed.caspar_health_technical_challenge.exercises)
[0m21:21:20.726297 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.exercises
[0m21:21:20.726675 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.exercises
[0m21:21:20.736035 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:21:20.736727 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
show parameters like 'query_tag' in session
[0m21:21:20.737248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:21.072251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.335 seconds
[0m21:21:21.073826 [debug] [Thread-1 (]: Setting query_tag to 'exercises'. Will reset to '' after materialization.
[0m21:21:21.074605 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:21:21.075051 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
alter session set query_tag = 'exercises'
[0m21:21:21.153254 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m21:21:25.976577 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:21:25.977569 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
create table CASPAR_HEALTH.public.exercises (ID integer,PATIENT_ID integer,MINUTES integer,COMPLETED_AT timestamp without time zone,UPDATED_AT timestamp without time zone)
[0m21:21:26.202623 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89d45-0203-b526-0000-000318c2acf5
[0m21:21:26.203242 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Table 'EXERCISES' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m21:21:26.203868 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: Close
[0m21:21:26.272666 [debug] [Thread-1 (]: Database Error in seed exercises (seeds/exercises.csv)
  003041 (42710): SQL compilation error:
  Table 'EXERCISES' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m21:21:26.274257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc64f98c-c107-4088-bde5-452da7d8905c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1e7bf0>]}
[0m21:21:26.274998 [error] [Thread-1 (]: 1 of 3 ERROR loading seed file public.exercises ................................ [[31mERROR[0m in 5.55s]
[0m21:21:26.275721 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.exercises
[0m21:21:26.276344 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.patients
[0m21:21:26.278212 [info ] [Thread-1 (]: 2 of 3 START seed file public.patients ......................................... [RUN]
[0m21:21:26.278919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.exercises, now seed.caspar_health_technical_challenge.patients)
[0m21:21:26.279620 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.patients
[0m21:21:26.280293 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.patients
[0m21:21:26.289615 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:21:26.290223 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
show parameters like 'query_tag' in session
[0m21:21:26.290895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:26.593177 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.302 seconds
[0m21:21:26.594957 [debug] [Thread-1 (]: Setting query_tag to 'patients'. Will reset to '' after materialization.
[0m21:21:26.595815 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:21:26.596219 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
alter session set query_tag = 'patients'
[0m21:21:26.649968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.053 seconds
[0m21:21:26.654018 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: Close
[0m21:21:26.745754 [debug] [Thread-1 (]: Compilation Error in seed patients (seeds/patients.csv)
  Row 0 has 5 values, but Table only has 4 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by macro materialization_seed_snowflake (macros/materializations/seed.sql)
  > called by seed patients (seeds/patients.csv)
[0m21:21:26.746561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc64f98c-c107-4088-bde5-452da7d8905c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf3260>]}
[0m21:21:26.747184 [error] [Thread-1 (]: 2 of 3 ERROR loading seed file public.patients ................................. [[31mERROR[0m in 0.47s]
[0m21:21:26.747874 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.patients
[0m21:21:26.748405 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.steps
[0m21:21:26.749190 [info ] [Thread-1 (]: 3 of 3 START seed file public.steps ............................................ [RUN]
[0m21:21:26.749742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.patients, now seed.caspar_health_technical_challenge.steps)
[0m21:21:26.750165 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.steps
[0m21:21:26.750553 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.steps
[0m21:21:26.753185 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:21:26.753675 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
show parameters like 'query_tag' in session
[0m21:21:26.754079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:27.010865 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m21:21:27.012497 [debug] [Thread-1 (]: Setting query_tag to 'steps'. Will reset to '' after materialization.
[0m21:21:27.013404 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:21:27.013881 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
alter session set query_tag = 'steps'
[0m21:21:27.100659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m21:21:27.873884 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:21:27.874521 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
create table CASPAR_HEALTH.public.steps (ID integer,PATIENT_ID integer,STEPS integer,SUBMITTED_AT timestamp without time zone,UPDATED_AT timestamp without time zone)
[0m21:21:28.069802 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89d45-0203-b56e-0003-18c2000137be
[0m21:21:28.070387 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Table 'STEPS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m21:21:28.071017 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: Close
[0m21:21:28.147758 [debug] [Thread-1 (]: Database Error in seed steps (seeds/steps.csv)
  003041 (42710): SQL compilation error:
  Table 'STEPS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m21:21:28.148524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc64f98c-c107-4088-bde5-452da7d8905c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b3f830>]}
[0m21:21:28.149054 [error] [Thread-1 (]: 3 of 3 ERROR loading seed file public.steps .................................... [[31mERROR[0m in 1.40s]
[0m21:21:28.149690 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.steps
[0m21:21:28.150982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:21:28.151387 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.steps' was properly closed.
[0m21:21:28.151730 [info ] [MainThread]: 
[0m21:21:28.152077 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 10.23 seconds (10.23s).
[0m21:21:28.153045 [debug] [MainThread]: Command end result
[0m21:21:28.186280 [info ] [MainThread]: 
[0m21:21:28.187116 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m21:21:28.187713 [info ] [MainThread]: 
[0m21:21:28.188191 [error] [MainThread]:   Database Error in seed exercises (seeds/exercises.csv)
  003041 (42710): SQL compilation error:
  Table 'EXERCISES' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m21:21:28.188797 [info ] [MainThread]: 
[0m21:21:28.189426 [error] [MainThread]:   Compilation Error in seed patients (seeds/patients.csv)
  Row 0 has 5 values, but Table only has 4 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by macro materialization_seed_snowflake (macros/materializations/seed.sql)
  > called by seed patients (seeds/patients.csv)
[0m21:21:28.189889 [info ] [MainThread]: 
[0m21:21:28.190310 [error] [MainThread]:   Database Error in seed steps (seeds/steps.csv)
  003041 (42710): SQL compilation error:
  Table 'STEPS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m21:21:28.190778 [info ] [MainThread]: 
[0m21:21:28.191542 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m21:21:28.192419 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 11.705074, "process_in_blocks": "0", "process_kernel_time": 0.719632, "process_mem_max_rss": "286081024", "process_out_blocks": "0", "process_user_time": 8.032205}
[0m21:21:28.192951 [debug] [MainThread]: Command `dbt seed` failed at 21:21:28.192840 after 11.71 seconds
[0m21:21:28.193396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d93a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109375370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124ebf80>]}
[0m21:21:28.193903 [debug] [MainThread]: Flushing usage events
[0m21:23:48.291255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10775b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a387d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a38590>]}


============================== 21:23:48.298332 | f1c5921d-8008-43b7-b4aa-cd4b48a0a842 ==============================
[0m21:23:48.298332 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:23:48.299005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m21:23:48.955559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1c5921d-8008-43b7-b4aa-cd4b48a0a842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083116a0>]}
[0m21:23:49.010849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1c5921d-8008-43b7-b4aa-cd4b48a0a842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0d1f0>]}
[0m21:23:49.013557 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:23:49.159791 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:23:49.371485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:23:49.371918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:23:49.377229 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:23:49.407444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1c5921d-8008-43b7-b4aa-cd4b48a0a842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d0ef0>]}
[0m21:23:49.529413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1c5921d-8008-43b7-b4aa-cd4b48a0a842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879ce30>]}
[0m21:23:49.530197 [info ] [MainThread]: Found 1 model, 3 seeds, 577 macros
[0m21:23:49.530857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1c5921d-8008-43b7-b4aa-cd4b48a0a842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a08b00>]}
[0m21:23:49.536856 [info ] [MainThread]: 
[0m21:23:49.537893 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:23:49.542661 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:23:49.560815 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:23:49.561267 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:23:49.561639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:50.052007 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.490 seconds
[0m21:23:50.053858 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:23:50.128667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m21:23:50.138253 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m21:23:50.138789 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m21:23:50.139127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:50.492296 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.353 seconds
[0m21:23:50.494167 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m21:23:50.575006 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_transform)
[0m21:23:50.578362 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m21:23:50.578801 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m21:23:50.579243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:50.972896 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d47-0203-b580-0000-000318c2cdc1
[0m21:23:50.973449 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:23:50.973882 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:23:50.974177 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:23:50.974501 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m21:23:51.064393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1c5921d-8008-43b7-b4aa-cd4b48a0a842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e6090>]}
[0m21:23:51.065091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:23:51.065467 [info ] [MainThread]: 
[0m21:23:51.068915 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.exercises
[0m21:23:51.069539 [info ] [Thread-1 (]: 1 of 3 START seed file public.exercises ........................................ [RUN]
[0m21:23:51.070064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now seed.caspar_health_technical_challenge.exercises)
[0m21:23:51.070458 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.exercises
[0m21:23:51.070828 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.exercises
[0m21:23:51.081184 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:23:51.081819 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
show parameters like 'query_tag' in session
[0m21:23:51.082264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:51.349922 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.268 seconds
[0m21:23:51.351523 [debug] [Thread-1 (]: Setting query_tag to 'exercises'. Will reset to '' after materialization.
[0m21:23:51.352227 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:23:51.352649 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
alter session set query_tag = 'exercises'
[0m21:23:51.441109 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m21:23:55.709089 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:23:55.710202 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:23:55.805418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.095 seconds
[0m21:23:55.805981 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:23:55.806386 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."EXERCISES"
  ;
[0m21:23:55.891888 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89d47-0203-b56e-0003-18c2000137e6
[0m21:23:55.892394 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on table 'EXERCISES'
[0m21:23:55.892931 [debug] [Thread-1 (]: Snowflake adapter: Error running SQL: macro truncate_relation
[0m21:23:55.893314 [debug] [Thread-1 (]: Snowflake adapter: Rolling back transaction.
[0m21:23:55.893754 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: Close
[0m21:23:55.964164 [debug] [Thread-1 (]: Database Error in seed exercises (seeds/exercises.csv)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'EXERCISES'
[0m21:23:55.965691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c5921d-8008-43b7-b4aa-cd4b48a0a842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c42cc0>]}
[0m21:23:55.966295 [error] [Thread-1 (]: 1 of 3 ERROR loading seed file public.exercises ................................ [[31mERROR[0m in 4.89s]
[0m21:23:55.966891 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.exercises
[0m21:23:55.967325 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.patients
[0m21:23:55.968463 [info ] [Thread-1 (]: 2 of 3 START seed file public.patients ......................................... [RUN]
[0m21:23:55.968999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.exercises, now seed.caspar_health_technical_challenge.patients)
[0m21:23:55.969376 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.patients
[0m21:23:55.969734 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.patients
[0m21:23:55.972177 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:23:55.972575 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
show parameters like 'query_tag' in session
[0m21:23:55.972950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:56.301658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.329 seconds
[0m21:23:56.303391 [debug] [Thread-1 (]: Setting query_tag to 'patients'. Will reset to '' after materialization.
[0m21:23:56.304113 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:23:56.304563 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
alter session set query_tag = 'patients'
[0m21:23:56.366781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.062 seconds
[0m21:23:56.370673 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: Close
[0m21:23:56.449593 [debug] [Thread-1 (]: Compilation Error in seed patients (seeds/patients.csv)
  Row 0 has 5 values, but Table only has 4 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by macro materialization_seed_snowflake (macros/materializations/seed.sql)
  > called by seed patients (seeds/patients.csv)
[0m21:23:56.450210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c5921d-8008-43b7-b4aa-cd4b48a0a842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b4e90>]}
[0m21:23:56.450781 [error] [Thread-1 (]: 2 of 3 ERROR loading seed file public.patients ................................. [[31mERROR[0m in 0.48s]
[0m21:23:56.451381 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.patients
[0m21:23:56.451811 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.steps
[0m21:23:56.452516 [info ] [Thread-1 (]: 3 of 3 START seed file public.steps ............................................ [RUN]
[0m21:23:56.453044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.patients, now seed.caspar_health_technical_challenge.steps)
[0m21:23:56.453476 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.steps
[0m21:23:56.453811 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.steps
[0m21:23:56.456337 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:23:56.456719 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
show parameters like 'query_tag' in session
[0m21:23:56.457077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:56.718482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.261 seconds
[0m21:23:56.719976 [debug] [Thread-1 (]: Setting query_tag to 'steps'. Will reset to '' after materialization.
[0m21:23:56.720606 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:23:56.720950 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
alter session set query_tag = 'steps'
[0m21:23:56.800716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m21:23:57.473574 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:23:57.474091 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
BEGIN
[0m21:23:57.668262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m21:23:57.668781 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:23:57.669207 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STEPS"
  ;
[0m21:23:57.725529 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89d47-0203-b576-0003-18c200010a26
[0m21:23:57.725995 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on table 'STEPS'
[0m21:23:57.726529 [debug] [Thread-1 (]: Snowflake adapter: Error running SQL: macro truncate_relation
[0m21:23:57.726865 [debug] [Thread-1 (]: Snowflake adapter: Rolling back transaction.
[0m21:23:57.727313 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: Close
[0m21:23:57.819720 [debug] [Thread-1 (]: Database Error in seed steps (seeds/steps.csv)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'STEPS'
[0m21:23:57.820232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1c5921d-8008-43b7-b4aa-cd4b48a0a842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879e570>]}
[0m21:23:57.820815 [error] [Thread-1 (]: 3 of 3 ERROR loading seed file public.steps .................................... [[31mERROR[0m in 1.37s]
[0m21:23:57.821373 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.steps
[0m21:23:57.822812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:57.823175 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.steps' was properly closed.
[0m21:23:57.823524 [info ] [MainThread]: 
[0m21:23:57.823861 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 8.29 seconds (8.29s).
[0m21:23:57.824820 [debug] [MainThread]: Command end result
[0m21:23:57.857199 [info ] [MainThread]: 
[0m21:23:57.857783 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m21:23:57.858175 [info ] [MainThread]: 
[0m21:23:57.858636 [error] [MainThread]:   Database Error in seed exercises (seeds/exercises.csv)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'EXERCISES'
[0m21:23:57.859123 [info ] [MainThread]: 
[0m21:23:57.859631 [error] [MainThread]:   Compilation Error in seed patients (seeds/patients.csv)
  Row 0 has 5 values, but Table only has 4 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by macro materialization_seed_snowflake (macros/materializations/seed.sql)
  > called by seed patients (seeds/patients.csv)
[0m21:23:57.860109 [info ] [MainThread]: 
[0m21:23:57.860551 [error] [MainThread]:   Database Error in seed steps (seeds/steps.csv)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'STEPS'
[0m21:23:57.861120 [info ] [MainThread]: 
[0m21:23:57.861525 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m21:23:57.862171 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 9.718307, "process_in_blocks": "0", "process_kernel_time": 0.708001, "process_mem_max_rss": "286367744", "process_out_blocks": "0", "process_user_time": 7.282046}
[0m21:23:57.862778 [debug] [MainThread]: Command `dbt seed` failed at 21:23:57.862554 after 9.72 seconds
[0m21:23:57.863336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e14230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107538080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e55e0>]}
[0m21:23:57.863764 [debug] [MainThread]: Flushing usage events
[0m21:25:27.869885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e503860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5805f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5803b0>]}


============================== 21:25:27.877424 | 317593b5-6261-4d97-bb0b-3f517b8bf1ad ==============================
[0m21:25:27.877424 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:25:27.878157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:25:28.536531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '317593b5-6261-4d97-bb0b-3f517b8bf1ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f079970>]}
[0m21:25:28.613664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '317593b5-6261-4d97-bb0b-3f517b8bf1ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d426630>]}
[0m21:25:28.615355 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:25:28.777068 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:25:28.981399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:25:28.981866 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:25:28.987349 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:25:29.019460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '317593b5-6261-4d97-bb0b-3f517b8bf1ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1c7830>]}
[0m21:25:29.122085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '317593b5-6261-4d97-bb0b-3f517b8bf1ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3f5040>]}
[0m21:25:29.122646 [info ] [MainThread]: Found 1 model, 3 seeds, 577 macros
[0m21:25:29.123032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '317593b5-6261-4d97-bb0b-3f517b8bf1ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eca6c30>]}
[0m21:25:29.125188 [info ] [MainThread]: 
[0m21:25:29.125948 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:25:29.130844 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:25:29.147256 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:25:29.147873 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:25:29.148234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:25:29.655457 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.507 seconds
[0m21:25:29.657406 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:25:29.733205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m21:25:29.743151 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m21:25:29.743604 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m21:25:29.743922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:25:30.074370 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.330 seconds
[0m21:25:30.076415 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m21:25:30.232913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_transform)
[0m21:25:30.235952 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m21:25:30.236380 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m21:25:30.236685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:25:30.596717 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d49-0203-b580-0000-000318c2cdd9
[0m21:25:30.609917 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:25:30.610573 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:25:30.610898 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:25:30.611231 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m21:25:30.674661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '317593b5-6261-4d97-bb0b-3f517b8bf1ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3f4a70>]}
[0m21:25:30.675427 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:25:30.676047 [info ] [MainThread]: 
[0m21:25:30.679806 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.exercises
[0m21:25:30.680605 [info ] [Thread-1 (]: 1 of 3 START seed file public.exercises ........................................ [RUN]
[0m21:25:30.681261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now seed.caspar_health_technical_challenge.exercises)
[0m21:25:30.681923 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.exercises
[0m21:25:30.682578 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.exercises
[0m21:25:30.695017 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:30.695529 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
show parameters like 'query_tag' in session
[0m21:25:30.695895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:25:31.050746 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.355 seconds
[0m21:25:31.052334 [debug] [Thread-1 (]: Setting query_tag to 'exercises'. Will reset to '' after materialization.
[0m21:25:31.053810 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:31.054631 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
alter session set query_tag = 'exercises'
[0m21:25:31.114460 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.059 seconds
[0m21:25:35.589553 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:35.590640 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:25:35.687719 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m21:25:35.688287 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:35.688712 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."EXERCISES"
  ;
[0m21:25:35.890097 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.201 seconds
[0m21:25:35.890708 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:35.891254 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:25:36.070725 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m21:25:36.226457 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:36.226981 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:25:36.399177 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.172 seconds
[0m21:25:37.894577 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:37.895237 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:25:40.999488 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 3.104 seconds
[0m21:25:41.001241 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:41.001718 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:25:41.195384 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.193 seconds
[0m21:25:41.342785 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:41.343282 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:25:41.429871 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m21:25:42.905161 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:42.906150 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:25:45.504915 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.598 seconds
[0m21:25:45.506250 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:45.506796 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:25:45.679796 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.172 seconds
[0m21:25:45.822647 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:45.823411 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:25:45.895172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m21:25:47.438097 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:47.438985 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:25:50.217926 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.778 seconds
[0m21:25:50.219593 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:50.220025 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:25:50.372199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m21:25:50.514244 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:50.514790 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:25:50.601898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m21:25:52.099548 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:52.100144 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:25:54.823612 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.723 seconds
[0m21:25:54.824719 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:54.825134 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:25:55.060887 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.235 seconds
[0m21:25:55.196436 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:55.196950 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:25:55.308198 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m21:25:56.816177 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:56.817121 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:25:59.429094 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.611 seconds
[0m21:25:59.430145 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:59.430583 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:25:59.835548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m21:25:59.981923 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:25:59.982524 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:26:00.076983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.094 seconds
[0m21:26:01.606283 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:26:01.606983 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:26:04.142572 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.535 seconds
[0m21:26:04.144447 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:26:04.145023 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:26:04.398656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.253 seconds
[0m21:26:04.477941 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:26:04.478873 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:26:04.561693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.082 seconds
[0m21:26:05.463103 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:26:05.464617 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:26:07.254805 [debug] [Thread-1 (]: SQL status: SUCCESS 5427 in 1.786 seconds
[0m21:26:07.255970 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:26:07.256456 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:26:07.550398 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.293 seconds
[0m21:26:07.558810 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.caspar_health_technical_challenge.exercises"
[0m21:26:07.589921 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: Close
[0m21:26:07.659743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '317593b5-6261-4d97-bb0b-3f517b8bf1ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8df500>]}
[0m21:26:07.660362 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.exercises .................................... [[32mINSERT 65427[0m in 36.98s]
[0m21:26:07.661009 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.exercises
[0m21:26:07.661530 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.patients
[0m21:26:07.662135 [info ] [Thread-1 (]: 2 of 3 START seed file public.patients ......................................... [RUN]
[0m21:26:07.662636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.exercises, now seed.caspar_health_technical_challenge.patients)
[0m21:26:07.663128 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.patients
[0m21:26:07.663735 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.patients
[0m21:26:07.667386 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:26:07.667976 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
show parameters like 'query_tag' in session
[0m21:26:07.668468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:07.983689 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.315 seconds
[0m21:26:07.985307 [debug] [Thread-1 (]: Setting query_tag to 'patients'. Will reset to '' after materialization.
[0m21:26:07.986153 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:26:07.986561 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
alter session set query_tag = 'patients'
[0m21:26:08.053868 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.067 seconds
[0m21:26:08.057778 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: Close
[0m21:26:08.178941 [debug] [Thread-1 (]: Compilation Error in seed patients (seeds/patients.csv)
  Row 0 has 5 values, but Table only has 4 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by macro materialization_seed_snowflake (macros/materializations/seed.sql)
  > called by seed patients (seeds/patients.csv)
[0m21:26:08.179617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '317593b5-6261-4d97-bb0b-3f517b8bf1ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f008ef0>]}
[0m21:26:08.180172 [error] [Thread-1 (]: 2 of 3 ERROR loading seed file public.patients ................................. [[31mERROR[0m in 0.52s]
[0m21:26:08.180994 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.patients
[0m21:26:08.181666 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.steps
[0m21:26:08.183828 [info ] [Thread-1 (]: 3 of 3 START seed file public.steps ............................................ [RUN]
[0m21:26:08.184664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.patients, now seed.caspar_health_technical_challenge.steps)
[0m21:26:08.185168 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.steps
[0m21:26:08.185541 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.steps
[0m21:26:08.187941 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:26:08.188404 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
show parameters like 'query_tag' in session
[0m21:26:08.188752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:08.470217 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.281 seconds
[0m21:26:08.471733 [debug] [Thread-1 (]: Setting query_tag to 'steps'. Will reset to '' after materialization.
[0m21:26:08.472408 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:26:08.472793 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
alter session set query_tag = 'steps'
[0m21:26:08.530551 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.057 seconds
[0m21:26:09.287634 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:26:09.288175 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
BEGIN
[0m21:26:09.373702 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.085 seconds
[0m21:26:09.374390 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:26:09.374932 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STEPS"
  ;
[0m21:26:09.553464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.178 seconds
[0m21:26:09.554021 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:26:09.554416 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
COMMIT
[0m21:26:09.719247 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m21:26:09.863169 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:26:09.863753 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
BEGIN
[0m21:26:09.948028 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m21:26:11.480695 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:26:11.481225 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
insert into CASPAR_HEALTH.public.steps (ID, PATIENT_ID, STEPS, SUBMITTED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,...
[0m21:26:13.974351 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.493 seconds
[0m21:26:13.976613 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:26:13.977236 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
COMMIT
[0m21:26:14.214944 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.237 seconds
[0m21:26:14.246741 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:26:14.247568 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
BEGIN
[0m21:26:14.302612 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.054 seconds
[0m21:26:14.371102 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:26:14.371648 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
insert into CASPAR_HEALTH.public.steps (ID, PATIENT_ID, STEPS, SUBMITTED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,...
[0m21:26:15.275772 [debug] [Thread-1 (]: SQL status: SUCCESS 1909 in 0.904 seconds
[0m21:26:15.276872 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:26:15.277521 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
COMMIT
[0m21:26:15.605118 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.327 seconds
[0m21:26:15.606410 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.caspar_health_technical_challenge.steps"
[0m21:26:15.609505 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: Close
[0m21:26:15.670676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '317593b5-6261-4d97-bb0b-3f517b8bf1ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f762d20>]}
[0m21:26:15.671318 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file public.steps ........................................ [[32mINSERT 11909[0m in 7.49s]
[0m21:26:15.672171 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.steps
[0m21:26:15.673553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:15.674002 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.steps' was properly closed.
[0m21:26:15.674446 [info ] [MainThread]: 
[0m21:26:15.674840 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 46.55 seconds (46.55s).
[0m21:26:15.676341 [debug] [MainThread]: Command end result
[0m21:26:15.718632 [info ] [MainThread]: 
[0m21:26:15.719230 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:26:15.719667 [info ] [MainThread]: 
[0m21:26:15.720109 [error] [MainThread]:   Compilation Error in seed patients (seeds/patients.csv)
  Row 0 has 5 values, but Table only has 4 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by macro materialization_seed_snowflake (macros/materializations/seed.sql)
  > called by seed patients (seeds/patients.csv)
[0m21:26:15.720559 [info ] [MainThread]: 
[0m21:26:15.720929 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:26:15.721894 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 47.94165, "process_in_blocks": "0", "process_kernel_time": 1.610678, "process_mem_max_rss": "286711808", "process_out_blocks": "0", "process_user_time": 21.52419}
[0m21:26:15.722567 [debug] [MainThread]: Command `dbt seed` failed at 21:26:15.722432 after 47.94 seconds
[0m21:26:15.723026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5f3c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8c03b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f522690>]}
[0m21:26:15.723574 [debug] [MainThread]: Flushing usage events
[0m21:29:49.914836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ed7260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3c410>]}


============================== 21:29:49.921588 | 653fd475-f9f3-4d5c-aaaa-69b01305b558 ==============================
[0m21:29:49.921588 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:29:49.922202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m21:29:50.586962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '653fd475-f9f3-4d5c-aaaa-69b01305b558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3de80>]}
[0m21:29:50.646460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '653fd475-f9f3-4d5c-aaaa-69b01305b558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105533c50>]}
[0m21:29:50.648790 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:29:50.811899 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:29:51.037100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:29:51.038256 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/steps.csv
[0m21:29:51.244468 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:29:51.250028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '653fd475-f9f3-4d5c-aaaa-69b01305b558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aca690>]}
[0m21:29:51.361028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '653fd475-f9f3-4d5c-aaaa-69b01305b558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a3920>]}
[0m21:29:51.361559 [info ] [MainThread]: Found 1 model, 3 seeds, 577 macros
[0m21:29:51.361975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '653fd475-f9f3-4d5c-aaaa-69b01305b558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105949280>]}
[0m21:29:51.364117 [info ] [MainThread]: 
[0m21:29:51.364830 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:29:51.369183 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:29:51.385019 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:29:51.385487 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:29:51.385829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:51.848742 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.463 seconds
[0m21:29:51.850720 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:29:51.918558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m21:29:51.928690 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m21:29:51.929150 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m21:29:51.929469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:52.161841 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.232 seconds
[0m21:29:52.164158 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m21:29:52.256136 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_transform)
[0m21:29:52.260363 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m21:29:52.261007 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m21:29:52.261722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:52.586156 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d4d-0203-b314-0003-18c200011a4a
[0m21:29:52.586719 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:29:52.587164 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:29:52.587489 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:29:52.587815 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m21:29:52.654016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '653fd475-f9f3-4d5c-aaaa-69b01305b558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105613080>]}
[0m21:29:52.654720 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:29:52.655164 [info ] [MainThread]: 
[0m21:29:52.658590 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.exercises
[0m21:29:52.659144 [info ] [Thread-1 (]: 1 of 3 START seed file public.exercises ........................................ [RUN]
[0m21:29:52.659685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now seed.caspar_health_technical_challenge.exercises)
[0m21:29:52.660094 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.exercises
[0m21:29:52.660476 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.exercises
[0m21:29:52.668845 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:29:52.669357 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
show parameters like 'query_tag' in session
[0m21:29:52.669761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:52.941718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.272 seconds
[0m21:29:52.943288 [debug] [Thread-1 (]: Setting query_tag to 'exercises'. Will reset to '' after materialization.
[0m21:29:52.944948 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:29:52.945581 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
alter session set query_tag = 'exercises'
[0m21:29:53.011731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.066 seconds
[0m21:29:58.312074 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:29:58.312642 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:29:58.389762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m21:29:58.408235 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:29:58.408985 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."EXERCISES"
  ;
[0m21:29:58.577641 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.168 seconds
[0m21:29:58.578262 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:29:58.578694 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:30:00.164050 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.585 seconds
[0m21:30:00.320136 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:00.320639 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:30:00.505436 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m21:30:02.041575 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:02.042280 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:30:05.499710 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 3.457 seconds
[0m21:30:05.504184 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:05.504841 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:30:05.799654 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.294 seconds
[0m21:30:05.971856 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:05.972580 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:30:06.410776 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.437 seconds
[0m21:30:08.029901 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:08.030640 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:30:11.018597 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.987 seconds
[0m21:30:11.019905 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:11.020611 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:30:11.217727 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.196 seconds
[0m21:30:11.365956 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:11.366489 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:30:11.431366 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.064 seconds
[0m21:30:13.085961 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:13.086600 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:30:15.943834 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.857 seconds
[0m21:30:15.945308 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:15.945846 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:30:16.158234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.212 seconds
[0m21:30:16.307983 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:16.308620 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:30:16.379478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.070 seconds
[0m21:30:17.919845 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:17.920636 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:30:22.080550 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 4.159 seconds
[0m21:30:22.081763 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:22.082288 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:30:22.460878 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.378 seconds
[0m21:30:22.601905 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:22.602507 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:30:22.679464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.076 seconds
[0m21:30:24.238565 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:24.239275 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:30:28.024731 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 3.785 seconds
[0m21:30:28.025863 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:28.026466 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:30:28.412341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.385 seconds
[0m21:30:28.604842 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:28.605390 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:30:28.676686 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m21:30:30.278964 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:30.279535 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:30:32.733641 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.454 seconds
[0m21:30:32.734745 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:32.735166 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:30:32.943627 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m21:30:33.025989 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:33.026507 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:30:33.134814 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m21:30:33.681227 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:33.681784 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:30:35.191300 [debug] [Thread-1 (]: SQL status: SUCCESS 5427 in 1.509 seconds
[0m21:30:35.192409 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:30:35.192884 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:30:35.495426 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.302 seconds
[0m21:30:35.508050 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.caspar_health_technical_challenge.exercises"
[0m21:30:35.561203 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: Close
[0m21:30:35.654080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '653fd475-f9f3-4d5c-aaaa-69b01305b558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e81f40>]}
[0m21:30:35.654981 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file public.exercises .................................... [[32mINSERT 65427[0m in 42.99s]
[0m21:30:35.655916 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.exercises
[0m21:30:35.656402 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.patients
[0m21:30:35.656977 [info ] [Thread-1 (]: 2 of 3 START seed file public.patients ......................................... [RUN]
[0m21:30:35.657637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.exercises, now seed.caspar_health_technical_challenge.patients)
[0m21:30:35.658033 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.patients
[0m21:30:35.658629 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.patients
[0m21:30:35.662185 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:30:35.662951 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
show parameters like 'query_tag' in session
[0m21:30:35.663365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:36.010786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.347 seconds
[0m21:30:36.012390 [debug] [Thread-1 (]: Setting query_tag to 'patients'. Will reset to '' after materialization.
[0m21:30:36.013084 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:30:36.013575 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
alter session set query_tag = 'patients'
[0m21:30:36.130154 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m21:30:36.135385 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: Close
[0m21:30:36.223961 [debug] [Thread-1 (]: Compilation Error in seed patients (seeds/patients.csv)
  Row 0 has 5 values, but Table only has 4 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by macro materialization_seed_snowflake (macros/materializations/seed.sql)
  > called by seed patients (seeds/patients.csv)
[0m21:30:36.224756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '653fd475-f9f3-4d5c-aaaa-69b01305b558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105787050>]}
[0m21:30:36.225344 [error] [Thread-1 (]: 2 of 3 ERROR loading seed file public.patients ................................. [[31mERROR[0m in 0.57s]
[0m21:30:36.226018 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.patients
[0m21:30:36.226601 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.steps
[0m21:30:36.228188 [info ] [Thread-1 (]: 3 of 3 START seed file public.steps ............................................ [RUN]
[0m21:30:36.228838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.patients, now seed.caspar_health_technical_challenge.steps)
[0m21:30:36.229254 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.steps
[0m21:30:36.229682 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.steps
[0m21:30:36.237288 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:30:36.238069 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
show parameters like 'query_tag' in session
[0m21:30:36.238751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:36.530307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.292 seconds
[0m21:30:36.531757 [debug] [Thread-1 (]: Setting query_tag to 'steps'. Will reset to '' after materialization.
[0m21:30:36.532478 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:30:36.532895 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
alter session set query_tag = 'steps'
[0m21:30:36.594274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.061 seconds
[0m21:30:37.184096 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:30:37.184666 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
BEGIN
[0m21:30:37.284920 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m21:30:37.285443 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:30:37.285826 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STEPS"
  ;
[0m21:30:37.749825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.464 seconds
[0m21:30:37.750489 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:30:37.751555 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
COMMIT
[0m21:30:37.966515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.214 seconds
[0m21:30:38.120482 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:30:38.121193 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
BEGIN
[0m21:30:38.185428 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.063 seconds
[0m21:30:39.751800 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:30:39.752444 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
insert into CASPAR_HEALTH.public.steps (ID, PATIENT_ID, STEPS, SUBMISSION_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s...
[0m21:30:40.723576 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89d4e-0203-b580-0000-000318c2ce61
[0m21:30:40.724284 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 63
invalid identifier 'SUBMISSION_AT'
[0m21:30:40.725200 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: Close
[0m21:30:40.793333 [debug] [Thread-1 (]: Database Error in seed steps (seeds/steps.csv)
  000904 (42000): SQL compilation error: error line 1 at position 63
  invalid identifier 'SUBMISSION_AT'
[0m21:30:40.794168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '653fd475-f9f3-4d5c-aaaa-69b01305b558', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105785af0>]}
[0m21:30:40.794856 [error] [Thread-1 (]: 3 of 3 ERROR loading seed file public.steps .................................... [[31mERROR[0m in 4.57s]
[0m21:30:40.795778 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.steps
[0m21:30:40.797160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:40.797707 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.steps' was properly closed.
[0m21:30:40.798308 [info ] [MainThread]: 
[0m21:30:40.798966 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 49.43 seconds (49.43s).
[0m21:30:40.800632 [debug] [MainThread]: Command end result
[0m21:30:40.843082 [info ] [MainThread]: 
[0m21:30:40.844005 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:30:40.844514 [info ] [MainThread]: 
[0m21:30:40.845217 [error] [MainThread]:   Compilation Error in seed patients (seeds/patients.csv)
  Row 0 has 5 values, but Table only has 4 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by macro materialization_seed_snowflake (macros/materializations/seed.sql)
  > called by seed patients (seeds/patients.csv)
[0m21:30:40.845811 [info ] [MainThread]: 
[0m21:30:40.846280 [error] [MainThread]:   Database Error in seed steps (seeds/steps.csv)
  000904 (42000): SQL compilation error: error line 1 at position 63
  invalid identifier 'SUBMISSION_AT'
[0m21:30:40.846612 [info ] [MainThread]: 
[0m21:30:40.846990 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:30:40.847756 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 51.015682, "process_in_blocks": "0", "process_kernel_time": 1.73647, "process_mem_max_rss": "288616448", "process_out_blocks": "0", "process_user_time": 22.414324}
[0m21:30:40.848434 [debug] [MainThread]: Command `dbt seed` failed at 21:30:40.848297 after 51.02 seconds
[0m21:30:40.849038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ba960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104566420>]}
[0m21:30:40.849550 [debug] [MainThread]: Flushing usage events
[0m21:31:54.496699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a1e420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a0bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a382c0>]}


============================== 21:31:54.505056 | 5e275614-a365-497e-811b-4aa99569dfc4 ==============================
[0m21:31:54.505056 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:31:54.505766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:31:55.319857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e275614-a365-497e-811b-4aa99569dfc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d6c30>]}
[0m21:31:55.387747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e275614-a365-497e-811b-4aa99569dfc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d29730>]}
[0m21:31:55.389795 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:31:55.551671 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:31:55.787340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:31:55.788357 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/steps.csv
[0m21:31:55.789116 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/patients.csv
[0m21:31:56.038209 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:31:56.044030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e275614-a365-497e-811b-4aa99569dfc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108511d90>]}
[0m21:31:56.160169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e275614-a365-497e-811b-4aa99569dfc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087fd580>]}
[0m21:31:56.160786 [info ] [MainThread]: Found 1 model, 3 seeds, 577 macros
[0m21:31:56.161303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e275614-a365-497e-811b-4aa99569dfc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a00b0>]}
[0m21:31:56.163613 [info ] [MainThread]: 
[0m21:31:56.164463 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:31:56.169455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:31:56.185139 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:31:56.185604 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:31:56.185944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:56.658328 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.472 seconds
[0m21:31:56.660289 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:31:56.733911 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m21:31:56.745203 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m21:31:56.745928 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m21:31:56.746315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:57.070522 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d4f-0203-b42e-0003-18c2000128ae
[0m21:31:57.079663 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:31:57.080393 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:31:57.080831 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:31:57.081324 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m21:31:57.157409 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m21:31:57.176358 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m21:31:57.194373 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m21:31:57.213872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:57.761958 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.548 seconds
[0m21:31:57.764251 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m21:31:57.838032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e275614-a365-497e-811b-4aa99569dfc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b47d10>]}
[0m21:31:57.838743 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:31:57.839180 [info ] [MainThread]: 
[0m21:31:57.842235 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.exercises
[0m21:31:57.842897 [info ] [Thread-1 (]: 1 of 3 START seed file public.exercises ........................................ [RUN]
[0m21:31:57.843431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.exercises)
[0m21:31:57.843862 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.exercises
[0m21:31:57.844240 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.exercises
[0m21:31:57.853636 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:31:57.854159 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
show parameters like 'query_tag' in session
[0m21:31:57.854552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:58.185192 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.331 seconds
[0m21:31:58.186593 [debug] [Thread-1 (]: Setting query_tag to 'exercises'. Will reset to '' after materialization.
[0m21:31:58.187294 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:31:58.187762 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
alter session set query_tag = 'exercises'
[0m21:31:58.282482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.094 seconds
[0m21:32:02.661279 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:32:02.662297 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:32:02.781445 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m21:32:02.781967 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:32:02.782341 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."EXERCISES"
  ;
[0m21:32:03.047906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.265 seconds
[0m21:32:03.048624 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:32:03.049098 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:32:03.234380 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.185 seconds
[0m21:32:03.389485 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:32:03.390154 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:32:03.472507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.082 seconds
[0m21:32:05.012505 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:32:05.013555 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (1760588, 2227, 1, 2019-11-26T13:13:43.825+0100, 2023-12-02T16:08:16.809+0100) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(...
[0m21:32:05.577248 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89d50-0203-b42e-0003-18c2000128b6
[0m21:32:05.577735 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 44 unexpected '1760588'.
syntax error line 1 at position 122 unexpected 'values'.
[0m21:32:05.578241 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: Close
[0m21:32:05.657488 [debug] [Thread-1 (]: Database Error in seed exercises (seeds/exercises.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 44 unexpected '1760588'.
  syntax error line 1 at position 122 unexpected 'values'.
[0m21:32:05.659016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e275614-a365-497e-811b-4aa99569dfc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7f620>]}
[0m21:32:05.659610 [error] [Thread-1 (]: 1 of 3 ERROR loading seed file public.exercises ................................ [[31mERROR[0m in 7.81s]
[0m21:32:05.660249 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.exercises
[0m21:32:05.660704 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.patients
[0m21:32:05.661990 [info ] [Thread-1 (]: 2 of 3 START seed file public.patients ......................................... [RUN]
[0m21:32:05.662607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.exercises, now seed.caspar_health_technical_challenge.patients)
[0m21:32:05.663066 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.patients
[0m21:32:05.663438 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.patients
[0m21:32:05.665704 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:32:05.666115 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
show parameters like 'query_tag' in session
[0m21:32:05.666469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:06.046450 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.380 seconds
[0m21:32:06.047862 [debug] [Thread-1 (]: Setting query_tag to 'patients'. Will reset to '' after materialization.
[0m21:32:06.048544 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:32:06.048949 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
alter session set query_tag = 'patients'
[0m21:32:06.118431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.069 seconds
[0m21:32:06.124406 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:32:06.124930 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
BEGIN
[0m21:32:06.218447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m21:32:06.218944 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:32:06.219324 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."PATIENTS"
  ;
[0m21:32:06.331543 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m21:32:06.332087 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:32:06.332484 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
COMMIT
[0m21:32:06.628343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.295 seconds
[0m21:32:06.631385 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:32:06.631877 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
BEGIN
[0m21:32:06.785579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m21:32:06.788353 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:32:06.788852 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
insert into CASPAR_HEALTH.public.patients (0, 2227, Emily, Castaneda, Ethiopia) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,...
[0m21:32:06.852360 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89d50-0203-b314-0003-18c200011a76
[0m21:32:06.852859 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 43 unexpected '0'.
syntax error line 1 at position 80 unexpected 'values'.
[0m21:32:06.853462 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: Close
[0m21:32:06.932862 [debug] [Thread-1 (]: Database Error in seed patients (seeds/patients.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 43 unexpected '0'.
  syntax error line 1 at position 80 unexpected 'values'.
[0m21:32:06.933539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e275614-a365-497e-811b-4aa99569dfc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104295130>]}
[0m21:32:06.934268 [error] [Thread-1 (]: 2 of 3 ERROR loading seed file public.patients ................................. [[31mERROR[0m in 1.27s]
[0m21:32:06.935099 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.patients
[0m21:32:06.935748 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.steps
[0m21:32:06.936510 [info ] [Thread-1 (]: 3 of 3 START seed file public.steps ............................................ [RUN]
[0m21:32:06.937140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.caspar_health_technical_challenge.patients, now seed.caspar_health_technical_challenge.steps)
[0m21:32:06.937812 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.steps
[0m21:32:06.938287 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.steps
[0m21:32:06.941416 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:32:06.942162 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
show parameters like 'query_tag' in session
[0m21:32:06.942670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:07.364158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.421 seconds
[0m21:32:07.365705 [debug] [Thread-1 (]: Setting query_tag to 'steps'. Will reset to '' after materialization.
[0m21:32:07.366496 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:32:07.366943 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
alter session set query_tag = 'steps'
[0m21:32:07.426248 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.059 seconds
[0m21:32:07.999185 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:32:07.999844 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
BEGIN
[0m21:32:08.084217 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m21:32:08.099973 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:32:08.100494 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STEPS"
  ;
[0m21:32:08.257408 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m21:32:08.258002 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:32:08.258399 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
COMMIT
[0m21:32:08.399005 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m21:32:08.536782 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:32:08.537325 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
BEGIN
[0m21:32:08.624253 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m21:32:10.145298 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:32:10.146178 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
insert into CASPAR_HEALTH.public.steps (6297482, 356134, 50266560, 2023-08-04T21:26:06.000+0200, 2023-08-04T21:26:24.871+0200) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),...
[0m21:32:10.646918 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89d50-0203-b576-0003-18c200010ade
[0m21:32:10.647505 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 40 unexpected '6297482'.
syntax error line 1 at position 127 unexpected 'values'.
[0m21:32:10.648366 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: Close
[0m21:32:10.719421 [debug] [Thread-1 (]: Database Error in seed steps (seeds/steps.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 40 unexpected '6297482'.
  syntax error line 1 at position 127 unexpected 'values'.
[0m21:32:10.719983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e275614-a365-497e-811b-4aa99569dfc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d62b40>]}
[0m21:32:10.720529 [error] [Thread-1 (]: 3 of 3 ERROR loading seed file public.steps .................................... [[31mERROR[0m in 3.78s]
[0m21:32:10.721187 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.steps
[0m21:32:10.722579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:10.722996 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.steps' was properly closed.
[0m21:32:10.723382 [info ] [MainThread]: 
[0m21:32:10.723748 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 14.56 seconds (14.56s).
[0m21:32:10.724729 [debug] [MainThread]: Command end result
[0m21:32:10.766104 [info ] [MainThread]: 
[0m21:32:10.766874 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m21:32:10.767362 [info ] [MainThread]: 
[0m21:32:10.767808 [error] [MainThread]:   Database Error in seed exercises (seeds/exercises.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 44 unexpected '1760588'.
  syntax error line 1 at position 122 unexpected 'values'.
[0m21:32:10.768168 [info ] [MainThread]: 
[0m21:32:10.768592 [error] [MainThread]:   Database Error in seed patients (seeds/patients.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 43 unexpected '0'.
  syntax error line 1 at position 80 unexpected 'values'.
[0m21:32:10.769161 [info ] [MainThread]: 
[0m21:32:10.769886 [error] [MainThread]:   Database Error in seed steps (seeds/steps.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 40 unexpected '6297482'.
  syntax error line 1 at position 127 unexpected 'values'.
[0m21:32:10.770390 [info ] [MainThread]: 
[0m21:32:10.770803 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m21:32:10.771499 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 16.424597, "process_in_blocks": "0", "process_kernel_time": 1.058303, "process_mem_max_rss": "288296960", "process_out_blocks": "0", "process_user_time": 11.643676}
[0m21:32:10.772369 [debug] [MainThread]: Command `dbt seed` failed at 21:32:10.772113 after 16.43 seconds
[0m21:32:10.773548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee4c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746a3c0>]}
[0m21:32:10.774108 [debug] [MainThread]: Flushing usage events
[0m21:32:34.175253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087584d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108758290>]}


============================== 21:32:34.200291 | 6856a13f-80e4-45fe-a724-0416be57d226 ==============================
[0m21:32:34.200291 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:32:34.202062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:32:34.821500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6856a13f-80e4-45fe-a724-0416be57d226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930b470>]}
[0m21:32:34.878562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6856a13f-80e4-45fe-a724-0416be57d226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc68d0>]}
[0m21:32:34.880393 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:32:35.023677 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:32:35.202288 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m21:32:35.202819 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://seeds/steps.csv
[0m21:32:35.203255 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://seeds/patients.csv
[0m21:32:35.408130 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.caspar_health_technical_challenge.patients_enhanced' (models/transform/patients_enhanced.sql) depends on a node named 'patients' which was not found
[0m21:32:35.426708 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.3383052, "process_in_blocks": "0", "process_kernel_time": 0.465062, "process_mem_max_rss": "119382016", "process_out_blocks": "0", "process_user_time": 2.07385}
[0m21:32:35.445649 [debug] [MainThread]: Command `dbt seed` failed at 21:32:35.445445 after 1.36 seconds
[0m21:32:35.446338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108758350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a55700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107460fb0>]}
[0m21:32:35.446873 [debug] [MainThread]: Flushing usage events
[0m21:35:21.580569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048dfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a24710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a244d0>]}


============================== 21:35:21.586851 | 9acfb4ce-2dd6-4980-8d2c-72aced6563df ==============================
[0m21:35:21.586851 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:35:21.587511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:35:22.309890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9acfb4ce-2dd6-4980-8d2c-72aced6563df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a25ca0>]}
[0m21:35:22.366868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9acfb4ce-2dd6-4980-8d2c-72aced6563df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104525d00>]}
[0m21:35:22.368286 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:35:22.524334 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:35:22.738902 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m21:35:22.739471 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://seeds/steps.csv
[0m21:35:22.739938 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://seeds/patients.csv
[0m21:35:22.957845 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.caspar_health_technical_challenge.patients_enhanced' (models/transform/patients_enhanced.sql) depends on a node named 'patients' which was not found
[0m21:35:22.959514 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.4585161, "process_in_blocks": "0", "process_kernel_time": 0.520369, "process_mem_max_rss": "118943744", "process_out_blocks": "0", "process_user_time": 2.157222}
[0m21:35:22.960227 [debug] [MainThread]: Command `dbt seed` failed at 21:35:22.960113 after 1.46 seconds
[0m21:35:22.960791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a24680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f21520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e3b00>]}
[0m21:35:22.961157 [debug] [MainThread]: Flushing usage events
[0m21:35:35.819710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118c3fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111938590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111938350>]}


============================== 21:35:35.826949 | 152761e3-bada-4c48-ab14-8070253048a0 ==============================
[0m21:35:35.826949 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:35:35.827650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:35:36.495720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '152761e3-bada-4c48-ab14-8070253048a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cd6c30>]}
[0m21:35:36.560328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '152761e3-bada-4c48-ab14-8070253048a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107e64b0>]}
[0m21:35:36.562320 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:35:36.720961 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:35:36.917314 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m21:35:36.917898 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://seeds/steps.csv
[0m21:35:36.918521 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://models/transform/patients_enhanced.sql
[0m21:35:36.919048 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://seeds/patients.csv
[0m21:35:36.969849 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m21:35:36.977007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '152761e3-bada-4c48-ab14-8070253048a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eb9bb0>]}
[0m21:35:37.073865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '152761e3-bada-4c48-ab14-8070253048a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112750fb0>]}
[0m21:35:37.074537 [info ] [MainThread]: Found 1 seed, 577 macros
[0m21:35:37.074917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '152761e3-bada-4c48-ab14-8070253048a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112586a20>]}
[0m21:35:37.077225 [info ] [MainThread]: 
[0m21:35:37.077944 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:35:37.078900 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:35:37.095909 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:35:37.096409 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:35:37.096784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:37.575798 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.479 seconds
[0m21:35:37.577850 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:35:37.651923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m21:35:37.662207 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m21:35:37.662733 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m21:35:37.663137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:37.971537 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.308 seconds
[0m21:35:37.973872 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m21:35:38.064327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '152761e3-bada-4c48-ab14-8070253048a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111caa1b0>]}
[0m21:35:38.065001 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:35:38.065449 [info ] [MainThread]: 
[0m21:35:38.069866 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.exercises
[0m21:35:38.070564 [info ] [Thread-1 (]: 1 of 1 START seed file public.exercises ........................................ [RUN]
[0m21:35:38.071115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.exercises)
[0m21:35:38.071536 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.exercises
[0m21:35:38.071925 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.exercises
[0m21:35:38.081212 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:35:38.081839 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
show parameters like 'query_tag' in session
[0m21:35:38.082213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:38.377755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.295 seconds
[0m21:35:38.379350 [debug] [Thread-1 (]: Setting query_tag to 'exercises'. Will reset to '' after materialization.
[0m21:35:38.380533 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:35:38.380929 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
alter session set query_tag = 'exercises'
[0m21:35:38.466042 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.085 seconds
[0m21:35:43.293530 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:35:43.294366 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:35:43.403183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m21:35:43.403733 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:35:43.404113 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."EXERCISES"
  ;
[0m21:35:43.567910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.163 seconds
[0m21:35:43.568505 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:35:43.568914 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:35:43.759651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.190 seconds
[0m21:35:43.925628 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:35:43.926208 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:35:44.025120 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m21:35:45.656229 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:35:45.656914 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:35:48.663174 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 3.006 seconds
[0m21:35:48.667028 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:35:48.667591 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:35:48.852299 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m21:35:48.995018 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:35:48.995603 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:35:49.083038 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m21:35:51.081801 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:35:51.082644 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:35:53.538102 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.455 seconds
[0m21:35:53.539685 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:35:53.540222 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:35:53.703514 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.163 seconds
[0m21:35:53.862965 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:35:53.870261 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:35:53.963766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m21:35:55.555830 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:35:55.556414 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:35:58.418059 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.861 seconds
[0m21:35:58.419100 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:35:58.419516 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:35:58.600493 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.181 seconds
[0m21:35:58.760437 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:35:58.760964 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:35:58.814762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.053 seconds
[0m21:36:00.628330 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:36:00.634834 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:36:03.300546 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.665 seconds
[0m21:36:03.302087 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:36:03.302658 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:36:03.584284 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.281 seconds
[0m21:36:03.744728 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:36:03.745976 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:36:03.889763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.143 seconds
[0m21:36:05.571697 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:36:05.576374 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:36:08.321241 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.744 seconds
[0m21:36:08.322689 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:36:08.323224 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:36:08.482427 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m21:36:08.645229 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:36:08.646489 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:36:08.707800 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.060 seconds
[0m21:36:10.396475 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:36:10.397116 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:36:12.928717 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.531 seconds
[0m21:36:12.930532 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:36:12.931071 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:36:13.128670 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.197 seconds
[0m21:36:13.209866 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:36:13.210460 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
BEGIN
[0m21:36:13.277261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.066 seconds
[0m21:36:13.808786 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:36:13.809479 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
insert into CASPAR_HEALTH.public.exercises (ID, PATIENT_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%...
[0m21:36:15.280617 [debug] [Thread-1 (]: SQL status: SUCCESS 5427 in 1.471 seconds
[0m21:36:15.281726 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.exercises"
[0m21:36:15.282185 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.exercises"} */
COMMIT
[0m21:36:15.600315 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m21:36:15.608644 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.caspar_health_technical_challenge.exercises"
[0m21:36:15.645039 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.exercises: Close
[0m21:36:15.806996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '152761e3-bada-4c48-ab14-8070253048a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126ff050>]}
[0m21:36:15.808246 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.exercises .................................... [[32mINSERT 65427[0m in 37.73s]
[0m21:36:15.810105 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.exercises
[0m21:36:15.812262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:15.812856 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.exercises' was properly closed.
[0m21:36:15.813337 [info ] [MainThread]: 
[0m21:36:15.814236 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 38.74 seconds (38.74s).
[0m21:36:15.815832 [debug] [MainThread]: Command end result
[0m21:36:15.863810 [info ] [MainThread]: 
[0m21:36:15.864757 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:36:15.865676 [info ] [MainThread]: 
[0m21:36:15.866950 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:36:15.868347 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 40.131416, "process_in_blocks": "0", "process_kernel_time": 1.619527, "process_mem_max_rss": "285278208", "process_out_blocks": "0", "process_user_time": 19.632717}
[0m21:36:15.869511 [debug] [MainThread]: Command `dbt seed` succeeded at 21:36:15.869291 after 40.13 seconds
[0m21:36:15.870355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e324d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122861b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111629520>]}
[0m21:36:15.870906 [debug] [MainThread]: Flushing usage events
[0m21:38:31.086751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108236d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d54620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d543e0>]}


============================== 21:38:31.094156 | 30b53bb2-a4d8-41ac-b233-17ccb2c3b27f ==============================
[0m21:38:31.094156 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:38:31.094962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'seeds/patients.csv', 'invocation_command': 'dbt seed --target-path seeds/patients.csv', 'send_anonymous_usage_stats': 'True'}
[0m21:38:32.091287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30b53bb2-a4d8-41ac-b233-17ccb2c3b27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109964170>]}
[0m21:38:32.150722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30b53bb2-a4d8-41ac-b233-17ccb2c3b27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10990a540>]}
[0m21:38:32.152512 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:38:32.312122 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:38:32.313296 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:38:32.313752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '30b53bb2-a4d8-41ac-b233-17ccb2c3b27f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce7650>]}
[0m21:38:34.067588 [error] [MainThread]: Encountered an error:
[Errno 20] Not a directory: '/Users/jonfernandez/Documents/caspar_health_technical_challenge/seeds/patients.csv/partial_parse.msgpack'
[0m21:38:34.069667 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 525, in load
    self.write_manifest_for_partial_parse()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 813, in write_manifest_for_partial_parse
    with open(path, "wb") as fp:
         ^^^^^^^^^^^^^^^^
NotADirectoryError: [Errno 20] Not a directory: '/Users/jonfernandez/Documents/caspar_health_technical_challenge/seeds/patients.csv/partial_parse.msgpack'

[0m21:38:34.094249 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.096547, "process_in_blocks": "0", "process_kernel_time": 0.623601, "process_mem_max_rss": "122535936", "process_out_blocks": "0", "process_user_time": 3.519665}
[0m21:38:34.095159 [debug] [MainThread]: Command `dbt seed` failed at 21:38:34.094939 after 3.10 seconds
[0m21:38:34.095668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d54380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10828e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d153d0>]}
[0m21:38:34.096122 [debug] [MainThread]: Flushing usage events
[0m21:39:21.232095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106622a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a786b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a78470>]}


============================== 21:39:21.238509 | b42eb666-fe89-4b33-a56e-0603bf5fa203 ==============================
[0m21:39:21.238509 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:39:21.239415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --select patients', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:39:21.915774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b42eb666-fe89-4b33-a56e-0603bf5fa203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a49f260>]}
[0m21:39:21.973129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b42eb666-fe89-4b33-a56e-0603bf5fa203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a79d90>]}
[0m21:39:21.974547 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:39:22.122279 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:39:22.288903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m21:39:22.289533 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://models/transform/patients_enhanced.sql
[0m21:39:22.289918 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://seeds/patients.csv
[0m21:39:22.290256 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://seeds/steps.csv
[0m21:39:22.709272 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:39:22.715146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b42eb666-fe89-4b33-a56e-0603bf5fa203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab02930>]}
[0m21:39:22.842337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b42eb666-fe89-4b33-a56e-0603bf5fa203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac83a70>]}
[0m21:39:22.842915 [info ] [MainThread]: Found 3 seeds, 1 model, 577 macros
[0m21:39:22.843302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b42eb666-fe89-4b33-a56e-0603bf5fa203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7dd490>]}
[0m21:39:22.845218 [info ] [MainThread]: 
[0m21:39:22.846008 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:39:22.847034 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:39:22.862053 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:39:22.862554 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:39:22.863156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:23.474659 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.611 seconds
[0m21:39:23.476355 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:39:23.566593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m21:39:23.576299 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m21:39:23.576789 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m21:39:23.577125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:39:24.044168 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d57-0203-b526-0000-000318c2ae5d
[0m21:39:24.044698 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:39:24.045183 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:39:24.045519 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:39:24.045881 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m21:39:24.116659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m21:39:24.119102 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m21:39:24.119545 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m21:39:24.119859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:39:24.468860 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.349 seconds
[0m21:39:24.470805 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m21:39:24.546612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b42eb666-fe89-4b33-a56e-0603bf5fa203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad83560>]}
[0m21:39:24.547245 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:39:24.547634 [info ] [MainThread]: 
[0m21:39:24.550535 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.patients
[0m21:39:24.551194 [info ] [Thread-1 (]: 1 of 1 START seed file public.patients ......................................... [RUN]
[0m21:39:24.551748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.patients)
[0m21:39:24.552155 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.patients
[0m21:39:24.552520 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.patients
[0m21:39:24.562110 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:39:24.562640 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
show parameters like 'query_tag' in session
[0m21:39:24.563019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:24.898290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.335 seconds
[0m21:39:24.899665 [debug] [Thread-1 (]: Setting query_tag to 'patients'. Will reset to '' after materialization.
[0m21:39:24.900460 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:39:24.900966 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
alter session set query_tag = 'patients'
[0m21:39:25.419060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.517 seconds
[0m21:39:25.437737 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: Close
[0m21:39:25.509752 [debug] [Thread-1 (]: Compilation Error in seed patients (seeds/patients.csv)
  Row 0 has 5 values, but Table only has 4 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by macro materialization_seed_snowflake (macros/materializations/seed.sql)
  > called by seed patients (seeds/patients.csv)
[0m21:39:25.511603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b42eb666-fe89-4b33-a56e-0603bf5fa203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbb620>]}
[0m21:39:25.512335 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.patients ................................. [[31mERROR[0m in 0.96s]
[0m21:39:25.513433 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.patients
[0m21:39:25.515690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:25.516202 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.patients' was properly closed.
[0m21:39:25.516590 [info ] [MainThread]: 
[0m21:39:25.516950 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m21:39:25.518317 [debug] [MainThread]: Command end result
[0m21:39:25.553722 [info ] [MainThread]: 
[0m21:39:25.554341 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:39:25.554979 [info ] [MainThread]: 
[0m21:39:25.555568 [error] [MainThread]:   Compilation Error in seed patients (seeds/patients.csv)
  Row 0 has 5 values, but Table only has 4 columns.
  
  > in macro materialization_seed_default (macros/materializations/seeds/seed.sql)
  > called by macro materialization_seed_snowflake (macros/materializations/seed.sql)
  > called by seed patients (seeds/patients.csv)
[0m21:39:25.556107 [info ] [MainThread]: 
[0m21:39:25.556837 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:39:25.557628 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 4.414283, "process_in_blocks": "0", "process_kernel_time": 0.585708, "process_mem_max_rss": "133591040", "process_out_blocks": "0", "process_user_time": 2.890675}
[0m21:39:25.558193 [debug] [MainThread]: Command `dbt seed` failed at 21:39:25.558074 after 4.41 seconds
[0m21:39:25.558659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106622a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10979a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a438ce0>]}
[0m21:39:25.559068 [debug] [MainThread]: Flushing usage events
[0m21:40:46.958400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110466ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107487a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110748560>]}


============================== 21:40:46.965643 | 0868ae83-1b51-4136-8d9d-0f2cdafbc28e ==============================
[0m21:40:46.965643 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:40:46.966358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --select patients', 'send_anonymous_usage_stats': 'True'}
[0m21:40:47.841135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0868ae83-1b51-4136-8d9d-0f2cdafbc28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107140e0>]}
[0m21:40:47.937947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0868ae83-1b51-4136-8d9d-0f2cdafbc28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111295b50>]}
[0m21:40:47.940630 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:40:48.130591 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:40:48.398731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:40:48.399656 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/patients.csv
[0m21:40:48.605677 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:40:48.611700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0868ae83-1b51-4136-8d9d-0f2cdafbc28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113a67b0>]}
[0m21:40:48.721159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0868ae83-1b51-4136-8d9d-0f2cdafbc28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11183b530>]}
[0m21:40:48.721708 [info ] [MainThread]: Found 3 seeds, 1 model, 577 macros
[0m21:40:48.722078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0868ae83-1b51-4136-8d9d-0f2cdafbc28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112c5730>]}
[0m21:40:48.723834 [info ] [MainThread]: 
[0m21:40:48.724509 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:40:48.725435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:40:48.739412 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:40:48.739902 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:40:48.740223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:49.161302 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.421 seconds
[0m21:40:49.163392 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:40:49.236332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m21:40:49.246742 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m21:40:49.247242 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m21:40:49.247566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:40:49.539172 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d58-0203-b576-0003-18c200010b4e
[0m21:40:49.539634 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:40:49.540083 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:40:49.540383 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:40:49.540735 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m21:40:49.631293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m21:40:49.633999 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m21:40:49.634438 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m21:40:49.634755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:40:49.886303 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.251 seconds
[0m21:40:49.888643 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m21:40:49.952750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0868ae83-1b51-4136-8d9d-0f2cdafbc28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118391f0>]}
[0m21:40:49.953505 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:40:49.953926 [info ] [MainThread]: 
[0m21:40:49.957446 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.patients
[0m21:40:49.958109 [info ] [Thread-1 (]: 1 of 1 START seed file public.patients ......................................... [RUN]
[0m21:40:49.958828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.patients)
[0m21:40:49.959801 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.patients
[0m21:40:49.960336 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.patients
[0m21:40:49.970520 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:40:49.971155 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
show parameters like 'query_tag' in session
[0m21:40:49.971712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:50.262529 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.291 seconds
[0m21:40:50.264331 [debug] [Thread-1 (]: Setting query_tag to 'patients'. Will reset to '' after materialization.
[0m21:40:50.265688 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:40:50.266148 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
alter session set query_tag = 'patients'
[0m21:40:50.318140 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.051 seconds
[0m21:40:50.352369 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:40:50.352971 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
BEGIN
[0m21:40:50.426872 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m21:40:50.427396 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:40:50.427755 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."PATIENTS"
  ;
[0m21:40:50.568147 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m21:40:50.568710 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:40:50.569135 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
COMMIT
[0m21:40:50.720469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m21:40:50.739242 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:40:50.739866 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
BEGIN
[0m21:40:50.815565 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m21:40:50.817963 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:40:50.818438 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
insert into CASPAR_HEALTH.public.patients (PATIENT_ID, first_name, last_name, country) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m21:40:50.883779 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89d58-0203-b580-0000-000318c2cf09
[0m21:40:50.884342 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 43
invalid identifier 'PATIENT_ID'
[0m21:40:50.884866 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: Close
[0m21:40:50.977517 [debug] [Thread-1 (]: Database Error in seed patients (seeds/patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 43
  invalid identifier 'PATIENT_ID'
[0m21:40:50.979160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0868ae83-1b51-4136-8d9d-0f2cdafbc28e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c4b9b0>]}
[0m21:40:50.979841 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.patients ................................. [[31mERROR[0m in 1.02s]
[0m21:40:50.980618 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.patients
[0m21:40:50.983211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:50.983851 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.patients' was properly closed.
[0m21:40:50.984201 [info ] [MainThread]: 
[0m21:40:50.984558 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m21:40:50.985231 [debug] [MainThread]: Command end result
[0m21:40:51.099652 [info ] [MainThread]: 
[0m21:40:51.100594 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:40:51.101207 [info ] [MainThread]: 
[0m21:40:51.101828 [error] [MainThread]:   Database Error in seed patients (seeds/patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 43
  invalid identifier 'PATIENT_ID'
[0m21:40:51.102213 [info ] [MainThread]: 
[0m21:40:51.102556 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:40:51.103283 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 4.2282686, "process_in_blocks": "0", "process_kernel_time": 0.671885, "process_mem_max_rss": "133373952", "process_out_blocks": "0", "process_user_time": 2.952229}
[0m21:40:51.104262 [debug] [MainThread]: Command `dbt seed` failed at 21:40:51.103971 after 4.23 seconds
[0m21:40:51.105072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c43140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11181d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11181d760>]}
[0m21:40:51.105633 [debug] [MainThread]: Flushing usage events
[0m21:41:31.865405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efd9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101306e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101304a0>]}


============================== 21:41:31.873182 | c06adb87-1792-4179-83bc-e30957e9aab7 ==============================
[0m21:41:31.873182 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:41:31.873988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --select patients', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:41:32.571136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c06adb87-1792-4179-83bc-e30957e9aab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11090f290>]}
[0m21:41:32.639914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c06adb87-1792-4179-83bc-e30957e9aab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb5af30>]}
[0m21:41:32.641366 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:41:32.800621 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:41:32.987627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:41:32.988310 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/steps.csv
[0m21:41:33.209488 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:41:33.215399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c06adb87-1792-4179-83bc-e30957e9aab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cc1c10>]}
[0m21:41:33.341289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c06adb87-1792-4179-83bc-e30957e9aab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e9acc0>]}
[0m21:41:33.342024 [info ] [MainThread]: Found 3 seeds, 1 model, 577 macros
[0m21:41:33.342636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c06adb87-1792-4179-83bc-e30957e9aab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111a6420>]}
[0m21:41:33.344687 [info ] [MainThread]: 
[0m21:41:33.345559 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:41:33.348200 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:41:33.367474 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:41:33.367968 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:41:33.368411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:34.021173 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.653 seconds
[0m21:41:34.023324 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:41:34.093327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m21:41:34.103231 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m21:41:34.103732 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m21:41:34.104119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:41:34.430451 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d59-0203-b314-0003-18c200011afa
[0m21:41:34.430933 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:41:34.431398 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:41:34.431699 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:41:34.432165 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m21:41:34.501833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m21:41:34.504347 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m21:41:34.505188 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m21:41:34.505657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:41:34.802998 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.297 seconds
[0m21:41:34.805853 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m21:41:34.897871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c06adb87-1792-4179-83bc-e30957e9aab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e6030>]}
[0m21:41:34.898493 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:41:34.898880 [info ] [MainThread]: 
[0m21:41:34.902131 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.patients
[0m21:41:34.902804 [info ] [Thread-1 (]: 1 of 1 START seed file public.patients ......................................... [RUN]
[0m21:41:34.903508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.patients)
[0m21:41:34.903920 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.patients
[0m21:41:34.904293 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.patients
[0m21:41:34.914482 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:41:34.926673 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
show parameters like 'query_tag' in session
[0m21:41:34.927315 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:41:35.174398 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m21:41:35.175915 [debug] [Thread-1 (]: Setting query_tag to 'patients'. Will reset to '' after materialization.
[0m21:41:35.176790 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:41:35.177270 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
alter session set query_tag = 'patients'
[0m21:41:35.229023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.051 seconds
[0m21:41:35.265857 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:41:35.266368 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
BEGIN
[0m21:41:35.370363 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m21:41:35.371277 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:41:35.371925 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."PATIENTS"
  ;
[0m21:41:35.495716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m21:41:35.496479 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:41:35.497153 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
COMMIT
[0m21:41:35.653890 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m21:41:35.671912 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:41:35.672646 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
BEGIN
[0m21:41:35.742944 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.070 seconds
[0m21:41:35.745284 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:41:35.745778 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
insert into CASPAR_HEALTH.public.patients (PATIENT_ID, first_name, last_name, country) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m21:41:35.807953 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89d59-0203-b314-0003-18c200011b02
[0m21:41:35.808543 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 43
invalid identifier 'PATIENT_ID'
[0m21:41:35.809277 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: Close
[0m21:41:35.895826 [debug] [Thread-1 (]: Database Error in seed patients (seeds/patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 43
  invalid identifier 'PATIENT_ID'
[0m21:41:35.898333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c06adb87-1792-4179-83bc-e30957e9aab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115eff20>]}
[0m21:41:35.899005 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.patients ................................. [[31mERROR[0m in 0.99s]
[0m21:41:35.899875 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.patients
[0m21:41:35.901986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:41:35.902404 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.patients' was properly closed.
[0m21:41:35.902846 [info ] [MainThread]: 
[0m21:41:35.903213 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m21:41:35.903888 [debug] [MainThread]: Command end result
[0m21:41:36.005685 [info ] [MainThread]: 
[0m21:41:36.006330 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:41:36.006715 [info ] [MainThread]: 
[0m21:41:36.007139 [error] [MainThread]:   Database Error in seed patients (seeds/patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 43
  invalid identifier 'PATIENT_ID'
[0m21:41:36.007530 [info ] [MainThread]: 
[0m21:41:36.007906 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:41:36.008712 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 4.258635, "process_in_blocks": "0", "process_kernel_time": 0.62475, "process_mem_max_rss": "131854336", "process_out_blocks": "0", "process_user_time": 2.901721}
[0m21:41:36.009375 [debug] [MainThread]: Command `dbt seed` failed at 21:41:36.009226 after 4.26 seconds
[0m21:41:36.009836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111087a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110a1d30>]}
[0m21:41:36.010370 [debug] [MainThread]: Flushing usage events
[0m21:42:00.974474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113771d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142387a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114238560>]}


============================== 21:42:00.983152 | 43498f6a-7cd4-4717-9592-8f50775a2baa ==============================
[0m21:42:00.983152 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:42:00.983889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --select patients', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:42:01.705459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43498f6a-7cd4-4717-9592-8f50775a2baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bfcbc0>]}
[0m21:42:01.766135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43498f6a-7cd4-4717-9592-8f50775a2baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a958b0>]}
[0m21:42:01.768113 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:42:01.961878 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:42:02.174840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:42:02.175555 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/steps.csv
[0m21:42:02.176044 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/patients.csv
[0m21:42:02.393992 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:42:02.400930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43498f6a-7cd4-4717-9592-8f50775a2baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115192390>]}
[0m21:42:02.517904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43498f6a-7cd4-4717-9592-8f50775a2baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f85eb0>]}
[0m21:42:02.518439 [info ] [MainThread]: Found 3 seeds, 1 model, 577 macros
[0m21:42:02.518822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43498f6a-7cd4-4717-9592-8f50775a2baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152667e0>]}
[0m21:42:02.520488 [info ] [MainThread]: 
[0m21:42:02.521166 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:42:02.522186 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:42:02.537182 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:42:02.537654 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:42:02.538042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:02.974804 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.437 seconds
[0m21:42:02.976746 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:42:03.050459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m21:42:03.061115 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m21:42:03.061602 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m21:42:03.061955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:03.373259 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d5a-0203-b580-0000-000318c2cf25
[0m21:42:03.373724 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:42:03.374203 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:42:03.374522 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:42:03.374872 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m21:42:03.450167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m21:42:03.452584 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m21:42:03.453046 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m21:42:03.453398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:03.762348 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.309 seconds
[0m21:42:03.764715 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m21:42:03.838127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43498f6a-7cd4-4717-9592-8f50775a2baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f85160>]}
[0m21:42:03.839217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:42:03.839790 [info ] [MainThread]: 
[0m21:42:03.842653 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.patients
[0m21:42:03.843607 [info ] [Thread-1 (]: 1 of 1 START seed file public.patients ......................................... [RUN]
[0m21:42:03.844510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.patients)
[0m21:42:03.845391 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.patients
[0m21:42:03.846250 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.patients
[0m21:42:03.862839 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:42:03.864348 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
show parameters like 'query_tag' in session
[0m21:42:03.865001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:42:04.140807 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.276 seconds
[0m21:42:04.142370 [debug] [Thread-1 (]: Setting query_tag to 'patients'. Will reset to '' after materialization.
[0m21:42:04.143340 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:42:04.143861 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
alter session set query_tag = 'patients'
[0m21:42:04.199117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.055 seconds
[0m21:42:04.237691 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:42:04.238203 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
BEGIN
[0m21:42:04.324777 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m21:42:04.325329 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:42:04.325794 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."PATIENTS"
  ;
[0m21:42:04.476218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.150 seconds
[0m21:42:04.476798 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:42:04.477189 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
COMMIT
[0m21:42:04.633133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m21:42:04.650441 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:42:04.650943 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
BEGIN
[0m21:42:04.710435 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.059 seconds
[0m21:42:04.713230 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:42:04.714113 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
insert into CASPAR_HEALTH.public.patients (id, first_name, last_name, country) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%...
[0m21:42:05.289829 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 0.575 seconds
[0m21:42:05.291300 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.patients"
[0m21:42:05.292041 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.patients"} */
COMMIT
[0m21:42:05.695105 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m21:42:05.702677 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.caspar_health_technical_challenge.patients"
[0m21:42:05.794391 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.patients: Close
[0m21:42:05.864796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43498f6a-7cd4-4717-9592-8f50775a2baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113773770>]}
[0m21:42:05.865658 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.patients ..................................... [[32mINSERT 100[0m in 2.02s]
[0m21:42:05.866482 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.patients
[0m21:42:05.868066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:42:05.868696 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.patients' was properly closed.
[0m21:42:05.869456 [info ] [MainThread]: 
[0m21:42:05.870028 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.35 seconds (3.35s).
[0m21:42:05.870867 [debug] [MainThread]: Command end result
[0m21:42:05.915772 [info ] [MainThread]: 
[0m21:42:05.916744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:42:05.917530 [info ] [MainThread]: 
[0m21:42:05.918324 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:42:05.919687 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 5.0284023, "process_in_blocks": "0", "process_kernel_time": 0.639707, "process_mem_max_rss": "132222976", "process_out_blocks": "0", "process_user_time": 2.964848}
[0m21:42:05.920906 [debug] [MainThread]: Command `dbt seed` succeeded at 21:42:05.920667 after 5.03 seconds
[0m21:42:05.921612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ef1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e8d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f9d010>]}
[0m21:42:05.923025 [debug] [MainThread]: Flushing usage events
[0m21:42:19.206121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108012750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b28590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b28350>]}


============================== 21:42:19.214040 | 396c895c-2682-4fd2-bcf3-926d9e19cf7b ==============================
[0m21:42:19.214040 [info ] [MainThread]: Running with dbt=1.8.9
[0m21:42:19.214880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed --select steps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:42:20.211204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '396c895c-2682-4fd2-bcf3-926d9e19cf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2a240>]}
[0m21:42:20.278800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '396c895c-2682-4fd2-bcf3-926d9e19cf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ef470>]}
[0m21:42:20.280252 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:42:20.471081 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m21:42:20.746201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:42:20.746669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:42:20.752337 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m21:42:20.782604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '396c895c-2682-4fd2-bcf3-926d9e19cf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109725fa0>]}
[0m21:42:20.896275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '396c895c-2682-4fd2-bcf3-926d9e19cf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10993e330>]}
[0m21:42:20.897156 [info ] [MainThread]: Found 3 seeds, 1 model, 577 macros
[0m21:42:20.897668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '396c895c-2682-4fd2-bcf3-926d9e19cf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109727830>]}
[0m21:42:20.900003 [info ] [MainThread]: 
[0m21:42:20.901155 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:42:20.902439 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m21:42:20.919726 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m21:42:20.920179 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m21:42:20.920502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:21.396609 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.476 seconds
[0m21:42:21.398825 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m21:42:21.473176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m21:42:21.483266 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m21:42:21.484152 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m21:42:21.484599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:21.917834 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b89d5a-0203-b526-0000-000318c2ae99
[0m21:42:21.918297 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:42:21.918752 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:42:21.919055 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:42:21.919386 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m21:42:22.038161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m21:42:22.041229 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m21:42:22.041995 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m21:42:22.042571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:42:22.324051 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.281 seconds
[0m21:42:22.325873 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m21:42:22.397426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '396c895c-2682-4fd2-bcf3-926d9e19cf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c4590>]}
[0m21:42:22.398434 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:42:22.399244 [info ] [MainThread]: 
[0m21:42:22.403471 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.steps
[0m21:42:22.404477 [info ] [Thread-1 (]: 1 of 1 START seed file public.steps ............................................ [RUN]
[0m21:42:22.405388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.steps)
[0m21:42:22.406041 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.steps
[0m21:42:22.406484 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.steps
[0m21:42:22.419282 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:42:22.419790 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
show parameters like 'query_tag' in session
[0m21:42:22.420234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:42:22.778771 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.358 seconds
[0m21:42:22.780851 [debug] [Thread-1 (]: Setting query_tag to 'steps'. Will reset to '' after materialization.
[0m21:42:22.781664 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:42:22.782376 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
alter session set query_tag = 'steps'
[0m21:42:22.884255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.101 seconds
[0m21:42:23.720205 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:42:23.720970 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
BEGIN
[0m21:42:23.883240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.161 seconds
[0m21:42:23.884675 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:42:23.885442 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STEPS"
  ;
[0m21:42:24.078545 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m21:42:24.080654 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:42:24.081930 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
COMMIT
[0m21:42:24.298744 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.216 seconds
[0m21:42:24.557129 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:42:24.558020 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
BEGIN
[0m21:42:24.647793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m21:42:26.272196 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.steps"
[0m21:42:26.272919 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.steps"} */
insert into CASPAR_HEALTH.public.steps (ID, PATIENT_ID, STEPS, SUBMITTED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,...
[0m21:42:28.746409 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b89d5a-0203-b56e-0003-18c20001392a
[0m21:42:28.747439 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100035 (22007): Timestamp '2023-08-04T21:26:24.871+0200' is not recognized
[0m21:42:28.748066 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.steps: Close
[0m21:42:28.818979 [debug] [Thread-1 (]: Database Error in seed steps (seeds/steps.csv)
  100035 (22007): Timestamp '2023-08-04T21:26:24.871+0200' is not recognized
[0m21:42:28.820606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '396c895c-2682-4fd2-bcf3-926d9e19cf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e1faa0>]}
[0m21:42:28.821181 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.steps .................................... [[31mERROR[0m in 6.41s]
[0m21:42:28.821922 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.steps
[0m21:42:28.824290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:42:28.824701 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.steps' was properly closed.
[0m21:42:28.825041 [info ] [MainThread]: 
[0m21:42:28.825399 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 7.92 seconds (7.92s).
[0m21:42:28.826114 [debug] [MainThread]: Command end result
[0m21:42:28.881388 [info ] [MainThread]: 
[0m21:42:28.882165 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:42:28.882669 [info ] [MainThread]: 
[0m21:42:28.883063 [error] [MainThread]:   Database Error in seed steps (seeds/steps.csv)
  100035 (22007): Timestamp '2023-08-04T21:26:24.871+0200' is not recognized
[0m21:42:28.883368 [info ] [MainThread]: 
[0m21:42:28.883697 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:42:28.884271 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 9.77228, "process_in_blocks": "0", "process_kernel_time": 0.834007, "process_mem_max_rss": "155934720", "process_out_blocks": "0", "process_user_time": 5.548407}
[0m21:42:28.884764 [debug] [MainThread]: Command `dbt seed` failed at 21:42:28.884652 after 9.77 seconds
[0m21:42:28.885157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b03fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108012750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991cad0>]}
[0m21:42:28.885628 [debug] [MainThread]: Flushing usage events
[0m10:18:59.904188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10381b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104338710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043384d0>]}


============================== 10:18:59.912850 | 45599ebf-d7a1-4ad1-bdff-87cbc6a1a4c1 ==============================
[0m10:18:59.912850 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:18:59.914411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --select steps', 'send_anonymous_usage_stats': 'True'}
[0m10:19:00.516719 [error] [MainThread]: Encountered an error:

[0m10:19:00.527162 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 215, in wrapper
    profile = load_profile(flags.PROJECT_DIR, flags.VARS, flags.PROFILE, flags.TARGET, threads)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/config/runtime.py", line 71, in load_profile
    profile = Profile.render(
              ^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/config/profile.py", line 403, in render
    return cls.from_raw_profiles(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/config/profile.py", line 369, in from_raw_profiles
    return cls.from_raw_profile_info(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/config/profile.py", line 329, in from_raw_profile_info
    return cls.from_credentials(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/config/profile.py", line 251, in from_credentials
    profile.validate()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/config/profile.py", line 124, in validate
    dct = self.credentials.to_dict(omit_none=True)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in __mashumaro_to_dict__
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/mashumaro/core/meta/code/builder.py", line 1138, in add_pack_method
    self._add_pack_method_lines(method_name)
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/mashumaro/core/meta/code/builder.py", line 881, in _add_pack_method_lines
    packer, alias, could_be_none = self._get_field_packer(
                                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/mashumaro/core/meta/code/builder.py", line 1171, in _get_field_packer
    or is_optional(ftype, self.get_field_resolved_type_params(fname))
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/mashumaro/core/meta/helpers.py", line 359, in is_optional
    if resolved_type_params.get(arg, arg) is NoneType:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m10:19:00.545667 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 0.74944705, "process_in_blocks": "0", "process_kernel_time": 0.475618, "process_mem_max_rss": "109215744", "process_out_blocks": "0", "process_user_time": 1.648035}
[0m10:19:00.546606 [debug] [MainThread]: Command `dbt seed` failed at 10:19:00.546423 after 0.75 seconds
[0m10:19:00.547099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034c4230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a62780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a62930>]}
[0m10:19:00.547584 [debug] [MainThread]: Flushing usage events
[0m10:19:07.505676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111817530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123385f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123383e0>]}


============================== 10:19:07.512744 | 0cb36f1a-4071-46b8-8b7e-7d5f4e9a4797 ==============================
[0m10:19:07.512744 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:19:07.513560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed --select stg_steps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:19:08.101789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cb36f1a-4071-46b8-8b7e-7d5f4e9a4797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11285d820>]}
[0m10:19:08.155923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cb36f1a-4071-46b8-8b7e-7d5f4e9a4797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11230d370>]}
[0m10:19:08.159271 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:19:08.319719 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:19:08.550829 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m10:19:08.551459 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://seeds/stg_steps.csv
[0m10:19:08.551828 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://seeds/stg_exercises.csv
[0m10:19:08.552152 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://seeds/stg_patients.csv
[0m10:19:08.552711 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://seeds/exercises.csv
[0m10:19:08.553044 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://seeds/steps.csv
[0m10:19:08.553358 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://seeds/patients.csv
[0m10:19:08.936698 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.caspar_health_technical_challenge.patients_enhanced' (models/transform/patients_enhanced.sql) depends on a node named 'patients' which was not found
[0m10:19:08.938189 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.5209146, "process_in_blocks": "0", "process_kernel_time": 0.478164, "process_mem_max_rss": "122630144", "process_out_blocks": "0", "process_user_time": 2.319285}
[0m10:19:08.938870 [debug] [MainThread]: Command `dbt seed` failed at 10:19:08.938750 after 1.52 seconds
[0m10:19:08.939311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123383b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f26990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c5c680>]}
[0m10:19:08.939723 [debug] [MainThread]: Flushing usage events
[0m10:19:44.997701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f0440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105144890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105144650>]}


============================== 10:19:45.004666 | fb387245-e87a-45a1-a6a9-6c18a88350c1 ==============================
[0m10:19:45.004666 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:19:45.005297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --select stg_steps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:19:45.774730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb387245-e87a-45a1-a6a9-6c18a88350c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a90980>]}
[0m10:19:45.889328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb387245-e87a-45a1-a6a9-6c18a88350c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c95b20>]}
[0m10:19:45.893839 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:19:46.072733 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:19:46.293761 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 3 files added, 0 files changed.
[0m10:19:46.294495 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://seeds/stg_patients.csv
[0m10:19:46.294912 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://seeds/stg_exercises.csv
[0m10:19:46.295257 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://seeds/stg_steps.csv
[0m10:19:46.295558 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://seeds/steps.csv
[0m10:19:46.295859 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://seeds/exercises.csv
[0m10:19:46.296138 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://models/transform/patients_enhanced.sql
[0m10:19:46.296423 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://seeds/patients.csv
[0m10:19:46.526835 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m10:19:46.532593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb387245-e87a-45a1-a6a9-6c18a88350c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d83770>]}
[0m10:19:46.635091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb387245-e87a-45a1-a6a9-6c18a88350c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f25820>]}
[0m10:19:46.635606 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m10:19:46.635958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb387245-e87a-45a1-a6a9-6c18a88350c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061bc2c0>]}
[0m10:19:46.637535 [info ] [MainThread]: 
[0m10:19:46.638174 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:19:46.639185 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m10:19:46.654008 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m10:19:46.654459 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m10:19:46.654792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:47.169545 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.515 seconds
[0m10:19:47.172220 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m10:19:47.271477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m10:19:47.284795 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m10:19:47.285373 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m10:19:47.285694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:47.545041 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.259 seconds
[0m10:19:47.547184 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m10:19:47.842278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb387245-e87a-45a1-a6a9-6c18a88350c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d83830>]}
[0m10:19:47.843132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:19:47.843622 [info ] [MainThread]: 
[0m10:19:47.847978 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_steps
[0m10:19:47.849198 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_steps ........................................ [RUN]
[0m10:19:47.850130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_steps)
[0m10:19:47.850609 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_steps
[0m10:19:47.850990 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_steps
[0m10:19:47.862157 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:19:47.862987 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
show parameters like 'query_tag' in session
[0m10:19:47.863632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:48.201177 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.338 seconds
[0m10:19:48.202615 [debug] [Thread-1 (]: Setting query_tag to 'stg_steps'. Will reset to '' after materialization.
[0m10:19:48.203343 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:19:48.203737 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
alter session set query_tag = 'stg_steps'
[0m10:19:48.299425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.095 seconds
[0m10:19:49.197179 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:19:49.197850 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
create table CASPAR_HEALTH.public.stg_steps (ID integer,EXTERNAL_ID integer,STEPS integer,SUBMISSION_TIME timestamp without time zone,UPDATED_AT timestamp without time zone)
[0m10:19:49.630357 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a04f-0203-b580-0003-18c200017036
[0m10:19:49.630882 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Table 'STG_STEPS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m10:19:49.631448 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: Close
[0m10:19:49.708968 [debug] [Thread-1 (]: Database Error in seed stg_steps (seeds/stg_steps.csv)
  003041 (42710): SQL compilation error:
  Table 'STG_STEPS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m10:19:49.710633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb387245-e87a-45a1-a6a9-6c18a88350c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e62a0>]}
[0m10:19:49.711321 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_steps ................................ [[31mERROR[0m in 1.86s]
[0m10:19:49.712141 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_steps
[0m10:19:49.714420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:49.714848 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_steps' was properly closed.
[0m10:19:49.715324 [info ] [MainThread]: 
[0m10:19:49.715755 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m10:19:49.717098 [debug] [MainThread]: Command end result
[0m10:19:49.751519 [info ] [MainThread]: 
[0m10:19:49.752671 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:19:49.753261 [info ] [MainThread]: 
[0m10:19:49.753722 [error] [MainThread]:   Database Error in seed stg_steps (seeds/stg_steps.csv)
  003041 (42710): SQL compilation error:
  Table 'STG_STEPS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m10:19:49.754085 [info ] [MainThread]: 
[0m10:19:49.754477 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:19:49.755522 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 4.841265, "process_in_blocks": "0", "process_kernel_time": 0.654109, "process_mem_max_rss": "158248960", "process_out_blocks": "0", "process_user_time": 3.520373}
[0m10:19:49.756214 [debug] [MainThread]: Command `dbt seed` failed at 10:19:49.756088 after 4.84 seconds
[0m10:19:49.756666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104622b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e37860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3fec0>]}
[0m10:19:49.757046 [debug] [MainThread]: Flushing usage events
[0m10:20:45.768618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107225520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af6c7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af6c560>]}


============================== 10:20:45.776485 | 01ffb960-3b8f-4a9a-82e0-783d2141bc99 ==============================
[0m10:20:45.776485 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:20:45.777445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed --select stg_steps', 'send_anonymous_usage_stats': 'True'}
[0m10:20:46.450181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01ffb960-3b8f-4a9a-82e0-783d2141bc99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba29be0>]}
[0m10:20:46.521768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01ffb960-3b8f-4a9a-82e0-783d2141bc99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e19f40>]}
[0m10:20:46.523872 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:20:46.704362 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:20:46.909084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:20:46.909571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:20:46.914915 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m10:20:46.939942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01ffb960-3b8f-4a9a-82e0-783d2141bc99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbb6cf0>]}
[0m10:20:47.036581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01ffb960-3b8f-4a9a-82e0-783d2141bc99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd67fe0>]}
[0m10:20:47.037530 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m10:20:47.038213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01ffb960-3b8f-4a9a-82e0-783d2141bc99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2fda0>]}
[0m10:20:47.039884 [info ] [MainThread]: 
[0m10:20:47.040560 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:20:47.041622 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m10:20:47.060753 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m10:20:47.061386 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m10:20:47.062267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:47.655607 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.593 seconds
[0m10:20:47.657609 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m10:20:47.816763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m10:20:47.827851 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m10:20:47.828560 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m10:20:47.829052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:48.145765 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.317 seconds
[0m10:20:48.148380 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m10:20:48.238150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01ffb960-3b8f-4a9a-82e0-783d2141bc99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be0d4f0>]}
[0m10:20:48.239063 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:20:48.239661 [info ] [MainThread]: 
[0m10:20:48.245104 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_steps
[0m10:20:48.246132 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_steps ........................................ [RUN]
[0m10:20:48.246979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_steps)
[0m10:20:48.248136 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_steps
[0m10:20:48.248965 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_steps
[0m10:20:48.260164 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:20:48.260741 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
show parameters like 'query_tag' in session
[0m10:20:48.261700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:48.512657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.251 seconds
[0m10:20:48.514741 [debug] [Thread-1 (]: Setting query_tag to 'stg_steps'. Will reset to '' after materialization.
[0m10:20:48.516171 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:20:48.517083 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
alter session set query_tag = 'stg_steps'
[0m10:20:48.664100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m10:20:49.776964 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:20:49.777541 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
BEGIN
[0m10:20:50.134633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.356 seconds
[0m10:20:50.136010 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:20:50.137076 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_STEPS"
  ;
[0m10:20:50.290545 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m10:20:50.292566 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:20:50.293809 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
COMMIT
[0m10:20:50.428567 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.134 seconds
[0m10:20:50.606299 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:20:50.607079 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
BEGIN
[0m10:20:50.682183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m10:20:52.160590 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:20:52.161118 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
insert into CASPAR_HEALTH.public.stg_steps (ID, EXTERNAL_ID, STEPS, SUBMISSION_TIME, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m10:20:53.334918 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a050-0203-b576-0003-18c200010c86
[0m10:20:53.335695 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 48
invalid identifier 'EXTERNAL_ID'
[0m10:20:53.336561 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: Close
[0m10:20:53.434274 [debug] [Thread-1 (]: Database Error in seed stg_steps (seeds/stg_steps.csv)
  000904 (42000): SQL compilation error: error line 1 at position 48
  invalid identifier 'EXTERNAL_ID'
[0m10:20:53.437110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01ffb960-3b8f-4a9a-82e0-783d2141bc99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfe5430>]}
[0m10:20:53.438097 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_steps ................................ [[31mERROR[0m in 5.19s]
[0m10:20:53.439791 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_steps
[0m10:20:53.442990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:53.443564 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_steps' was properly closed.
[0m10:20:53.444087 [info ] [MainThread]: 
[0m10:20:53.444647 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.40 seconds (6.40s).
[0m10:20:53.445688 [debug] [MainThread]: Command end result
[0m10:20:53.486211 [info ] [MainThread]: 
[0m10:20:53.486879 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:20:53.487266 [info ] [MainThread]: 
[0m10:20:53.487875 [error] [MainThread]:   Database Error in seed stg_steps (seeds/stg_steps.csv)
  000904 (42000): SQL compilation error: error line 1 at position 48
  invalid identifier 'EXTERNAL_ID'
[0m10:20:53.488588 [info ] [MainThread]: 
[0m10:20:53.489454 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:20:53.490376 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 7.8173504, "process_in_blocks": "0", "process_kernel_time": 0.837936, "process_mem_max_rss": "155774976", "process_out_blocks": "0", "process_user_time": 5.395358}
[0m10:20:53.491337 [debug] [MainThread]: Command `dbt seed` failed at 10:20:53.491176 after 7.82 seconds
[0m10:20:53.491860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e482f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acc02c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb66e10>]}
[0m10:20:53.492454 [debug] [MainThread]: Flushing usage events
[0m10:21:50.643874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c63bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce0f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d158620>]}


============================== 10:21:50.648976 | 853c9d64-1028-4be1-a9f2-88bdd2e933e7 ==============================
[0m10:21:50.648976 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:21:50.649670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --select stg_steps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:21:51.119335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '853c9d64-1028-4be1-a9f2-88bdd2e933e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d89a750>]}
[0m10:21:51.174994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '853c9d64-1028-4be1-a9f2-88bdd2e933e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddcd7f0>]}
[0m10:21:51.176189 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:21:51.312507 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:21:51.416226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:21:51.416681 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:21:51.421946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m10:21:51.439691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '853c9d64-1028-4be1-a9f2-88bdd2e933e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcd8110>]}
[0m10:21:51.519470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '853c9d64-1028-4be1-a9f2-88bdd2e933e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df37bc0>]}
[0m10:21:51.519984 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m10:21:51.520525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '853c9d64-1028-4be1-a9f2-88bdd2e933e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd648f0>]}
[0m10:21:51.522183 [info ] [MainThread]: 
[0m10:21:51.522823 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:21:51.523788 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m10:21:51.539048 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m10:21:51.539554 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m10:21:51.539866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:52.018945 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.479 seconds
[0m10:21:52.021910 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m10:21:52.097582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m10:21:52.108462 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m10:21:52.109018 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m10:21:52.109357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:21:52.369872 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.260 seconds
[0m10:21:52.374650 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m10:21:52.450682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '853c9d64-1028-4be1-a9f2-88bdd2e933e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e146a20>]}
[0m10:21:52.452370 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:21:52.453694 [info ] [MainThread]: 
[0m10:21:52.458204 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_steps
[0m10:21:52.459399 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_steps ........................................ [RUN]
[0m10:21:52.460335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_steps)
[0m10:21:52.461034 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_steps
[0m10:21:52.461664 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_steps
[0m10:21:52.475608 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:21:52.476225 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
show parameters like 'query_tag' in session
[0m10:21:52.476765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:52.830542 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.354 seconds
[0m10:21:52.832243 [debug] [Thread-1 (]: Setting query_tag to 'stg_steps'. Will reset to '' after materialization.
[0m10:21:52.832957 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:21:52.833329 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
alter session set query_tag = 'stg_steps'
[0m10:21:52.890316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.056 seconds
[0m10:21:53.732381 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:21:53.733275 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
create table CASPAR_HEALTH.public.stg_steps (ID integer,EXTERNAL_ID integer,STEPS integer,SUBMISSION_TIME timestamp without time zone,UPDATED_AT timestamp without time zone)
[0m10:21:53.947171 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a051-0203-b56e-0003-18c200013a7e
[0m10:21:53.947994 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Table 'STG_STEPS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m10:21:53.948726 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: Close
[0m10:21:54.019530 [debug] [Thread-1 (]: Database Error in seed stg_steps (seeds/stg_steps.csv)
  003041 (42710): SQL compilation error:
  Table 'STG_STEPS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m10:21:54.021735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '853c9d64-1028-4be1-a9f2-88bdd2e933e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c68f740>]}
[0m10:21:54.022607 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_steps ................................ [[31mERROR[0m in 1.56s]
[0m10:21:54.023456 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_steps
[0m10:21:54.026258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:21:54.027086 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_steps' was properly closed.
[0m10:21:54.027497 [info ] [MainThread]: 
[0m10:21:54.027873 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m10:21:54.028548 [debug] [MainThread]: Command end result
[0m10:21:54.060501 [info ] [MainThread]: 
[0m10:21:54.061435 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:21:54.062041 [info ] [MainThread]: 
[0m10:21:54.062609 [error] [MainThread]:   Database Error in seed stg_steps (seeds/stg_steps.csv)
  003041 (42710): SQL compilation error:
  Table 'STG_STEPS' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m10:21:54.063016 [info ] [MainThread]: 
[0m10:21:54.063458 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:21:54.064443 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.4893658, "process_in_blocks": "0", "process_kernel_time": 0.450923, "process_mem_max_rss": "155242496", "process_out_blocks": "0", "process_user_time": 2.979737}
[0m10:21:54.065328 [debug] [MainThread]: Command `dbt seed` failed at 10:21:54.065164 after 3.49 seconds
[0m10:21:54.065861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c63bcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d158350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d158650>]}
[0m10:21:54.066258 [debug] [MainThread]: Flushing usage events
[0m10:22:07.938134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aaf1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5788f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5786b0>]}


============================== 10:22:07.944483 | 450bfd98-4450-43bd-94c5-f55c53ab81a5 ==============================
[0m10:22:07.944483 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:22:07.945142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed --select stg_steps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:22:08.623123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '450bfd98-4450-43bd-94c5-f55c53ab81a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a57a150>]}
[0m10:22:08.678828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '450bfd98-4450-43bd-94c5-f55c53ab81a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a07e240>]}
[0m10:22:08.681005 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:22:08.841674 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:22:09.039505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:22:09.039974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:22:09.045598 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m10:22:09.064455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '450bfd98-4450-43bd-94c5-f55c53ab81a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aacb90>]}
[0m10:22:09.161316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '450bfd98-4450-43bd-94c5-f55c53ab81a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b036f90>]}
[0m10:22:09.161897 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m10:22:09.162520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '450bfd98-4450-43bd-94c5-f55c53ab81a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b001970>]}
[0m10:22:09.164320 [info ] [MainThread]: 
[0m10:22:09.165114 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:22:09.166073 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m10:22:09.182240 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m10:22:09.182770 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m10:22:09.201095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:09.675313 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.474 seconds
[0m10:22:09.680165 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m10:22:09.779185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m10:22:09.793188 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m10:22:09.793801 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m10:22:09.794252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:10.135120 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.341 seconds
[0m10:22:10.138229 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m10:22:10.249811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '450bfd98-4450-43bd-94c5-f55c53ab81a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3be720>]}
[0m10:22:10.265185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:22:10.265992 [info ] [MainThread]: 
[0m10:22:10.269903 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_steps
[0m10:22:10.270819 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_steps ........................................ [RUN]
[0m10:22:10.271608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_steps)
[0m10:22:10.272224 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_steps
[0m10:22:10.272811 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_steps
[0m10:22:10.284371 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:22:10.284996 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
show parameters like 'query_tag' in session
[0m10:22:10.285807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:10.665226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.379 seconds
[0m10:22:10.668948 [debug] [Thread-1 (]: Setting query_tag to 'stg_steps'. Will reset to '' after materialization.
[0m10:22:10.670687 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:22:10.671522 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
alter session set query_tag = 'stg_steps'
[0m10:22:10.759785 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m10:22:11.505613 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:22:11.506284 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
BEGIN
[0m10:22:11.612026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m10:22:11.612574 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:22:11.613369 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_STEPS"
  ;
[0m10:22:11.748474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m10:22:11.749485 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:22:11.750139 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
COMMIT
[0m10:22:11.929618 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m10:22:12.087924 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:22:12.088440 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
BEGIN
[0m10:22:12.209203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m10:22:13.648775 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:22:13.649405 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
insert into CASPAR_HEALTH.public.stg_steps (ID, EXTERNAL_ID, STEPS, SUBMISSION_TIME, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m10:22:17.181255 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 3.531 seconds
[0m10:22:17.182470 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:22:17.182956 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
COMMIT
[0m10:22:17.480464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.297 seconds
[0m10:22:17.522872 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:22:17.523358 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
BEGIN
[0m10:22:17.584413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.061 seconds
[0m10:22:17.657336 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:22:17.657876 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
insert into CASPAR_HEALTH.public.stg_steps (ID, EXTERNAL_ID, STEPS, SUBMISSION_TIME, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m10:22:18.957669 [debug] [Thread-1 (]: SQL status: SUCCESS 1909 in 1.299 seconds
[0m10:22:18.958539 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m10:22:18.958927 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
COMMIT
[0m10:22:19.219978 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.261 seconds
[0m10:22:19.226569 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.caspar_health_technical_challenge.stg_steps"
[0m10:22:19.251864 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: Close
[0m10:22:19.325620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '450bfd98-4450-43bd-94c5-f55c53ab81a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078dbb90>]}
[0m10:22:19.326293 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.stg_steps .................................... [[32mINSERT 11909[0m in 9.05s]
[0m10:22:19.326996 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_steps
[0m10:22:19.328770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:19.329161 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_steps' was properly closed.
[0m10:22:19.329464 [info ] [MainThread]: 
[0m10:22:19.329836 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.16 seconds (10.16s).
[0m10:22:19.330536 [debug] [MainThread]: Command end result
[0m10:22:19.362409 [info ] [MainThread]: 
[0m10:22:19.363247 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:22:19.363699 [info ] [MainThread]: 
[0m10:22:19.364116 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:22:19.364916 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 11.506017, "process_in_blocks": "0", "process_kernel_time": 0.687241, "process_mem_max_rss": "157249536", "process_out_blocks": "0", "process_user_time": 5.048811}
[0m10:22:19.365711 [debug] [MainThread]: Command `dbt seed` succeeded at 10:22:19.365547 after 11.51 seconds
[0m10:22:19.366225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5783b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a5ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b418e30>]}
[0m10:22:19.366919 [debug] [MainThread]: Flushing usage events
[0m10:22:25.793865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109315a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e38740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e38500>]}


============================== 10:22:25.799004 | 3bb6a14b-2445-46f0-a1f7-3f6f90c31c09 ==============================
[0m10:22:25.799004 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:22:25.799623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed --select stg_patients', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:22:26.269150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bb6a14b-2445-46f0-a1f7-3f6f90c31c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1718b0>]}
[0m10:22:26.326135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bb6a14b-2445-46f0-a1f7-3f6f90c31c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dc7bc0>]}
[0m10:22:26.327720 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:22:26.460430 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:22:26.570280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:22:26.570703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:22:26.575913 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m10:22:26.600173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bb6a14b-2445-46f0-a1f7-3f6f90c31c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa87bc0>]}
[0m10:22:26.676251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bb6a14b-2445-46f0-a1f7-3f6f90c31c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adb7e90>]}
[0m10:22:26.676756 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m10:22:26.677286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bb6a14b-2445-46f0-a1f7-3f6f90c31c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9b6d80>]}
[0m10:22:26.678847 [info ] [MainThread]: 
[0m10:22:26.679447 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:22:26.680323 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m10:22:26.696291 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m10:22:26.696734 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m10:22:26.697207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:22:27.997147 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.299 seconds
[0m10:22:28.001096 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m10:22:28.084199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m10:22:28.097712 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m10:22:28.098266 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m10:22:28.098689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:22:28.428588 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.330 seconds
[0m10:22:28.434088 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m10:22:28.592513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bb6a14b-2445-46f0-a1f7-3f6f90c31c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac0cf20>]}
[0m10:22:28.593684 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:22:28.594336 [info ] [MainThread]: 
[0m10:22:28.597618 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m10:22:28.598761 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m10:22:28.599641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m10:22:28.600287 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m10:22:28.600818 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m10:22:28.613398 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:22:28.614023 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m10:22:28.614779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:22:28.963664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.349 seconds
[0m10:22:28.965890 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m10:22:28.966922 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:22:28.967507 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m10:22:29.070149 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m10:22:29.108103 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:22:29.108803 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:22:29.271702 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m10:22:29.273002 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:22:29.274004 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS"
  ;
[0m10:22:29.407050 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m10:22:29.408467 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:22:29.409565 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
COMMIT
[0m10:22:29.589772 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m10:22:29.609385 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:22:29.609886 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:22:29.734514 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m10:22:29.738515 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:22:29.739143 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
insert into CASPAR_HEALTH.public.stg_patients (a, PATIENT_ID, first_name, last_name, country) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m10:22:29.862238 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a052-0203-b5f1-0003-18c20001606a
[0m10:22:29.863123 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 47
invalid identifier 'A'
[0m10:22:29.864103 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m10:22:30.055226 [debug] [Thread-1 (]: Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier 'A'
[0m10:22:30.057635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bb6a14b-2445-46f0-a1f7-3f6f90c31c09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aed3890>]}
[0m10:22:30.058475 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_patients ............................. [[31mERROR[0m in 1.46s]
[0m10:22:30.059452 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m10:22:30.062283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:22:30.062951 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m10:22:30.063530 [info ] [MainThread]: 
[0m10:22:30.064052 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m10:22:30.065006 [debug] [MainThread]: Command end result
[0m10:22:30.099085 [info ] [MainThread]: 
[0m10:22:30.099655 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:22:30.099979 [info ] [MainThread]: 
[0m10:22:30.100356 [error] [MainThread]:   Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier 'A'
[0m10:22:30.100688 [info ] [MainThread]: 
[0m10:22:30.101270 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:22:30.102183 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 4.3887177, "process_in_blocks": "0", "process_kernel_time": 0.440927, "process_mem_max_rss": "129863680", "process_out_blocks": "0", "process_user_time": 2.315221}
[0m10:22:30.102899 [debug] [MainThread]: Command `dbt seed` failed at 10:22:30.102733 after 4.39 seconds
[0m10:22:30.103300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a25dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e384d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e38770>]}
[0m10:22:30.103730 [debug] [MainThread]: Flushing usage events
[0m10:23:23.082640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a278fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc58650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc583e0>]}


============================== 10:23:23.091230 | 9d362b7f-8497-430e-929b-67f1aa633978 ==============================
[0m10:23:23.091230 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:23:23.092109 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed --select stg_patients', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:23:23.752644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d362b7f-8497-430e-929b-67f1aa633978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d80df70>]}
[0m10:23:23.807546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d362b7f-8497-430e-929b-67f1aa633978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d31f6b0>]}
[0m10:23:23.809750 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:23:23.959631 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:23:24.130221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:23:24.130672 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:23:24.135787 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m10:23:24.152441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d362b7f-8497-430e-929b-67f1aa633978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d865700>]}
[0m10:23:24.242512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d362b7f-8497-430e-929b-67f1aa633978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da96c60>]}
[0m10:23:24.243041 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m10:23:24.243575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d362b7f-8497-430e-929b-67f1aa633978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c13ade0>]}
[0m10:23:24.245138 [info ] [MainThread]: 
[0m10:23:24.245734 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:23:24.246625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m10:23:24.261881 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m10:23:24.262331 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m10:23:24.262781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:24.927880 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.665 seconds
[0m10:23:24.929913 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m10:23:25.092619 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m10:23:25.113840 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m10:23:25.114342 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m10:23:25.114784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:25.574902 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.460 seconds
[0m10:23:25.577482 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m10:23:25.746844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d362b7f-8497-430e-929b-67f1aa633978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc344d0>]}
[0m10:23:25.747684 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:23:25.748101 [info ] [MainThread]: 
[0m10:23:25.752334 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m10:23:25.753014 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m10:23:25.753573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m10:23:25.753990 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m10:23:25.754403 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m10:23:25.763646 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:23:25.764209 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m10:23:25.764690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:26.136583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.372 seconds
[0m10:23:26.139551 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m10:23:26.140304 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:23:26.140753 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m10:23:26.301903 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.161 seconds
[0m10:23:26.335350 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:23:26.335946 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:23:26.458163 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m10:23:26.458827 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:23:26.459301 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS"
  ;
[0m10:23:26.909344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.450 seconds
[0m10:23:26.910004 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:23:26.910427 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
COMMIT
[0m10:23:27.217592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.307 seconds
[0m10:23:27.236929 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:23:27.237469 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:23:27.423449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.185 seconds
[0m10:23:27.426217 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:23:27.426735 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
insert into CASPAR_HEALTH.public.stg_patients (a, PATIENT_ID, first_name, last_name, country) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m10:23:27.608937 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a053-0203-b42e-0003-18c200012a7a
[0m10:23:27.609464 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 47
invalid identifier 'A'
[0m10:23:27.610041 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m10:23:27.696733 [debug] [Thread-1 (]: Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier 'A'
[0m10:23:27.698960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d362b7f-8497-430e-929b-67f1aa633978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10decfa70>]}
[0m10:23:27.699707 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_patients ............................. [[31mERROR[0m in 1.94s]
[0m10:23:27.700585 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m10:23:27.703040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:23:27.703535 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m10:23:27.704000 [info ] [MainThread]: 
[0m10:23:27.704513 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m10:23:27.705406 [debug] [MainThread]: Command end result
[0m10:23:27.739110 [info ] [MainThread]: 
[0m10:23:27.740067 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:23:27.740538 [info ] [MainThread]: 
[0m10:23:27.741068 [error] [MainThread]:   Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier 'A'
[0m10:23:27.741419 [info ] [MainThread]: 
[0m10:23:27.742018 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:23:27.742744 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 4.7446637, "process_in_blocks": "0", "process_kernel_time": 0.51386, "process_mem_max_rss": "129937408", "process_out_blocks": "0", "process_user_time": 2.259223}
[0m10:23:27.743262 [debug] [MainThread]: Command `dbt seed` failed at 10:23:27.743163 after 4.75 seconds
[0m10:23:27.743767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc584a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc58650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc583b0>]}
[0m10:23:27.744371 [debug] [MainThread]: Flushing usage events
[0m10:26:06.935408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2c380>]}


============================== 10:26:06.943897 | 7ff7ce1f-3469-4ed5-957e-52a6e2c79165 ==============================
[0m10:26:06.943897 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:26:06.944636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --select stg_patients', 'send_anonymous_usage_stats': 'True'}
[0m10:26:07.624435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ff7ce1f-3469-4ed5-957e-52a6e2c79165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a9970>]}
[0m10:26:07.681654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ff7ce1f-3469-4ed5-957e-52a6e2c79165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074759a0>]}
[0m10:26:07.684048 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:26:07.832418 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:26:07.892627 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:26:07.893456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ff7ce1f-3469-4ed5-957e-52a6e2c79165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c78f0>]}
[0m10:26:09.130057 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
- seeds.stg_patients
[0m10:26:09.135665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ff7ce1f-3469-4ed5-957e-52a6e2c79165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa6300>]}
[0m10:26:09.229283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ff7ce1f-3469-4ed5-957e-52a6e2c79165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106adb080>]}
[0m10:26:09.229789 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m10:26:09.230157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ff7ce1f-3469-4ed5-957e-52a6e2c79165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076644d0>]}
[0m10:26:09.231674 [info ] [MainThread]: 
[0m10:26:09.232286 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:26:09.233507 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m10:26:09.248050 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m10:26:09.248518 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m10:26:09.249034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:09.901535 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.652 seconds
[0m10:26:09.904113 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m10:26:09.987881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m10:26:09.999685 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m10:26:10.000347 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m10:26:10.000775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:10.559949 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.559 seconds
[0m10:26:10.562812 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m10:26:10.649014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ff7ce1f-3469-4ed5-957e-52a6e2c79165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107937770>]}
[0m10:26:10.649969 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:26:10.650563 [info ] [MainThread]: 
[0m10:26:10.655670 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m10:26:10.657176 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m10:26:10.658199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m10:26:10.658919 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m10:26:10.659432 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m10:26:10.670427 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:10.671028 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m10:26:10.671539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:10.978330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.307 seconds
[0m10:26:10.981911 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m10:26:10.983287 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:10.984131 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m10:26:11.082609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m10:26:11.120153 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:11.120647 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:26:11.288304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.167 seconds
[0m10:26:11.289250 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:11.289955 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS"
  ;
[0m10:26:11.478270 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.187 seconds
[0m10:26:11.479850 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:11.481266 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
COMMIT
[0m10:26:11.883080 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m10:26:11.899778 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:11.900311 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:26:12.007820 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m10:26:12.010619 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:12.011079 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
insert into CASPAR_HEALTH.public.stg_patients (a, PATIENT_ID, first_name, last_name, country) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m10:26:12.341607 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a056-0203-b576-0003-18c200010caa
[0m10:26:12.342167 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 47
invalid identifier 'A'
[0m10:26:12.342741 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m10:26:12.425831 [debug] [Thread-1 (]: Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier 'A'
[0m10:26:12.427318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ff7ce1f-3469-4ed5-957e-52a6e2c79165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076644a0>]}
[0m10:26:12.427899 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_patients ............................. [[31mERROR[0m in 1.77s]
[0m10:26:12.428521 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m10:26:12.430891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:12.431447 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m10:26:12.431848 [info ] [MainThread]: 
[0m10:26:12.432244 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m10:26:12.432940 [debug] [MainThread]: Command end result
[0m10:26:12.467565 [info ] [MainThread]: 
[0m10:26:12.468313 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:26:12.469094 [info ] [MainThread]: 
[0m10:26:12.470034 [error] [MainThread]:   Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier 'A'
[0m10:26:12.470724 [info ] [MainThread]: 
[0m10:26:12.471460 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:26:12.472312 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 5.6220174, "process_in_blocks": "0", "process_kernel_time": 0.576181, "process_mem_max_rss": "128425984", "process_out_blocks": "0", "process_user_time": 3.409009}
[0m10:26:12.473249 [debug] [MainThread]: Command `dbt seed` failed at 10:26:12.472939 after 5.62 seconds
[0m10:26:12.473947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10687e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730fbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655a330>]}
[0m10:26:12.474679 [debug] [MainThread]: Flushing usage events
[0m10:26:19.506716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d3b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112830650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112830410>]}


============================== 10:26:19.511814 | 7fa0942a-1cd5-45cd-a010-78926f7dc9cd ==============================
[0m10:26:19.511814 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:26:19.512521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed --select stg_patients', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:26:19.973986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fa0942a-1cd5-45cd-a010-78926f7dc9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133c3f50>]}
[0m10:26:20.033266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fa0942a-1cd5-45cd-a010-78926f7dc9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112831b20>]}
[0m10:26:20.049481 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:26:20.178471 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:26:20.239874 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:26:20.240416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7fa0942a-1cd5-45cd-a010-78926f7dc9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d6e2a0>]}
[0m10:26:21.424342 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
- seeds.stg_patients
[0m10:26:21.430985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fa0942a-1cd5-45cd-a010-78926f7dc9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11378c920>]}
[0m10:26:21.508407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fa0942a-1cd5-45cd-a010-78926f7dc9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133396a0>]}
[0m10:26:21.508936 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m10:26:21.509297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fa0942a-1cd5-45cd-a010-78926f7dc9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137c6e40>]}
[0m10:26:21.510905 [info ] [MainThread]: 
[0m10:26:21.511840 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:26:21.512871 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m10:26:21.525740 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m10:26:21.526197 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m10:26:21.526523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:22.091964 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.565 seconds
[0m10:26:22.094235 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m10:26:22.221786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m10:26:22.236235 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m10:26:22.236951 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m10:26:22.237380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:22.808084 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.571 seconds
[0m10:26:22.811107 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m10:26:22.887589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fa0942a-1cd5-45cd-a010-78926f7dc9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113478590>]}
[0m10:26:22.888591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:26:22.889203 [info ] [MainThread]: 
[0m10:26:22.891929 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m10:26:22.892729 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m10:26:22.893411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m10:26:22.893925 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m10:26:22.894433 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m10:26:22.905188 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:22.905912 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m10:26:22.906408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:23.266047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.359 seconds
[0m10:26:23.268797 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m10:26:23.270025 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:23.270645 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m10:26:23.387929 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m10:26:23.424731 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:23.425332 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:26:23.553062 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m10:26:23.553876 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:23.554484 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS"
  ;
[0m10:26:23.961541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m10:26:23.963386 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:23.965007 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
COMMIT
[0m10:26:24.370788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.405 seconds
[0m10:26:24.392674 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:24.393248 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:26:24.604056 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m10:26:24.607335 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:24.607963 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
insert into CASPAR_HEALTH.public.stg_patients (a, PATIENT_ID, first_name, last_name, country) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m10:26:24.707651 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a056-0203-b55c-0003-18c20001506a
[0m10:26:24.708559 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 47
invalid identifier 'A'
[0m10:26:24.709406 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m10:26:24.796359 [debug] [Thread-1 (]: Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier 'A'
[0m10:26:24.798361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fa0942a-1cd5-45cd-a010-78926f7dc9cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113935be0>]}
[0m10:26:24.799146 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_patients ............................. [[31mERROR[0m in 1.90s]
[0m10:26:24.800018 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m10:26:24.802439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:24.802854 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m10:26:24.803259 [info ] [MainThread]: 
[0m10:26:24.803773 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.29 seconds (3.29s).
[0m10:26:24.804901 [debug] [MainThread]: Command end result
[0m10:26:24.836588 [info ] [MainThread]: 
[0m10:26:24.837554 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:26:24.838558 [info ] [MainThread]: 
[0m10:26:24.839441 [error] [MainThread]:   Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier 'A'
[0m10:26:24.839904 [info ] [MainThread]: 
[0m10:26:24.840304 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:26:24.840888 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 5.4031687, "process_in_blocks": "0", "process_kernel_time": 0.44366, "process_mem_max_rss": "131543040", "process_out_blocks": "0", "process_user_time": 3.362456}
[0m10:26:24.841373 [debug] [MainThread]: Command `dbt seed` failed at 10:26:24.841270 after 5.40 seconds
[0m10:26:24.841859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137b9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128304d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112830650>]}
[0m10:26:24.842248 [debug] [MainThread]: Flushing usage events
[0m10:26:50.005744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af214f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e53c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e53c5f0>]}


============================== 10:26:50.015199 | ac2e8da3-681f-4d8a-b17b-9f009f18fd70 ==============================
[0m10:26:50.015199 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:26:50.016263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed --select stg_patients', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:26:50.730481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac2e8da3-681f-4d8a-b17b-9f009f18fd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea8b230>]}
[0m10:26:50.794090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac2e8da3-681f-4d8a-b17b-9f009f18fd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed1f2f0>]}
[0m10:26:50.796381 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:26:50.944784 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:26:51.119325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:26:51.120031 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/stg_patients.csv
[0m10:26:51.332495 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
- seeds.stg_patients
[0m10:26:51.338629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac2e8da3-681f-4d8a-b17b-9f009f18fd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3218e0>]}
[0m10:26:51.426130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac2e8da3-681f-4d8a-b17b-9f009f18fd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f229dc0>]}
[0m10:26:51.426639 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m10:26:51.426990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac2e8da3-681f-4d8a-b17b-9f009f18fd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eff8740>]}
[0m10:26:51.428681 [info ] [MainThread]: 
[0m10:26:51.429296 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:26:51.430335 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m10:26:51.443530 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m10:26:51.443984 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m10:26:51.444295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:26:52.444148 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.000 seconds
[0m10:26:52.449281 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m10:26:53.185027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m10:26:53.197489 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m10:26:53.198064 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m10:26:53.198405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:26:53.535923 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.337 seconds
[0m10:26:53.540112 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m10:26:53.621187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac2e8da3-681f-4d8a-b17b-9f009f18fd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee10830>]}
[0m10:26:53.622024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:26:53.623076 [info ] [MainThread]: 
[0m10:26:53.626798 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m10:26:53.628167 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m10:26:53.629621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m10:26:53.630269 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m10:26:53.630853 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m10:26:53.644157 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:53.645149 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m10:26:53.645864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:26:54.439240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.793 seconds
[0m10:26:54.441506 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m10:26:54.444830 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:54.445621 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m10:26:54.656896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.211 seconds
[0m10:26:54.694277 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:54.694816 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:26:54.768950 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m10:26:54.769784 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:54.770382 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS"
  ;
[0m10:26:54.884614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m10:26:54.885609 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:54.886316 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
COMMIT
[0m10:26:55.080863 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m10:26:55.100046 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:55.100854 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:26:55.209103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m10:26:55.213556 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:55.214491 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
insert into CASPAR_HEALTH.public.stg_patients (row_id, PATIENT_ID, first_name, last_name, country) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,...
[0m10:26:55.909757 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 0.695 seconds
[0m10:26:55.910525 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:55.910979 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
COMMIT
[0m10:26:56.120845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m10:26:56.132405 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.caspar_health_technical_challenge.stg_patients"
[0m10:26:56.159737 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m10:26:56.249946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac2e8da3-681f-4d8a-b17b-9f009f18fd70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b88bcb0>]}
[0m10:26:56.250997 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.stg_patients ................................. [[32mINSERT 100[0m in 2.62s]
[0m10:26:56.252292 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m10:26:56.254391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:26:56.254895 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m10:26:56.255359 [info ] [MainThread]: 
[0m10:26:56.255870 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.83 seconds (4.83s).
[0m10:26:56.256809 [debug] [MainThread]: Command end result
[0m10:26:56.355987 [info ] [MainThread]: 
[0m10:26:56.357188 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:26:56.357862 [info ] [MainThread]: 
[0m10:26:56.358332 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:26:56.359001 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.4427867, "process_in_blocks": "0", "process_kernel_time": 0.626644, "process_mem_max_rss": "131682304", "process_out_blocks": "0", "process_user_time": 2.750634}
[0m10:26:56.359485 [debug] [MainThread]: Command `dbt seed` succeeded at 10:26:56.359388 after 6.44 seconds
[0m10:26:56.359851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f228f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f517fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f515820>]}
[0m10:26:56.360262 [debug] [MainThread]: Flushing usage events
[0m10:49:34.457401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce72030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3387a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d338590>]}


============================== 10:49:34.466142 | e84dd697-5411-4236-96b6-db03e415acc3 ==============================
[0m10:49:34.466142 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:49:34.466867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed --select stg_patients', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:49:35.261694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e84dd697-5411-4236-96b6-db03e415acc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2e6420>]}
[0m10:49:35.316276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e84dd697-5411-4236-96b6-db03e415acc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d30a720>]}
[0m10:49:35.318477 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:49:35.472889 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:49:35.533878 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:49:35.534441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e84dd697-5411-4236-96b6-db03e415acc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1d7b30>]}
[0m10:49:36.810242 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m10:49:36.815582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e84dd697-5411-4236-96b6-db03e415acc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e316300>]}
[0m10:49:36.910182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e84dd697-5411-4236-96b6-db03e415acc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df30da0>]}
[0m10:49:36.910688 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m10:49:36.911045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e84dd697-5411-4236-96b6-db03e415acc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2ca5a0>]}
[0m10:49:36.912484 [info ] [MainThread]: 
[0m10:49:36.913034 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:49:36.914084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m10:49:36.927470 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m10:49:36.927976 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m10:49:36.928285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:37.582994 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.655 seconds
[0m10:49:37.585886 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m10:49:37.701177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m10:49:37.714743 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m10:49:37.715250 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m10:49:37.715730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:49:38.055253 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.339 seconds
[0m10:49:38.058371 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m10:49:38.134216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e84dd697-5411-4236-96b6-db03e415acc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0a0d40>]}
[0m10:49:38.135829 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:49:38.136835 [info ] [MainThread]: 
[0m10:49:38.142100 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m10:49:38.143357 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m10:49:38.144245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m10:49:38.144916 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m10:49:38.145560 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m10:49:38.158728 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:49:38.159419 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m10:49:38.160118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:49:38.458095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m10:49:38.460344 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m10:49:38.462355 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:49:38.463054 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m10:49:38.752368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.289 seconds
[0m10:49:38.788040 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:49:38.788532 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:49:38.876680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m10:49:38.877551 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:49:38.878169 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS"
  ;
[0m10:49:39.103827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m10:49:39.105179 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:49:39.106294 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
COMMIT
[0m10:49:39.360207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.253 seconds
[0m10:49:39.385175 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:49:39.385746 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:49:39.483169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m10:49:39.487028 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:49:39.487570 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
insert into CASPAR_HEALTH.public.stg_patients (a, PATIENT_ID, first_name, last_name, country) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m10:49:39.582090 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a06d-0203-b580-0003-18c200017072
[0m10:49:39.582949 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 47
invalid identifier 'A'
[0m10:49:39.583887 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m10:49:39.676668 [debug] [Thread-1 (]: Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier 'A'
[0m10:49:39.679847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e84dd697-5411-4236-96b6-db03e415acc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5a2060>]}
[0m10:49:39.680956 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_patients ............................. [[31mERROR[0m in 1.53s]
[0m10:49:39.682161 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m10:49:39.686213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:39.686999 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m10:49:39.687951 [info ] [MainThread]: 
[0m10:49:39.689155 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m10:49:39.690967 [debug] [MainThread]: Command end result
[0m10:49:39.745737 [info ] [MainThread]: 
[0m10:49:39.746510 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:49:39.746915 [info ] [MainThread]: 
[0m10:49:39.747463 [error] [MainThread]:   Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier 'A'
[0m10:49:39.748084 [info ] [MainThread]: 
[0m10:49:39.748521 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:49:39.754642 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 5.3953123, "process_in_blocks": "0", "process_kernel_time": 0.64791, "process_mem_max_rss": "131739648", "process_out_blocks": "0", "process_user_time": 3.490435}
[0m10:49:39.756225 [debug] [MainThread]: Command `dbt seed` failed at 10:49:39.755795 after 5.40 seconds
[0m10:49:39.756949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cea0680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2e7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d338890>]}
[0m10:49:39.757636 [debug] [MainThread]: Flushing usage events
[0m10:50:05.152936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e47a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070446b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107044470>]}


============================== 10:50:05.159277 | 6b886abe-93d2-4777-81bb-90c645eb1638 ==============================
[0m10:50:05.159277 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:50:05.159897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed --select stg_patients', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:50:05.774862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b886abe-93d2-4777-81bb-90c645eb1638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107827f20>]}
[0m10:50:05.829071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b886abe-93d2-4777-81bb-90c645eb1638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d98a40>]}
[0m10:50:05.831350 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:50:05.985336 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:50:06.161072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:50:06.161798 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/properties.yml
[0m10:50:06.391580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m10:50:06.397604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b886abe-93d2-4777-81bb-90c645eb1638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d09190>]}
[0m10:50:06.490098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b886abe-93d2-4777-81bb-90c645eb1638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10814b2f0>]}
[0m10:50:06.490651 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m10:50:06.491021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b886abe-93d2-4777-81bb-90c645eb1638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ed850>]}
[0m10:50:06.492689 [info ] [MainThread]: 
[0m10:50:06.493422 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:50:06.494438 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m10:50:06.509818 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m10:50:06.510316 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m10:50:06.510653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:07.885792 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.375 seconds
[0m10:50:07.887552 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m10:50:07.974025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m10:50:07.984904 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m10:50:07.985499 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m10:50:07.985895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:50:08.656031 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.670 seconds
[0m10:50:08.660550 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m10:50:08.737355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b886abe-93d2-4777-81bb-90c645eb1638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10803e990>]}
[0m10:50:08.738630 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:50:08.739552 [info ] [MainThread]: 
[0m10:50:08.744118 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m10:50:08.745187 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m10:50:08.746038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m10:50:08.746650 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m10:50:08.747232 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m10:50:08.762308 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:50:08.762878 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m10:50:08.825000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:50:09.457342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m10:50:09.461501 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m10:50:09.464133 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:50:09.465870 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m10:50:09.823206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.356 seconds
[0m10:50:09.874389 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:50:09.875444 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:50:09.967555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.091 seconds
[0m10:50:09.969204 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:50:09.970256 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS"
  ;
[0m10:50:10.325602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.354 seconds
[0m10:50:10.326483 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:50:10.327133 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
COMMIT
[0m10:50:10.561101 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.233 seconds
[0m10:50:10.592292 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:50:10.592969 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:50:10.665012 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m10:50:10.672058 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:50:10.672932 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
insert into CASPAR_HEALTH.public.stg_patients ("a", "PATIENT_ID", "first_name", "last_name", "country") values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)...
[0m10:50:10.871450 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a06e-0203-b56e-0003-18c200013aae
[0m10:50:10.872101 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 47
invalid identifier '"a"'
[0m10:50:10.873010 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m10:50:10.962995 [debug] [Thread-1 (]: Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier '"a"'
[0m10:50:10.965247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b886abe-93d2-4777-81bb-90c645eb1638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a071a0>]}
[0m10:50:10.966179 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_patients ............................. [[31mERROR[0m in 2.22s]
[0m10:50:10.967002 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m10:50:10.969402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:50:10.969882 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m10:50:10.970272 [info ] [MainThread]: 
[0m10:50:10.970832 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m10:50:10.971955 [debug] [MainThread]: Command end result
[0m10:50:11.005344 [info ] [MainThread]: 
[0m10:50:11.006104 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:50:11.006699 [info ] [MainThread]: 
[0m10:50:11.007374 [error] [MainThread]:   Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier '"a"'
[0m10:50:11.007941 [info ] [MainThread]: 
[0m10:50:11.008355 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:50:11.008958 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 5.935559, "process_in_blocks": "0", "process_kernel_time": 0.559255, "process_mem_max_rss": "132042752", "process_out_blocks": "0", "process_user_time": 2.640943}
[0m10:50:11.009620 [debug] [MainThread]: Command `dbt seed` failed at 10:50:11.009503 after 5.94 seconds
[0m10:50:11.010116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e47a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107971400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb1dc0>]}
[0m10:50:11.010483 [debug] [MainThread]: Flushing usage events
[0m10:54:19.719098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101724e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d387d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d38590>]}


============================== 10:54:19.725739 | 38361720-0863-4b1d-a9ae-2d41fd2fa4cb ==============================
[0m10:54:19.725739 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:54:19.726573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --select stg_patients', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:54:20.418969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38361720-0863-4b1d-a9ae-2d41fd2fa4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054783b0>]}
[0m10:54:20.478320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38361720-0863-4b1d-a9ae-2d41fd2fa4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b8d970>]}
[0m10:54:20.480494 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:54:20.627627 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:54:20.801696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:54:20.802478 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/properties.yml
[0m10:54:21.032437 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m10:54:21.038575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38361720-0863-4b1d-a9ae-2d41fd2fa4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d68a70>]}
[0m10:54:21.129289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38361720-0863-4b1d-a9ae-2d41fd2fa4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b4b7a0>]}
[0m10:54:21.129900 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m10:54:21.130264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38361720-0863-4b1d-a9ae-2d41fd2fa4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fdeb0>]}
[0m10:54:21.132002 [info ] [MainThread]: 
[0m10:54:21.132704 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:54:21.133728 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m10:54:21.147477 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m10:54:21.147927 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m10:54:21.148311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:21.677645 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.529 seconds
[0m10:54:21.679798 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m10:54:21.761028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m10:54:21.772453 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m10:54:21.772969 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m10:54:21.773354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:54:22.142676 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.369 seconds
[0m10:54:22.147470 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m10:54:22.227989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38361720-0863-4b1d-a9ae-2d41fd2fa4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f739b0>]}
[0m10:54:22.229113 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:54:22.229847 [info ] [MainThread]: 
[0m10:54:22.234089 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m10:54:22.235018 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m10:54:22.235806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m10:54:22.236424 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m10:54:22.237244 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m10:54:22.250326 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:54:22.250925 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m10:54:22.311461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:22.608853 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.297 seconds
[0m10:54:22.611978 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m10:54:22.613276 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:54:22.613915 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m10:54:22.713665 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m10:54:22.769363 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:54:22.769872 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:54:22.876069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m10:54:22.876833 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:54:22.877376 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS"
  ;
[0m10:54:23.107801 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m10:54:23.108573 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:54:23.108992 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
COMMIT
[0m10:54:23.339850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m10:54:23.359801 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:54:23.360360 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:54:23.447873 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m10:54:23.453183 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:54:23.453945 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
insert into CASPAR_HEALTH.public.stg_patients ("a", "PATIENT_ID", "first_name", "last_name", "country") values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s)...
[0m10:54:23.556928 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a072-0203-b55c-0003-18c200015076
[0m10:54:23.557594 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 47
invalid identifier '"a"'
[0m10:54:23.558341 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m10:54:23.641869 [debug] [Thread-1 (]: Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier '"a"'
[0m10:54:23.643676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38361720-0863-4b1d-a9ae-2d41fd2fa4cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105733bc0>]}
[0m10:54:23.644334 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_patients ............................. [[31mERROR[0m in 1.41s]
[0m10:54:23.645124 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m10:54:23.647350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:54:23.647790 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m10:54:23.648171 [info ] [MainThread]: 
[0m10:54:23.648804 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m10:54:23.649782 [debug] [MainThread]: Command end result
[0m10:54:23.684595 [info ] [MainThread]: 
[0m10:54:23.685227 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:54:23.685593 [info ] [MainThread]: 
[0m10:54:23.686006 [error] [MainThread]:   Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier '"a"'
[0m10:54:23.686322 [info ] [MainThread]: 
[0m10:54:23.686650 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:54:23.687320 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 4.049029, "process_in_blocks": "0", "process_kernel_time": 0.625235, "process_mem_max_rss": "131407872", "process_out_blocks": "0", "process_user_time": 2.717811}
[0m10:54:23.687873 [debug] [MainThread]: Command `dbt seed` failed at 10:54:23.687766 after 4.05 seconds
[0m10:54:23.688296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ea16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ec1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10474bec0>]}
[0m10:54:23.688681 [debug] [MainThread]: Flushing usage events
[0m10:54:31.925855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10545e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105738500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057382f0>]}


============================== 10:54:31.931668 | 06e2c0dd-9c4b-4817-a1f5-7e6ad2ac7d48 ==============================
[0m10:54:31.931668 [info ] [MainThread]: Running with dbt=1.8.9
[0m10:54:31.932291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --select stg_patients', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:54:32.494475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06e2c0dd-9c4b-4817-a1f5-7e6ad2ac7d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b20950>]}
[0m10:54:32.579670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06e2c0dd-9c4b-4817-a1f5-7e6ad2ac7d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106133bc0>]}
[0m10:54:32.581634 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m10:54:32.733750 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m10:54:32.905245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:54:32.905985 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/properties.yml
[0m10:54:33.124175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m10:54:33.129975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06e2c0dd-9c4b-4817-a1f5-7e6ad2ac7d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106768680>]}
[0m10:54:33.224530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06e2c0dd-9c4b-4817-a1f5-7e6ad2ac7d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106273260>]}
[0m10:54:33.225055 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m10:54:33.225412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06e2c0dd-9c4b-4817-a1f5-7e6ad2ac7d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b6060>]}
[0m10:54:33.227023 [info ] [MainThread]: 
[0m10:54:33.227645 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:54:33.228510 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m10:54:33.240779 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m10:54:33.241222 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m10:54:33.241537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:33.636444 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.395 seconds
[0m10:54:33.640833 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m10:54:33.725518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m10:54:33.739939 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m10:54:33.740535 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m10:54:33.740985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:54:34.091590 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.351 seconds
[0m10:54:34.094326 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m10:54:34.170663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06e2c0dd-9c4b-4817-a1f5-7e6ad2ac7d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c5ac0>]}
[0m10:54:34.171550 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:54:34.172072 [info ] [MainThread]: 
[0m10:54:34.175534 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m10:54:34.176506 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m10:54:34.177367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m10:54:34.177895 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m10:54:34.178362 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m10:54:34.189174 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:54:34.189687 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m10:54:34.254576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:34.582039 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.327 seconds
[0m10:54:34.585808 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m10:54:34.587539 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:54:34.588545 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m10:54:34.688179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m10:54:34.737260 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:54:34.738027 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:54:34.834923 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m10:54:34.836008 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:54:34.836845 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS"
  ;
[0m10:54:34.992440 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m10:54:34.993914 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:54:34.995062 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
COMMIT
[0m10:54:35.254990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.259 seconds
[0m10:54:35.282638 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:54:35.283285 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m10:54:35.362091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m10:54:35.366193 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m10:54:35.366810 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
insert into CASPAR_HEALTH.public.stg_patients (a, PATIENT_ID, first_name, last_name, country) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m10:54:35.457622 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a072-0203-b6af-0003-18c20001409a
[0m10:54:35.458320 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 47
invalid identifier 'A'
[0m10:54:35.459058 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m10:54:35.878082 [debug] [Thread-1 (]: Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier 'A'
[0m10:54:35.880790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06e2c0dd-9c4b-4817-a1f5-7e6ad2ac7d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a4dbe0>]}
[0m10:54:35.881768 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_patients ............................. [[31mERROR[0m in 1.70s]
[0m10:54:35.882942 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m10:54:35.886106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:54:35.886691 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m10:54:35.887209 [info ] [MainThread]: 
[0m10:54:35.887761 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m10:54:35.888789 [debug] [MainThread]: Command end result
[0m10:54:35.923939 [info ] [MainThread]: 
[0m10:54:35.924448 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:54:35.924851 [info ] [MainThread]: 
[0m10:54:35.925302 [error] [MainThread]:   Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier 'A'
[0m10:54:35.925629 [info ] [MainThread]: 
[0m10:54:35.926028 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:54:35.926654 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 4.073076, "process_in_blocks": "0", "process_kernel_time": 0.514161, "process_mem_max_rss": "132739072", "process_out_blocks": "0", "process_user_time": 2.625761}
[0m10:54:35.927304 [debug] [MainThread]: Command `dbt seed` failed at 10:54:35.927189 after 4.07 seconds
[0m10:54:35.927809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d35c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b6a80>]}
[0m10:54:35.928390 [debug] [MainThread]: Flushing usage events
[0m11:14:54.219991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117dabd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b24770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b24530>]}


============================== 11:14:54.226955 | ee975c5d-f877-4273-b143-9f642d156c6f ==============================
[0m11:14:54.226955 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:14:54.227575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --select stg_patients', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:14:54.972395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee975c5d-f877-4273-b143-9f642d156c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11251bb00>]}
[0m11:14:55.036131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee975c5d-f877-4273-b143-9f642d156c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126baa80>]}
[0m11:14:55.038712 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:14:55.185173 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:14:55.392946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:14:55.393640 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/stg_patients.csv
[0m11:14:55.649744 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m11:14:55.655441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee975c5d-f877-4273-b143-9f642d156c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b8d0d0>]}
[0m11:14:55.750800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee975c5d-f877-4273-b143-9f642d156c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112937500>]}
[0m11:14:55.751369 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m11:14:55.751767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee975c5d-f877-4273-b143-9f642d156c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b83200>]}
[0m11:14:55.753427 [info ] [MainThread]: 
[0m11:14:55.754086 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:14:55.754938 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m11:14:55.768702 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m11:14:55.769217 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m11:14:55.769554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:56.922323 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.153 seconds
[0m11:14:56.924227 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m11:14:57.015484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m11:14:57.025234 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m11:14:57.025749 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m11:14:57.026118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:57.431816 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.406 seconds
[0m11:14:57.433893 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m11:14:57.567567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee975c5d-f877-4273-b143-9f642d156c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118178c0>]}
[0m11:14:57.568240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:14:57.568632 [info ] [MainThread]: 
[0m11:14:57.572700 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m11:14:57.573361 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m11:14:57.573939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m11:14:57.574360 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m11:14:57.574731 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m11:14:57.584355 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:14:57.648682 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m11:14:57.649227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:14:58.761101 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.112 seconds
[0m11:14:58.764770 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m11:14:58.766155 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:14:58.767001 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m11:14:58.914352 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.147 seconds
[0m11:14:58.952419 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:14:58.952922 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m11:14:59.097426 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.144 seconds
[0m11:14:59.098573 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:14:59.099608 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS"
  ;
[0m11:14:59.224750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m11:14:59.225602 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:14:59.226268 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
COMMIT
[0m11:14:59.434737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m11:14:59.463020 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:14:59.463636 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m11:14:59.716188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.252 seconds
[0m11:14:59.718867 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:14:59.719286 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
insert into CASPAR_HEALTH.public.stg_patients (row_id, PATIENT_ID, first_name, last_name, country) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,...
[0m11:15:00.927662 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 1.208 seconds
[0m11:15:00.929118 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:15:00.929961 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
COMMIT
[0m11:15:01.646570 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.716 seconds
[0m11:15:01.654634 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.caspar_health_technical_challenge.stg_patients"
[0m11:15:01.685417 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m11:15:01.770696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee975c5d-f877-4273-b143-9f642d156c6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e476e0>]}
[0m11:15:01.771410 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.stg_patients ................................. [[32mINSERT 100[0m in 4.20s]
[0m11:15:01.772107 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m11:15:01.774136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:01.774522 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m11:15:01.774867 [info ] [MainThread]: 
[0m11:15:01.775258 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.02 seconds (6.02s).
[0m11:15:01.775916 [debug] [MainThread]: Command end result
[0m11:15:01.807560 [info ] [MainThread]: 
[0m11:15:01.808243 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:01.808633 [info ] [MainThread]: 
[0m11:15:01.809022 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:15:01.809689 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.6805997, "process_in_blocks": "0", "process_kernel_time": 0.643494, "process_mem_max_rss": "131682304", "process_out_blocks": "0", "process_user_time": 2.784982}
[0m11:15:01.810159 [debug] [MainThread]: Command `dbt seed` succeeded at 11:15:01.810062 after 7.68 seconds
[0m11:15:01.810660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117dabd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112607b90>]}
[0m11:15:01.811264 [debug] [MainThread]: Flushing usage events
[0m11:15:09.186951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cce240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b13c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b13c380>]}


============================== 11:15:09.214073 | 9c5f62e9-0dcd-4d15-8080-e8b139f5024b ==============================
[0m11:15:09.214073 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:15:09.217083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --select stg_steps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:15:10.111831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c5f62e9-0dcd-4d15-8080-e8b139f5024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b108c20>]}
[0m11:15:10.166313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c5f62e9-0dcd-4d15-8080-e8b139f5024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc703b0>]}
[0m11:15:10.168324 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:15:10.333787 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:15:10.497295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:10.497739 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:10.502964 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m11:15:10.519702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c5f62e9-0dcd-4d15-8080-e8b139f5024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bad7e60>]}
[0m11:15:10.615410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c5f62e9-0dcd-4d15-8080-e8b139f5024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd87c50>]}
[0m11:15:10.616258 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m11:15:10.617073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c5f62e9-0dcd-4d15-8080-e8b139f5024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcd0b00>]}
[0m11:15:10.619348 [info ] [MainThread]: 
[0m11:15:10.620203 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:15:10.621667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m11:15:10.639668 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m11:15:10.640250 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m11:15:10.640751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:11.271452 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.631 seconds
[0m11:15:11.274393 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m11:15:11.370381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m11:15:11.382674 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m11:15:11.383166 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m11:15:11.383495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:11.777578 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.394 seconds
[0m11:15:11.780533 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m11:15:12.384441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c5f62e9-0dcd-4d15-8080-e8b139f5024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1cf9b0>]}
[0m11:15:12.385351 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:15:12.385822 [info ] [MainThread]: 
[0m11:15:12.389595 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_steps
[0m11:15:12.390446 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_steps ........................................ [RUN]
[0m11:15:12.391560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_steps)
[0m11:15:12.392404 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_steps
[0m11:15:12.393017 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_steps
[0m11:15:12.405457 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:15:12.406015 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
show parameters like 'query_tag' in session
[0m11:15:12.406407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:15:12.812797 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m11:15:12.814353 [debug] [Thread-1 (]: Setting query_tag to 'stg_steps'. Will reset to '' after materialization.
[0m11:15:12.815174 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:15:12.815899 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
alter session set query_tag = 'stg_steps'
[0m11:15:12.887963 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m11:15:13.695037 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:15:13.695660 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
BEGIN
[0m11:15:14.530487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.834 seconds
[0m11:15:14.531852 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:15:14.532902 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_STEPS"
  ;
[0m11:15:15.109483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m11:15:15.110494 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:15:15.111823 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
COMMIT
[0m11:15:15.449824 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.337 seconds
[0m11:15:15.610279 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:15:15.610786 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
BEGIN
[0m11:15:15.794511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m11:15:17.275338 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:15:17.275942 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
insert into CASPAR_HEALTH.public.stg_steps (ID, EXTERNAL_ID, STEPS, SUBMISSION_TIME, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m11:15:20.149587 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.873 seconds
[0m11:15:20.150880 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:15:20.151705 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
COMMIT
[0m11:15:20.568506 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.416 seconds
[0m11:15:20.602774 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:15:20.603260 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
BEGIN
[0m11:15:20.696366 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m11:15:20.773372 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:15:20.780958 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
insert into CASPAR_HEALTH.public.stg_steps (ID, EXTERNAL_ID, STEPS, SUBMISSION_TIME, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m11:15:21.743569 [debug] [Thread-1 (]: SQL status: SUCCESS 1909 in 0.962 seconds
[0m11:15:21.744804 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:15:21.745802 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
COMMIT
[0m11:15:22.107376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.361 seconds
[0m11:15:22.120852 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.caspar_health_technical_challenge.stg_steps"
[0m11:15:22.153963 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: Close
[0m11:15:22.266858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c5f62e9-0dcd-4d15-8080-e8b139f5024b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c11be60>]}
[0m11:15:22.267626 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.stg_steps .................................... [[32mINSERT 11909[0m in 9.87s]
[0m11:15:22.268288 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_steps
[0m11:15:22.269918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:22.270318 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_steps' was properly closed.
[0m11:15:22.270668 [info ] [MainThread]: 
[0m11:15:22.271017 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 11.65 seconds (11.65s).
[0m11:15:22.272079 [debug] [MainThread]: Command end result
[0m11:15:22.306707 [info ] [MainThread]: 
[0m11:15:22.307507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:22.307979 [info ] [MainThread]: 
[0m11:15:22.308418 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:15:22.309051 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 13.272964, "process_in_blocks": "0", "process_kernel_time": 0.812136, "process_mem_max_rss": "156712960", "process_out_blocks": "0", "process_user_time": 5.417676}
[0m11:15:22.309815 [debug] [MainThread]: Command `dbt seed` succeeded at 11:15:22.309693 after 13.27 seconds
[0m11:15:22.310217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f30f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b55e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cce240>]}
[0m11:15:22.310745 [debug] [MainThread]: Flushing usage events
[0m11:37:32.644838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107258590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107258350>]}


============================== 11:37:32.653211 | 532fe0cf-eb9f-4472-91cd-03fd4ed18cf2 ==============================
[0m11:37:32.653211 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:37:32.653870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --select stg_patients', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:37:33.351377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '532fe0cf-eb9f-4472-91cd-03fd4ed18cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0a120>]}
[0m11:37:33.406268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '532fe0cf-eb9f-4472-91cd-03fd4ed18cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107207770>]}
[0m11:37:33.426350 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:37:33.594157 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:37:33.790708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:37:33.791524 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/properties.yml
[0m11:37:33.791954 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/stg_patients.csv
[0m11:37:34.014625 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m11:37:34.020879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '532fe0cf-eb9f-4472-91cd-03fd4ed18cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4fc80>]}
[0m11:37:34.110652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '532fe0cf-eb9f-4472-91cd-03fd4ed18cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e3aa0>]}
[0m11:37:34.111153 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m11:37:34.111517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '532fe0cf-eb9f-4472-91cd-03fd4ed18cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10816ed50>]}
[0m11:37:34.113074 [info ] [MainThread]: 
[0m11:37:34.113693 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:37:34.114626 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m11:37:34.128426 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m11:37:34.128888 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m11:37:34.129211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:37:34.707652 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.578 seconds
[0m11:37:34.712068 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m11:37:34.827666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m11:37:34.840391 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m11:37:34.840915 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m11:37:34.841348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:37:35.267165 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.426 seconds
[0m11:37:35.270670 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m11:37:35.370874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '532fe0cf-eb9f-4472-91cd-03fd4ed18cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ca420>]}
[0m11:37:35.371987 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:37:35.372691 [info ] [MainThread]: 
[0m11:37:35.377916 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m11:37:35.378888 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m11:37:35.380248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m11:37:35.381000 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m11:37:35.381705 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m11:37:35.395571 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:37:35.396202 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m11:37:35.458981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:37:35.799988 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.341 seconds
[0m11:37:35.803692 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m11:37:35.805463 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:37:35.806427 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m11:37:35.919970 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m11:37:35.956365 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:37:35.956867 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m11:37:36.122763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m11:37:36.124163 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:37:36.125236 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS"
  ;
[0m11:37:36.490473 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.364 seconds
[0m11:37:36.491871 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:37:36.493001 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
COMMIT
[0m11:37:36.900550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m11:37:36.939915 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:37:36.940755 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m11:37:37.097777 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m11:37:37.104111 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:37:37.104993 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
insert into CASPAR_HEALTH.public.stg_patients (a, PATIENT_ID, first_name, last_name, country) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m11:37:37.222125 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a09d-0203-b56e-0003-18c200013ac6
[0m11:37:37.223431 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 47
invalid identifier 'A'
[0m11:37:37.224573 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m11:37:37.341516 [debug] [Thread-1 (]: Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier 'A'
[0m11:37:37.344295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '532fe0cf-eb9f-4472-91cd-03fd4ed18cf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108164bc0>]}
[0m11:37:37.345294 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_patients ............................. [[31mERROR[0m in 1.96s]
[0m11:37:37.346466 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m11:37:37.349803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:37:37.350430 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m11:37:37.350998 [info ] [MainThread]: 
[0m11:37:37.351579 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m11:37:37.353299 [debug] [MainThread]: Command end result
[0m11:37:37.390421 [info ] [MainThread]: 
[0m11:37:37.391098 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:37:37.391471 [info ] [MainThread]: 
[0m11:37:37.391871 [error] [MainThread]:   Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier 'A'
[0m11:37:37.392186 [info ] [MainThread]: 
[0m11:37:37.392529 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:37:37.393373 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 4.8328824, "process_in_blocks": "0", "process_kernel_time": 0.646943, "process_mem_max_rss": "132009984", "process_out_blocks": "0", "process_user_time": 2.779796}
[0m11:37:37.394052 [debug] [MainThread]: Command `dbt seed` failed at 11:37:37.393911 after 4.83 seconds
[0m11:37:37.394871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a4230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c88ce0>]}
[0m11:37:37.395714 [debug] [MainThread]: Flushing usage events
[0m11:38:07.387872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b34800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b345c0>]}


============================== 11:38:07.394217 | ea37968d-4c89-42db-88fb-ab9ad6f90039 ==============================
[0m11:38:07.394217 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:38:07.394848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --select stg_patients --full-refresh', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:38:08.026413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea37968d-4c89-42db-88fb-ab9ad6f90039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f63530>]}
[0m11:38:08.083408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea37968d-4c89-42db-88fb-ab9ad6f90039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c1220>]}
[0m11:38:08.085627 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:38:08.248735 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:38:08.429794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:38:08.430245 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:38:08.435988 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m11:38:08.455995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea37968d-4c89-42db-88fb-ab9ad6f90039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a0800>]}
[0m11:38:08.550174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea37968d-4c89-42db-88fb-ab9ad6f90039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972e690>]}
[0m11:38:08.550831 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m11:38:08.551455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea37968d-4c89-42db-88fb-ab9ad6f90039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096f6f90>]}
[0m11:38:08.553309 [info ] [MainThread]: 
[0m11:38:08.554090 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:38:08.555082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m11:38:08.571209 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m11:38:08.571806 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m11:38:08.572183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:09.116784 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.545 seconds
[0m11:38:09.119051 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m11:38:09.218459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m11:38:09.231787 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m11:38:09.232338 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m11:38:09.232757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:09.563984 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.331 seconds
[0m11:38:09.567157 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m11:38:09.670394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea37968d-4c89-42db-88fb-ab9ad6f90039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10994a570>]}
[0m11:38:09.671496 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:09.672233 [info ] [MainThread]: 
[0m11:38:09.676849 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m11:38:09.677671 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m11:38:09.678443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m11:38:09.679111 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m11:38:09.679609 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m11:38:09.690828 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:38:09.691417 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m11:38:09.691845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:10.029250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.337 seconds
[0m11:38:10.032336 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m11:38:10.033710 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:38:10.034423 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m11:38:10.155063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m11:38:10.196643 [debug] [Thread-1 (]: Applying DROP to: "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS"
[0m11:38:10.203786 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:38:10.204297 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
drop table if exists "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS" cascade
[0m11:38:10.287662 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a09e-0203-b42e-0003-18c200012ab2
[0m11:38:10.288197 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on table 'STG_PATIENTS'
[0m11:38:10.288698 [debug] [Thread-1 (]: Snowflake adapter: Error running SQL: macro drop_relation
[0m11:38:10.289037 [debug] [Thread-1 (]: Snowflake adapter: Rolling back transaction.
[0m11:38:10.289452 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m11:38:10.386403 [debug] [Thread-1 (]: Database Error in seed stg_patients (seeds/stg_patients.csv)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'STG_PATIENTS'
[0m11:38:10.388419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea37968d-4c89-42db-88fb-ab9ad6f90039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab15b0>]}
[0m11:38:10.389184 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_patients ............................. [[31mERROR[0m in 0.71s]
[0m11:38:10.390079 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m11:38:10.392327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:10.392784 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m11:38:10.393214 [info ] [MainThread]: 
[0m11:38:10.393787 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m11:38:10.394707 [debug] [MainThread]: Command end result
[0m11:38:10.431075 [info ] [MainThread]: 
[0m11:38:10.431962 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:38:10.432538 [info ] [MainThread]: 
[0m11:38:10.433041 [error] [MainThread]:   Database Error in seed stg_patients (seeds/stg_patients.csv)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'STG_PATIENTS'
[0m11:38:10.433462 [info ] [MainThread]: 
[0m11:38:10.433885 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:38:10.434791 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.1235201, "process_in_blocks": "0", "process_kernel_time": 0.523813, "process_mem_max_rss": "129736704", "process_out_blocks": "0", "process_user_time": 2.275423}
[0m11:38:10.435338 [debug] [MainThread]: Command `dbt seed` failed at 11:38:10.435230 after 3.12 seconds
[0m11:38:10.435749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10814f680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108829550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe5340>]}
[0m11:38:10.436111 [debug] [MainThread]: Flushing usage events
[0m11:42:59.155534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106ba180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11166c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11166c4a0>]}


============================== 11:42:59.163528 | 540cd371-fabd-4bd5-aeb9-f1da6cdc4ee7 ==============================
[0m11:42:59.163528 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:42:59.164248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --select stg_patients --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m11:42:59.859275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '540cd371-fabd-4bd5-aeb9-f1da6cdc4ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ad2840>]}
[0m11:42:59.921180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '540cd371-fabd-4bd5-aeb9-f1da6cdc4ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11051a630>]}
[0m11:42:59.923679 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:43:00.086563 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:43:00.307770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:43:00.308437 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:43:00.315992 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m11:43:00.350644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '540cd371-fabd-4bd5-aeb9-f1da6cdc4ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121e9850>]}
[0m11:43:00.551638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '540cd371-fabd-4bd5-aeb9-f1da6cdc4ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112356630>]}
[0m11:43:00.596015 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m11:43:00.605995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '540cd371-fabd-4bd5-aeb9-f1da6cdc4ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11223d760>]}
[0m11:43:00.632893 [info ] [MainThread]: 
[0m11:43:00.634105 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:43:00.639442 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m11:43:00.674595 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m11:43:00.675699 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m11:43:00.676885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:01.222366 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.545 seconds
[0m11:43:01.224891 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m11:43:01.305812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m11:43:01.347550 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m11:43:01.348387 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m11:43:01.349264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:01.636407 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.287 seconds
[0m11:43:01.638634 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m11:43:01.769843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '540cd371-fabd-4bd5-aeb9-f1da6cdc4ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125d3290>]}
[0m11:43:01.771498 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:43:01.772752 [info ] [MainThread]: 
[0m11:43:01.779422 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m11:43:01.781078 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m11:43:01.782919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m11:43:01.784432 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m11:43:01.785949 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m11:43:01.806811 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:43:01.808387 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m11:43:01.810246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:02.173008 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.363 seconds
[0m11:43:02.176526 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m11:43:02.178228 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:43:02.178773 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m11:43:02.245463 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.066 seconds
[0m11:43:02.290369 [debug] [Thread-1 (]: Applying DROP to: "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS"
[0m11:43:02.299008 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:43:02.299621 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
drop table if exists "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS" cascade
[0m11:43:03.060473 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.760 seconds
[0m11:43:03.071916 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:43:03.072840 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
create table CASPAR_HEALTH.public.stg_patients (a integer,PATIENT_ID integer,first_name varchar(32),last_name varchar(32),country varchar(32))
[0m11:43:03.202854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.129 seconds
[0m11:43:03.242795 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:43:03.260797 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m11:43:03.326086 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.065 seconds
[0m11:43:03.330468 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:43:03.332349 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
insert into CASPAR_HEALTH.public.stg_patients (a, PATIENT_ID, first_name, last_name, country) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m11:43:03.872267 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a0a3-0203-b5f1-0003-18c2000160aa
[0m11:43:03.872985 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 100078 (22000): String 'Heard Island and McDonald Islands' is too long and would be truncated
[0m11:43:03.873736 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m11:43:03.964394 [debug] [Thread-1 (]: Database Error in seed stg_patients (seeds/stg_patients.csv)
  100078 (22000): String 'Heard Island and McDonald Islands' is too long and would be truncated
[0m11:43:03.966590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '540cd371-fabd-4bd5-aeb9-f1da6cdc4ee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11263ef90>]}
[0m11:43:03.967595 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_patients ............................. [[31mERROR[0m in 2.18s]
[0m11:43:03.968977 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m11:43:03.971225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:03.971646 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m11:43:03.972005 [info ] [MainThread]: 
[0m11:43:03.972725 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m11:43:03.974501 [debug] [MainThread]: Command end result
[0m11:43:04.017983 [info ] [MainThread]: 
[0m11:43:04.018643 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:43:04.019111 [info ] [MainThread]: 
[0m11:43:04.019612 [error] [MainThread]:   Database Error in seed stg_patients (seeds/stg_patients.csv)
  100078 (22000): String 'Heard Island and McDonald Islands' is too long and would be truncated
[0m11:43:04.020079 [info ] [MainThread]: 
[0m11:43:04.020682 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:43:04.021550 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 4.9514565, "process_in_blocks": "0", "process_kernel_time": 0.625835, "process_mem_max_rss": "130908160", "process_out_blocks": "0", "process_user_time": 2.519346}
[0m11:43:04.022493 [debug] [MainThread]: Command `dbt seed` failed at 11:43:04.022290 after 4.95 seconds
[0m11:43:04.023248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111391a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113638f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126ee030>]}
[0m11:43:04.023772 [debug] [MainThread]: Flushing usage events
[0m11:45:04.752743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10344b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046245c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104624380>]}


============================== 11:45:04.761236 | bd4408f3-3eaf-424c-8cc5-91f1a3d53810 ==============================
[0m11:45:04.761236 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:45:04.761857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --select stg_patients --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m11:45:05.442236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd4408f3-3eaf-424c-8cc5-91f1a3d53810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e071a0>]}
[0m11:45:05.497550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd4408f3-3eaf-424c-8cc5-91f1a3d53810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037196d0>]}
[0m11:45:05.500503 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:45:05.653384 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:45:05.860290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:45:05.861024 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/properties.yml
[0m11:45:06.084742 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m11:45:06.089928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd4408f3-3eaf-424c-8cc5-91f1a3d53810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105666b40>]}
[0m11:45:06.181620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd4408f3-3eaf-424c-8cc5-91f1a3d53810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10520eb40>]}
[0m11:45:06.182187 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m11:45:06.182641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd4408f3-3eaf-424c-8cc5-91f1a3d53810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10538c770>]}
[0m11:45:06.184301 [info ] [MainThread]: 
[0m11:45:06.185009 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:45:06.185972 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m11:45:06.199909 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m11:45:06.200407 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m11:45:06.200786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:06.768400 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.567 seconds
[0m11:45:06.772292 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m11:45:07.003554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m11:45:07.014721 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m11:45:07.015237 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m11:45:07.015623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:07.335505 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.320 seconds
[0m11:45:07.338238 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m11:45:07.415187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd4408f3-3eaf-424c-8cc5-91f1a3d53810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056555b0>]}
[0m11:45:07.416167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:45:07.416745 [info ] [MainThread]: 
[0m11:45:07.421488 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m11:45:07.422407 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m11:45:07.423343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m11:45:07.424252 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m11:45:07.424901 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m11:45:07.437498 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:45:07.438054 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m11:45:07.502873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:07.947828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m11:45:07.951720 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m11:45:07.953096 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:45:07.953769 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m11:45:08.065803 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m11:45:08.104493 [debug] [Thread-1 (]: Applying DROP to: "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS"
[0m11:45:08.111753 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:45:08.112289 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
drop table if exists "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS" cascade
[0m11:45:08.275609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.163 seconds
[0m11:45:08.287730 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:45:08.305928 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
create table CASPAR_HEALTH.public.stg_patients (a integer,PATIENT_ID integer,first_name varchar(max),last_name varchar(max),country varchar(max))
[0m11:45:08.433091 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a0a5-0203-b580-0003-18c2000170ba
[0m11:45:08.433728 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 95 unexpected '('.
[0m11:45:08.434827 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m11:45:08.524749 [debug] [Thread-1 (]: Database Error in seed stg_patients (seeds/stg_patients.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 95 unexpected '('.
[0m11:45:08.527165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4408f3-3eaf-424c-8cc5-91f1a3d53810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6cfb0>]}
[0m11:45:08.527829 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_patients ............................. [[31mERROR[0m in 1.10s]
[0m11:45:08.528505 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m11:45:08.530365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:08.530722 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m11:45:08.531084 [info ] [MainThread]: 
[0m11:45:08.531432 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m11:45:08.532180 [debug] [MainThread]: Command end result
[0m11:45:08.563928 [info ] [MainThread]: 
[0m11:45:08.564543 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:45:08.564910 [info ] [MainThread]: 
[0m11:45:08.565488 [error] [MainThread]:   Database Error in seed stg_patients (seeds/stg_patients.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 95 unexpected '('.
[0m11:45:08.566102 [info ] [MainThread]: 
[0m11:45:08.566812 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:45:08.568007 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.8963387, "process_in_blocks": "0", "process_kernel_time": 0.618046, "process_mem_max_rss": "131526656", "process_out_blocks": "0", "process_user_time": 2.6097}
[0m11:45:08.568552 [debug] [MainThread]: Command `dbt seed` failed at 11:45:08.568447 after 3.90 seconds
[0m11:45:08.568948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10344b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051635c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105160260>]}
[0m11:45:08.569305 [debug] [MainThread]: Flushing usage events
[0m11:46:26.300487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fecce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111080890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111080650>]}


============================== 11:46:26.308274 | a64a712a-7d67-46fa-bb7d-37c16e9d1bfd ==============================
[0m11:46:26.308274 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:46:26.308979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --select stg_patients --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:46:26.962630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a64a712a-7d67-46fa-bb7d-37c16e9d1bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111577b30>]}
[0m11:46:27.018757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a64a712a-7d67-46fa-bb7d-37c16e9d1bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9646e0>]}
[0m11:46:27.021021 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:46:27.179858 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:46:27.356722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:46:27.357460 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/properties.yml
[0m11:46:27.572286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m11:46:27.578033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a64a712a-7d67-46fa-bb7d-37c16e9d1bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11204b830>]}
[0m11:46:27.659927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a64a712a-7d67-46fa-bb7d-37c16e9d1bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114de900>]}
[0m11:46:27.660449 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m11:46:27.660814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a64a712a-7d67-46fa-bb7d-37c16e9d1bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ef00b0>]}
[0m11:46:27.662380 [info ] [MainThread]: 
[0m11:46:27.662989 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:46:27.663839 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m11:46:27.677879 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m11:46:27.678430 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m11:46:27.678757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:28.237159 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.558 seconds
[0m11:46:28.239781 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m11:46:28.319167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m11:46:28.332445 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m11:46:28.333074 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m11:46:28.333534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:28.702333 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.369 seconds
[0m11:46:28.705742 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m11:46:28.799754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a64a712a-7d67-46fa-bb7d-37c16e9d1bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c703e0>]}
[0m11:46:28.800755 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:28.801373 [info ] [MainThread]: 
[0m11:46:28.806386 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m11:46:28.807339 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m11:46:28.808029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m11:46:28.808541 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m11:46:28.809047 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m11:46:28.820634 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:46:28.821247 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m11:46:28.884217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:29.469844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m11:46:29.471976 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m11:46:29.472991 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:46:29.473600 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m11:46:29.537150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.063 seconds
[0m11:46:29.574867 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:46:29.575382 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
create table CASPAR_HEALTH.public.stg_patients (a integer,PATIENT_ID integer,first_name varchar(max),last_name varchar(max),country varchar(max))
[0m11:46:29.727181 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a0a6-0203-b526-0003-18c200018042
[0m11:46:29.727851 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 95 unexpected '('.
[0m11:46:29.728523 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m11:46:29.812107 [debug] [Thread-1 (]: Database Error in seed stg_patients (seeds/stg_patients.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 95 unexpected '('.
[0m11:46:29.814128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a64a712a-7d67-46fa-bb7d-37c16e9d1bfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d98140>]}
[0m11:46:29.814984 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_patients ............................. [[31mERROR[0m in 1.00s]
[0m11:46:29.816613 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m11:46:29.819082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:29.819572 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m11:46:29.819958 [info ] [MainThread]: 
[0m11:46:29.820403 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m11:46:29.821205 [debug] [MainThread]: Command end result
[0m11:46:29.855172 [info ] [MainThread]: 
[0m11:46:29.856105 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:46:29.856965 [info ] [MainThread]: 
[0m11:46:29.858037 [error] [MainThread]:   Database Error in seed stg_patients (seeds/stg_patients.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 95 unexpected '('.
[0m11:46:29.858641 [info ] [MainThread]: 
[0m11:46:29.859623 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:46:29.860631 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.6372194, "process_in_blocks": "0", "process_kernel_time": 0.5536, "process_mem_max_rss": "131461120", "process_out_blocks": "0", "process_user_time": 2.508241}
[0m11:46:29.861634 [debug] [MainThread]: Command `dbt seed` failed at 11:46:29.861415 after 3.64 seconds
[0m11:46:29.862272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe0fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11099ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aae180>]}
[0m11:46:29.862773 [debug] [MainThread]: Flushing usage events
[0m11:47:36.061277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b211130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e824890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e824650>]}


============================== 11:47:36.069751 | 4f7c7a33-d62b-49bb-ac77-89ce22e190cd ==============================
[0m11:47:36.069751 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:47:36.070443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed --select stg_patients --full-refresh', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:47:36.725485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f7c7a33-d62b-49bb-ac77-89ce22e190cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed923f0>]}
[0m11:47:36.779799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f7c7a33-d62b-49bb-ac77-89ce22e190cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f332630>]}
[0m11:47:36.782364 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:47:36.940935 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:47:37.143416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:47:37.144193 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://seeds/properties.yml
[0m11:47:37.365121 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m11:47:37.370385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f7c7a33-d62b-49bb-ac77-89ce22e190cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8855b0>]}
[0m11:47:37.458315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f7c7a33-d62b-49bb-ac77-89ce22e190cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7980b0>]}
[0m11:47:37.458838 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m11:47:37.459198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f7c7a33-d62b-49bb-ac77-89ce22e190cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f41c770>]}
[0m11:47:37.460761 [info ] [MainThread]: 
[0m11:47:37.461348 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:47:37.462296 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m11:47:37.475459 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m11:47:37.475900 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m11:47:37.476917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:37.939910 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.463 seconds
[0m11:47:37.944090 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m11:47:38.023561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m11:47:38.039043 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m11:47:38.039626 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m11:47:38.040011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:38.370507 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.330 seconds
[0m11:47:38.374206 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m11:47:38.457974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f7c7a33-d62b-49bb-ac77-89ce22e190cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8cdac0>]}
[0m11:47:38.458985 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:47:38.459595 [info ] [MainThread]: 
[0m11:47:38.463179 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m11:47:38.464015 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m11:47:38.464722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m11:47:38.465256 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m11:47:38.465774 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m11:47:38.477931 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:47:38.478459 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m11:47:38.538458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:38.843491 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.305 seconds
[0m11:47:38.845700 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m11:47:38.846700 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:47:38.847314 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m11:47:39.134454 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.286 seconds
[0m11:47:39.169391 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:47:39.169878 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
create table CASPAR_HEALTH.public.stg_patients (a integer,PATIENT_ID integer,first_name varchar(16777216),last_name varchar(16777216),country varchar(16777216))
[0m11:47:39.310892 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m11:47:39.332593 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:47:39.333185 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m11:47:39.419557 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m11:47:39.424431 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:47:39.425170 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
insert into CASPAR_HEALTH.public.stg_patients (a, PATIENT_ID, first_name, last_name, country) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m11:47:40.096207 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 0.670 seconds
[0m11:47:40.097140 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:47:40.097747 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
COMMIT
[0m11:47:40.260194 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m11:47:40.272587 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.caspar_health_technical_challenge.stg_patients"
[0m11:47:40.306134 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m11:47:40.412789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f7c7a33-d62b-49bb-ac77-89ce22e190cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbd7ef0>]}
[0m11:47:40.413766 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.stg_patients ................................. [[32mCREATE 100[0m in 1.95s]
[0m11:47:40.414736 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m11:47:40.416860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:40.417751 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m11:47:40.418877 [info ] [MainThread]: 
[0m11:47:40.419680 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m11:47:40.421286 [debug] [MainThread]: Command end result
[0m11:47:40.454094 [info ] [MainThread]: 
[0m11:47:40.454641 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:47:40.454990 [info ] [MainThread]: 
[0m11:47:40.455345 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:47:40.456053 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.4775124, "process_in_blocks": "0", "process_kernel_time": 0.552089, "process_mem_max_rss": "131112960", "process_out_blocks": "0", "process_user_time": 2.566451}
[0m11:47:40.456607 [debug] [MainThread]: Command `dbt seed` succeeded at 11:47:40.456495 after 4.48 seconds
[0m11:47:40.457009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e475700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1bc980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1fe2a0>]}
[0m11:47:40.457611 [debug] [MainThread]: Flushing usage events
[0m11:48:06.330651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10541a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108438410>]}


============================== 11:48:06.337907 | 3c9b8359-986f-4d4d-b51a-9ce9b50e0db9 ==============================
[0m11:48:06.337907 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:48:06.339154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt seed --select stg_seeds', 'send_anonymous_usage_stats': 'True'}
[0m11:48:07.009156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c9b8359-986f-4d4d-b51a-9ce9b50e0db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089dd670>]}
[0m11:48:07.073580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c9b8359-986f-4d4d-b51a-9ce9b50e0db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e6600>]}
[0m11:48:07.075600 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:48:07.221822 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:48:07.395109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:48:07.395552 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:48:07.400726 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m11:48:07.418790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c9b8359-986f-4d4d-b51a-9ce9b50e0db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a05f0>]}
[0m11:48:07.493988 [error] [MainThread]: Encountered an error:

[0m11:48:07.505622 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 694, in seed
    from dbt.task.seed import SeedTask
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/seed.py", line 3, in <module>
    from .run import ModelRunner, RunTask
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/run.py", line 8, in <module>
    from .compile import CompileRunner, CompileTask
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/compile.py", line 18, in <module>
    from dbt.task.base import BaseRunner
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/base.py", line 11, in <module>
    from dbt.compilation import Compiler
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/compilation.py", line 43, in <module>
    import sqlparse
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/sqlparse/__init__.py", line 13, in <module>
    from sqlparse import engine
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/sqlparse/engine/__init__.py", line 9, in <module>
    from sqlparse.engine.filter_stack import FilterStack
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/sqlparse/engine/filter_stack.py", line 10, in <module>
    from sqlparse import lexer
  File "<frozen importlib._bootstrap>", line 1354, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1316, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1256, in _find_spec
  File "<frozen importlib._bootstrap_external>", line 1524, in find_spec
  File "<frozen importlib._bootstrap_external>", line 1498, in _get_spec
  File "<frozen importlib._bootstrap_external>", line 1597, in find_spec
  File "<frozen importlib._bootstrap_external>", line 147, in _path_stat
KeyboardInterrupt

[0m11:48:07.512490 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.2642739, "process_in_blocks": "0", "process_kernel_time": 0.556564, "process_mem_max_rss": "119255040", "process_out_blocks": "0", "process_user_time": 2.174974}
[0m11:48:07.513099 [debug] [MainThread]: Command `dbt seed` failed at 11:48:07.512983 after 1.27 seconds
[0m11:48:07.513513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108438500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108934980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109216d80>]}
[0m11:48:07.514018 [debug] [MainThread]: Flushing usage events
[0m11:48:12.590932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ee9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b387d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b38590>]}


============================== 11:48:12.597964 | dd2e10fe-1ff8-417b-92dd-e4e0ba730907 ==============================
[0m11:48:12.597964 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:48:12.598674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --select stg_steps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:48:13.203963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd2e10fe-1ff8-417b-92dd-e4e0ba730907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105647110>]}
[0m11:48:13.257479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd2e10fe-1ff8-417b-92dd-e4e0ba730907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105467ef0>]}
[0m11:48:13.259696 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:48:13.400041 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:48:13.581070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:48:13.581531 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:48:13.587719 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m11:48:13.608143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd2e10fe-1ff8-417b-92dd-e4e0ba730907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589c800>]}
[0m11:48:13.691768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd2e10fe-1ff8-417b-92dd-e4e0ba730907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fe0f0>]}
[0m11:48:13.692301 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m11:48:13.692842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd2e10fe-1ff8-417b-92dd-e4e0ba730907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104782630>]}
[0m11:48:13.694378 [info ] [MainThread]: 
[0m11:48:13.695015 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:48:13.696158 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m11:48:13.711680 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m11:48:13.712172 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m11:48:13.712707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:14.547896 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.835 seconds
[0m11:48:14.550072 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m11:48:14.626794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m11:48:14.639456 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m11:48:14.640038 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m11:48:14.640417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:14.976927 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.336 seconds
[0m11:48:14.980402 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m11:48:15.089563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd2e10fe-1ff8-417b-92dd-e4e0ba730907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105916e40>]}
[0m11:48:15.090579 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:48:15.091128 [info ] [MainThread]: 
[0m11:48:15.096082 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_steps
[0m11:48:15.096937 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_steps ........................................ [RUN]
[0m11:48:15.097655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_steps)
[0m11:48:15.098180 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_steps
[0m11:48:15.098711 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_steps
[0m11:48:15.110701 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:48:15.111486 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
show parameters like 'query_tag' in session
[0m11:48:15.112269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:15.887861 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.776 seconds
[0m11:48:15.889501 [debug] [Thread-1 (]: Setting query_tag to 'stg_steps'. Will reset to '' after materialization.
[0m11:48:15.891079 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:48:15.892044 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
alter session set query_tag = 'stg_steps'
[0m11:48:15.962318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.070 seconds
[0m11:48:16.804826 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:48:16.806919 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
BEGIN
[0m11:48:16.959284 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m11:48:16.960351 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:48:16.961070 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_STEPS"
  ;
[0m11:48:17.129464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.168 seconds
[0m11:48:17.130435 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:48:17.131188 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
COMMIT
[0m11:48:17.529507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m11:48:17.703810 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:48:17.704511 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
BEGIN
[0m11:48:17.786009 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.081 seconds
[0m11:48:19.392415 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:48:19.393060 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
insert into CASPAR_HEALTH.public.stg_steps (ID, EXTERNAL_ID, STEPS, SUBMISSION_TIME, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m11:48:22.277245 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.884 seconds
[0m11:48:22.278768 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:48:22.279412 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
COMMIT
[0m11:48:22.506132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.226 seconds
[0m11:48:22.551179 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:48:22.551699 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
BEGIN
[0m11:48:22.625856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m11:48:22.700005 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:48:22.700589 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
insert into CASPAR_HEALTH.public.stg_steps (ID, EXTERNAL_ID, STEPS, SUBMISSION_TIME, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m11:48:23.549582 [debug] [Thread-1 (]: SQL status: SUCCESS 1909 in 0.848 seconds
[0m11:48:23.550404 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:48:23.550785 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
COMMIT
[0m11:48:23.775324 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.224 seconds
[0m11:48:23.788002 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.caspar_health_technical_challenge.stg_steps"
[0m11:48:23.814367 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: Close
[0m11:48:23.987188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd2e10fe-1ff8-417b-92dd-e4e0ba730907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d34560>]}
[0m11:48:23.988157 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.stg_steps .................................... [[32mINSERT 11909[0m in 8.89s]
[0m11:48:23.989183 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_steps
[0m11:48:23.991609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:23.992565 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_steps' was properly closed.
[0m11:48:23.993094 [info ] [MainThread]: 
[0m11:48:23.993640 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.30 seconds (10.30s).
[0m11:48:23.994567 [debug] [MainThread]: Command end result
[0m11:48:24.031901 [info ] [MainThread]: 
[0m11:48:24.032841 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:48:24.033600 [info ] [MainThread]: 
[0m11:48:24.034243 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:48:24.034870 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 11.54237, "process_in_blocks": "0", "process_kernel_time": 0.715911, "process_mem_max_rss": "155930624", "process_out_blocks": "0", "process_user_time": 5.464667}
[0m11:48:24.035354 [debug] [MainThread]: Command `dbt seed` succeeded at 11:48:24.035252 after 11.54 seconds
[0m11:48:24.035740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac3f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b38590>]}
[0m11:48:24.036096 [debug] [MainThread]: Flushing usage events
[0m11:48:35.535173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdc7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c25c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c25c350>]}


============================== 11:48:35.545854 | 578af4e3-ad62-4c87-b74a-b09086799a73 ==============================
[0m11:48:35.545854 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:48:35.547284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --select stg_exercises', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:48:36.389448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '578af4e3-ad62-4c87-b74a-b09086799a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c25de80>]}
[0m11:48:36.450148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '578af4e3-ad62-4c87-b74a-b09086799a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bba79b0>]}
[0m11:48:36.452290 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:48:36.630722 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:48:36.852328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:48:36.852862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:48:36.858680 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m11:48:36.878055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '578af4e3-ad62-4c87-b74a-b09086799a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0bb2c0>]}
[0m11:48:36.965853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '578af4e3-ad62-4c87-b74a-b09086799a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf1ac60>]}
[0m11:48:36.966387 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m11:48:36.966938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '578af4e3-ad62-4c87-b74a-b09086799a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b140380>]}
[0m11:48:36.968596 [info ] [MainThread]: 
[0m11:48:36.969236 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:48:36.970354 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m11:48:36.987113 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m11:48:36.987572 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m11:48:36.988248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:37.673448 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.685 seconds
[0m11:48:37.676225 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m11:48:37.748905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m11:48:37.759480 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m11:48:37.760070 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m11:48:37.760437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:38.063817 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.303 seconds
[0m11:48:38.065997 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m11:48:38.140588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '578af4e3-ad62-4c87-b74a-b09086799a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2b3860>]}
[0m11:48:38.141848 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:48:38.142750 [info ] [MainThread]: 
[0m11:48:38.146540 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_exercises
[0m11:48:38.147244 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_exercises .................................... [RUN]
[0m11:48:38.147825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_exercises)
[0m11:48:38.148254 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_exercises
[0m11:48:38.148676 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_exercises
[0m11:48:38.158939 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:48:38.159592 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
show parameters like 'query_tag' in session
[0m11:48:38.160217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:48:38.434683 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.274 seconds
[0m11:48:38.436512 [debug] [Thread-1 (]: Setting query_tag to 'stg_exercises'. Will reset to '' after materialization.
[0m11:48:38.437706 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:48:38.438434 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
alter session set query_tag = 'stg_exercises'
[0m11:48:38.931755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.493 seconds
[0m11:48:43.424002 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:48:43.425808 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
BEGIN
[0m11:48:43.511043 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m11:48:43.511861 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:48:43.512403 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_EXERCISES"
  ;
[0m11:48:43.605848 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m11:48:43.606782 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:48:43.607450 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
COMMIT
[0m11:48:44.051717 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.444 seconds
[0m11:48:44.226822 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:48:44.227373 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
BEGIN
[0m11:48:44.290155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.062 seconds
[0m11:48:45.908267 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:48:45.908930 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
insert into CASPAR_HEALTH.public.stg_exercises (ID, EXTERNAL_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%...
[0m11:48:48.655645 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.746 seconds
[0m11:48:48.657293 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:48:48.658285 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
COMMIT
[0m11:48:48.867001 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m11:48:49.022477 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:48:49.023185 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
BEGIN
[0m11:48:49.580636 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.557 seconds
[0m11:48:51.212523 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:48:51.213409 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
insert into CASPAR_HEALTH.public.stg_exercises (ID, EXTERNAL_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%...
[0m11:48:54.191779 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.977 seconds
[0m11:48:54.193901 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:48:54.194464 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
COMMIT
[0m11:48:54.374214 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m11:48:54.522665 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:48:54.523243 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
BEGIN
[0m11:48:54.584677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.061 seconds
[0m11:48:56.088924 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:48:56.100420 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
insert into CASPAR_HEALTH.public.stg_exercises (ID, EXTERNAL_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%...
[0m11:48:58.632339 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.531 seconds
[0m11:48:58.633528 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:48:58.633938 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
COMMIT
[0m11:48:58.803389 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.169 seconds
[0m11:48:58.958085 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:48:58.958673 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
BEGIN
[0m11:48:59.054119 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.095 seconds
[0m11:49:00.556874 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:49:00.557472 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
insert into CASPAR_HEALTH.public.stg_exercises (ID, EXTERNAL_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%...
[0m11:49:03.206144 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.648 seconds
[0m11:49:03.208004 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:49:03.208701 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
COMMIT
[0m11:49:03.450204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.241 seconds
[0m11:49:03.597344 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:49:03.597892 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
BEGIN
[0m11:49:03.713910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m11:49:05.256566 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:49:05.257093 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
insert into CASPAR_HEALTH.public.stg_exercises (ID, EXTERNAL_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%...
[0m11:49:08.129014 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.871 seconds
[0m11:49:08.131019 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:49:08.131804 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
COMMIT
[0m11:49:08.349172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.217 seconds
[0m11:49:08.521651 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:49:08.522592 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
BEGIN
[0m11:49:08.594991 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m11:49:10.205246 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:49:10.206147 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
insert into CASPAR_HEALTH.public.stg_exercises (ID, EXTERNAL_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%...
[0m11:49:13.142472 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.936 seconds
[0m11:49:13.144504 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:49:13.145011 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
COMMIT
[0m11:49:13.415750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.270 seconds
[0m11:49:13.501946 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:49:13.502505 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
BEGIN
[0m11:49:13.599721 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m11:49:14.134941 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:49:14.135540 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
insert into CASPAR_HEALTH.public.stg_exercises (ID, EXTERNAL_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%...
[0m11:49:15.699972 [debug] [Thread-1 (]: SQL status: SUCCESS 5427 in 1.564 seconds
[0m11:49:15.701407 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:49:15.702221 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
COMMIT
[0m11:49:16.101466 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.398 seconds
[0m11:49:16.111841 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:49:16.143094 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: Close
[0m11:49:16.211747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '578af4e3-ad62-4c87-b74a-b09086799a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10968fa70>]}
[0m11:49:16.212856 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.stg_exercises ................................ [[32mINSERT 65427[0m in 38.06s]
[0m11:49:16.214479 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_exercises
[0m11:49:16.217472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:16.218270 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_exercises' was properly closed.
[0m11:49:16.219022 [info ] [MainThread]: 
[0m11:49:16.219800 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 39.25 seconds (39.25s).
[0m11:49:16.220879 [debug] [MainThread]: Command end result
[0m11:49:16.255976 [info ] [MainThread]: 
[0m11:49:16.256537 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:49:16.256905 [info ] [MainThread]: 
[0m11:49:16.257263 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:49:16.257982 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 40.848503, "process_in_blocks": "0", "process_kernel_time": 1.622767, "process_mem_max_rss": "284372992", "process_out_blocks": "0", "process_user_time": 18.830141}
[0m11:49:16.258557 [debug] [MainThread]: Command `dbt seed` succeeded at 11:49:16.258447 after 40.85 seconds
[0m11:49:16.259528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3ca270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b63b020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0a2ff0>]}
[0m11:49:16.260237 [debug] [MainThread]: Flushing usage events
[0m11:50:40.574461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfe630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d48a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d48830>]}


============================== 11:50:40.583063 | 8ae0dbb5-7364-4a70-8430-e8c6fdbddb94 ==============================
[0m11:50:40.583063 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:50:40.583755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --select stg_exercises', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:50:41.259483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ae0dbb5-7364-4a70-8430-e8c6fdbddb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109939c40>]}
[0m11:50:41.313535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ae0dbb5-7364-4a70-8430-e8c6fdbddb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109977e30>]}
[0m11:50:41.315976 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:50:41.466993 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:50:41.672772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:50:41.673216 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:50:41.678565 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m11:50:41.696261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ae0dbb5-7364-4a70-8430-e8c6fdbddb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b07d0>]}
[0m11:50:41.790479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ae0dbb5-7364-4a70-8430-e8c6fdbddb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a070b0>]}
[0m11:50:41.790979 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m11:50:41.791489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ae0dbb5-7364-4a70-8430-e8c6fdbddb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ccfc80>]}
[0m11:50:41.793023 [info ] [MainThread]: 
[0m11:50:41.793622 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:50:41.794623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m11:50:41.809764 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m11:50:41.810272 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m11:50:41.810629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:42.255161 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.444 seconds
[0m11:50:42.257824 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m11:50:42.352353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m11:50:42.364751 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m11:50:42.365274 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m11:50:42.365665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:50:42.698485 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.333 seconds
[0m11:50:42.701345 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m11:50:42.772081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ae0dbb5-7364-4a70-8430-e8c6fdbddb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1d250>]}
[0m11:50:42.773317 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:50:42.792254 [info ] [MainThread]: 
[0m11:50:42.796964 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_exercises
[0m11:50:42.813140 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_exercises .................................... [RUN]
[0m11:50:42.814516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_exercises)
[0m11:50:42.815296 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_exercises
[0m11:50:42.816078 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_exercises
[0m11:50:42.828488 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:50:42.829311 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
show parameters like 'query_tag' in session
[0m11:50:42.829978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:50:43.142353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.312 seconds
[0m11:50:43.144461 [debug] [Thread-1 (]: Setting query_tag to 'stg_exercises'. Will reset to '' after materialization.
[0m11:50:43.145380 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:50:43.145963 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
alter session set query_tag = 'stg_exercises'
[0m11:50:43.213191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.066 seconds
[0m11:50:47.493303 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:50:47.494269 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
BEGIN
[0m11:50:47.608843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m11:50:47.609494 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:50:47.609992 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_EXERCISES"
  ;
[0m11:50:47.797137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.187 seconds
[0m11:50:47.797822 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:50:47.798270 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
COMMIT
[0m11:50:47.973343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m11:50:48.134488 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:50:48.135168 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
BEGIN
[0m11:50:48.268605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m11:50:49.771951 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:50:49.772620 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
insert into CASPAR_HEALTH.public.stg_exercises (ID, EXTERNAL_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%...
[0m11:50:52.459983 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.687 seconds
[0m11:50:52.464205 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:50:52.464953 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
COMMIT
[0m11:50:52.875570 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m11:50:53.038549 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:50:53.039046 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
BEGIN
[0m11:50:53.119124 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.080 seconds
[0m11:50:54.568828 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:50:54.569510 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
insert into CASPAR_HEALTH.public.stg_exercises (ID, EXTERNAL_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%...
[0m11:50:56.983609 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.413 seconds
[0m11:50:56.985194 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:50:56.985944 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
COMMIT
[0m11:50:57.936706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.950 seconds
[0m11:50:58.095142 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:50:58.095660 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
BEGIN
[0m11:50:58.278335 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m11:50:59.739982 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:50:59.740510 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
insert into CASPAR_HEALTH.public.stg_exercises (ID, EXTERNAL_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%...
[0m11:51:03.661922 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 3.921 seconds
[0m11:51:03.663485 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:51:03.664218 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
COMMIT
[0m11:51:04.032339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.367 seconds
[0m11:51:04.245137 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:51:04.246013 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
BEGIN
[0m11:51:04.398383 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m11:51:06.452613 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:51:06.453284 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
insert into CASPAR_HEALTH.public.stg_exercises (ID, EXTERNAL_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%...
[0m11:51:09.073037 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.619 seconds
[0m11:51:09.075791 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:51:09.077071 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
COMMIT
[0m11:51:09.698822 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m11:51:09.880410 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:51:09.881145 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
BEGIN
[0m11:51:10.004166 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m11:51:11.779835 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:51:11.780633 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
insert into CASPAR_HEALTH.public.stg_exercises (ID, EXTERNAL_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%...
[0m11:51:15.338339 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 3.557 seconds
[0m11:51:15.339625 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:51:15.340153 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
COMMIT
[0m11:51:15.741687 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.401 seconds
[0m11:51:15.915875 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:51:15.916472 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
BEGIN
[0m11:51:16.206223 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.289 seconds
[0m11:51:17.772616 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:51:17.773207 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
insert into CASPAR_HEALTH.public.stg_exercises (ID, EXTERNAL_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%...
[0m11:51:20.529175 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 2.755 seconds
[0m11:51:20.530503 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:51:20.530942 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
COMMIT
[0m11:51:20.799453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.268 seconds
[0m11:51:20.886097 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:51:20.886719 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
BEGIN
[0m11:51:21.008309 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.121 seconds
[0m11:51:21.525935 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:51:21.526509 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
insert into CASPAR_HEALTH.public.stg_exercises (ID, EXTERNAL_ID, MINUTES, COMPLETED_AT, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%...
[0m11:51:23.079506 [debug] [Thread-1 (]: SQL status: SUCCESS 5427 in 1.552 seconds
[0m11:51:23.080945 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:51:23.081538 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_exercises"} */
COMMIT
[0m11:51:23.489778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m11:51:23.505141 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.caspar_health_technical_challenge.stg_exercises"
[0m11:51:23.558743 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_exercises: Close
[0m11:51:23.674426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ae0dbb5-7364-4a70-8430-e8c6fdbddb94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f838f0>]}
[0m11:51:23.675676 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.stg_exercises ................................ [[32mINSERT 65427[0m in 40.86s]
[0m11:51:23.676784 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_exercises
[0m11:51:23.678688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:23.679230 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_exercises' was properly closed.
[0m11:51:23.679756 [info ] [MainThread]: 
[0m11:51:23.680324 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 41.89 seconds (41.89s).
[0m11:51:23.681384 [debug] [MainThread]: Command end result
[0m11:51:23.717147 [info ] [MainThread]: 
[0m11:51:23.717901 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:23.718352 [info ] [MainThread]: 
[0m11:51:23.718774 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:51:23.719453 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 43.22481, "process_in_blocks": "0", "process_kernel_time": 1.530232, "process_mem_max_rss": "285773824", "process_out_blocks": "0", "process_user_time": 18.413874}
[0m11:51:23.720132 [debug] [MainThread]: Command `dbt seed` succeeded at 11:51:23.720010 after 43.23 seconds
[0m11:51:23.720550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bab260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfe630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf2270>]}
[0m11:51:23.720918 [debug] [MainThread]: Flushing usage events
[0m11:51:29.289827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10773c3e0>]}


============================== 11:51:29.296641 | 640aaf81-ce41-4c69-9b44-2ab892d03855 ==============================
[0m11:51:29.296641 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:51:29.297358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --select stg_steps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:51:29.855477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '640aaf81-ce41-4c69-9b44-2ab892d03855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f19d00>]}
[0m11:51:29.911783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '640aaf81-ce41-4c69-9b44-2ab892d03855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108133bc0>]}
[0m11:51:29.913859 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:51:30.072157 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:51:30.239516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:51:30.239957 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:51:30.245287 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
- models.caspar_health_technical_challenge.transform
[0m11:51:30.262073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '640aaf81-ce41-4c69-9b44-2ab892d03855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108387710>]}
[0m11:51:30.347297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '640aaf81-ce41-4c69-9b44-2ab892d03855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108529550>]}
[0m11:51:30.347821 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m11:51:30.348352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '640aaf81-ce41-4c69-9b44-2ab892d03855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082fef90>]}
[0m11:51:30.349905 [info ] [MainThread]: 
[0m11:51:30.350522 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:51:30.351583 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m11:51:30.367074 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m11:51:30.367534 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m11:51:30.367872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:30.854352 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.486 seconds
[0m11:51:30.856478 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m11:51:30.945540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m11:51:30.962135 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m11:51:30.963309 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m11:51:30.964052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:31.298375 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.334 seconds
[0m11:51:31.302814 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m11:51:31.420270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '640aaf81-ce41-4c69-9b44-2ab892d03855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a5c70>]}
[0m11:51:31.421348 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:31.422077 [info ] [MainThread]: 
[0m11:51:31.428798 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_steps
[0m11:51:31.429873 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_steps ........................................ [RUN]
[0m11:51:31.430961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_steps)
[0m11:51:31.432053 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_steps
[0m11:51:31.433066 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_steps
[0m11:51:31.450693 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:51:31.462213 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
show parameters like 'query_tag' in session
[0m11:51:31.463194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:31.938141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.475 seconds
[0m11:51:31.940803 [debug] [Thread-1 (]: Setting query_tag to 'stg_steps'. Will reset to '' after materialization.
[0m11:51:31.941732 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:51:31.942288 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
alter session set query_tag = 'stg_steps'
[0m11:51:32.006045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.063 seconds
[0m11:51:32.897528 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:51:32.898080 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
BEGIN
[0m11:51:32.992875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.094 seconds
[0m11:51:32.993998 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:51:32.995264 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_STEPS"
  ;
[0m11:51:33.195713 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.199 seconds
[0m11:51:33.196937 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:51:33.198077 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
COMMIT
[0m11:51:33.378025 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m11:51:33.554444 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:51:33.555027 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
BEGIN
[0m11:51:33.633313 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m11:51:36.048536 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:51:36.050431 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
insert into CASPAR_HEALTH.public.stg_steps (ID, EXTERNAL_ID, STEPS, SUBMISSION_TIME, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m11:51:39.256804 [debug] [Thread-1 (]: SQL status: SUCCESS 10000 in 3.205 seconds
[0m11:51:39.258847 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:51:39.259484 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
COMMIT
[0m11:51:39.505501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.245 seconds
[0m11:51:39.542522 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:51:39.543030 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
BEGIN
[0m11:51:39.618112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m11:51:39.690971 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:51:39.691846 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
insert into CASPAR_HEALTH.public.stg_steps (ID, EXTERNAL_ID, STEPS, SUBMISSION_TIME, UPDATED_AT) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m11:51:40.599386 [debug] [Thread-1 (]: SQL status: SUCCESS 1909 in 0.907 seconds
[0m11:51:40.603955 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_steps"
[0m11:51:40.605195 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_steps"} */
COMMIT
[0m11:51:40.868616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.263 seconds
[0m11:51:40.879759 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.caspar_health_technical_challenge.stg_steps"
[0m11:51:40.918936 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_steps: Close
[0m11:51:41.008333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '640aaf81-ce41-4c69-9b44-2ab892d03855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af3740>]}
[0m11:51:41.009672 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.stg_steps .................................... [[32mINSERT 11909[0m in 9.58s]
[0m11:51:41.011076 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_steps
[0m11:51:41.016703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:41.017335 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_steps' was properly closed.
[0m11:51:41.017860 [info ] [MainThread]: 
[0m11:51:41.018480 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.67 seconds (10.67s).
[0m11:51:41.019684 [debug] [MainThread]: Command end result
[0m11:51:41.080079 [info ] [MainThread]: 
[0m11:51:41.081961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:41.082766 [info ] [MainThread]: 
[0m11:51:41.083806 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:51:41.085454 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 11.873982, "process_in_blocks": "0", "process_kernel_time": 0.797514, "process_mem_max_rss": "156577792", "process_out_blocks": "0", "process_user_time": 5.516716}
[0m11:51:41.086641 [debug] [MainThread]: Command `dbt seed` succeeded at 11:51:41.086414 after 11.88 seconds
[0m11:51:41.087729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104af3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c7b30>]}
[0m11:51:41.088284 [debug] [MainThread]: Flushing usage events
[0m11:51:49.970149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc04590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbe7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc58500>]}


============================== 11:51:49.977488 | 9d27977c-a054-4119-a823-9327a07ac80b ==============================
[0m11:51:49.977488 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:51:49.978297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --select stg_patients', 'send_anonymous_usage_stats': 'True'}
[0m11:51:50.794547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d27977c-a054-4119-a823-9327a07ac80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc049e0>]}
[0m11:51:50.859381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d27977c-a054-4119-a823-9327a07ac80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5a45f0>]}
[0m11:51:50.861588 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:51:51.043955 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:51:51.245894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:51:51.246353 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:51:51.252232 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m11:51:51.270673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d27977c-a054-4119-a823-9327a07ac80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5f19a0>]}
[0m11:51:51.366027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d27977c-a054-4119-a823-9327a07ac80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d91fce0>]}
[0m11:51:51.366558 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m11:51:51.367100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d27977c-a054-4119-a823-9327a07ac80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da38b00>]}
[0m11:51:51.368628 [info ] [MainThread]: 
[0m11:51:51.369236 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:51:51.370094 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m11:51:51.385185 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m11:51:51.385668 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m11:51:51.386013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:51.871983 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.486 seconds
[0m11:51:51.876667 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m11:51:51.970167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m11:51:51.986915 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m11:51:51.987684 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m11:51:51.988125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:52.296942 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.309 seconds
[0m11:51:52.300202 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m11:51:52.375815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d27977c-a054-4119-a823-9327a07ac80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a24dbe0>]}
[0m11:51:52.377506 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:52.378332 [info ] [MainThread]: 
[0m11:51:52.383768 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m11:51:52.384810 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m11:51:52.385909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m11:51:52.386830 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m11:51:52.387646 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m11:51:52.400308 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:51:52.401351 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m11:51:52.402365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:52.687270 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.285 seconds
[0m11:51:52.689112 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m11:51:52.690213 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:51:52.690845 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m11:51:52.852248 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.161 seconds
[0m11:51:52.888529 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:51:52.889053 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m11:51:52.963052 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m11:51:52.963622 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:51:52.964005 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
truncate table "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS"
  ;
[0m11:51:53.087622 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m11:51:53.088232 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:51:53.088647 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
COMMIT
[0m11:51:53.378434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.289 seconds
[0m11:51:53.395717 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:51:53.396345 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m11:51:53.561274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.163 seconds
[0m11:51:53.567062 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:51:53.569542 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
insert into CASPAR_HEALTH.public.stg_patients (a, PATIENT_ID, first_name, last_name, country) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m11:51:53.707797 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a0ab-0203-b6af-0003-18c200014116
[0m11:51:53.709140 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 1 at position 47
invalid identifier 'A'
[0m11:51:53.710144 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m11:51:53.797540 [debug] [Thread-1 (]: Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier 'A'
[0m11:51:53.799888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d27977c-a054-4119-a823-9327a07ac80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3871d0>]}
[0m11:51:53.800648 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file public.stg_patients ............................. [[31mERROR[0m in 1.41s]
[0m11:51:53.801563 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m11:51:53.803995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:53.804659 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m11:51:53.805258 [info ] [MainThread]: 
[0m11:51:53.805998 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m11:51:53.807277 [debug] [MainThread]: Command end result
[0m11:51:53.849896 [info ] [MainThread]: 
[0m11:51:53.850938 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:51:53.851982 [info ] [MainThread]: 
[0m11:51:53.852911 [error] [MainThread]:   Database Error in seed stg_patients (seeds/stg_patients.csv)
  000904 (42000): SQL compilation error: error line 1 at position 47
  invalid identifier 'A'
[0m11:51:53.853413 [info ] [MainThread]: 
[0m11:51:53.854080 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:51:53.856162 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 3.9680965, "process_in_blocks": "0", "process_kernel_time": 0.583391, "process_mem_max_rss": "129835008", "process_out_blocks": "0", "process_user_time": 2.422505}
[0m11:51:53.856909 [debug] [MainThread]: Command `dbt seed` failed at 11:51:53.856773 after 3.97 seconds
[0m11:51:53.857400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be796a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5a5df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10decf7d0>]}
[0m11:51:53.857808 [debug] [MainThread]: Flushing usage events
[0m11:52:48.948698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1014664e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104468650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104468410>]}


============================== 11:52:48.956335 | bcd5427f-ddad-4367-b244-ada6d3664f7a ==============================
[0m11:52:48.956335 [info ] [MainThread]: Running with dbt=1.8.9
[0m11:52:48.957083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed --select stg_patients --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m11:52:49.622586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcd5427f-ddad-4367-b244-ada6d3664f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e67f50>]}
[0m11:52:49.681273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcd5427f-ddad-4367-b244-ada6d3664f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1017ef740>]}
[0m11:52:49.683762 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m11:52:49.849718 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m11:52:50.052862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:52:50.053312 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:52:50.059019 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.transform
- models.caspar_health_technical_challenge.analysis
[0m11:52:50.077440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcd5427f-ddad-4367-b244-ada6d3664f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052496d0>]}
[0m11:52:50.170035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcd5427f-ddad-4367-b244-ada6d3664f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef6cf0>]}
[0m11:52:50.170694 [info ] [MainThread]: Found 3 seeds, 577 macros
[0m11:52:50.171338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcd5427f-ddad-4367-b244-ada6d3664f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e900b0>]}
[0m11:52:50.173162 [info ] [MainThread]: 
[0m11:52:50.173956 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:52:50.174972 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m11:52:50.190864 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m11:52:50.191392 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m11:52:50.192133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:50.749984 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.558 seconds
[0m11:52:50.754393 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m11:52:50.837921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m11:52:50.865166 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m11:52:50.865845 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m11:52:50.866326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:51.182838 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.316 seconds
[0m11:52:51.186111 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m11:52:51.265800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcd5427f-ddad-4367-b244-ada6d3664f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10507ffb0>]}
[0m11:52:51.266807 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:52:51.267401 [info ] [MainThread]: 
[0m11:52:51.271967 [debug] [Thread-1 (]: Began running node seed.caspar_health_technical_challenge.stg_patients
[0m11:52:51.272883 [info ] [Thread-1 (]: 1 of 1 START seed file public.stg_patients ..................................... [RUN]
[0m11:52:51.273655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now seed.caspar_health_technical_challenge.stg_patients)
[0m11:52:51.274581 [debug] [Thread-1 (]: Began compiling node seed.caspar_health_technical_challenge.stg_patients
[0m11:52:51.275447 [debug] [Thread-1 (]: Began executing node seed.caspar_health_technical_challenge.stg_patients
[0m11:52:51.287737 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:52:51.288321 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
show parameters like 'query_tag' in session
[0m11:52:51.288755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:51.573462 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.285 seconds
[0m11:52:51.576075 [debug] [Thread-1 (]: Setting query_tag to 'stg_patients'. Will reset to '' after materialization.
[0m11:52:51.577385 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:52:51.578022 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
alter session set query_tag = 'stg_patients'
[0m11:52:51.663104 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m11:52:51.705002 [debug] [Thread-1 (]: Applying DROP to: "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS"
[0m11:52:51.711001 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:52:51.711506 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
drop table if exists "CASPAR_HEALTH"."PUBLIC"."STG_PATIENTS" cascade
[0m11:52:51.801678 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.090 seconds
[0m11:52:51.814233 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:52:51.814876 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
create table CASPAR_HEALTH.public.stg_patients (a integer,PATIENT_ID integer,first_name varchar(16777216),last_name varchar(16777216),country varchar(16777216))
[0m11:52:51.953743 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m11:52:51.973990 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:52:51.974517 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
BEGIN
[0m11:52:52.050430 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m11:52:52.054481 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:52:52.055019 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
insert into CASPAR_HEALTH.public.stg_patients (a, PATIENT_ID, first_name, last_name, country) values
            (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s...
[0m11:52:52.379210 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 0.323 seconds
[0m11:52:52.380744 [debug] [Thread-1 (]: Using snowflake connection "seed.caspar_health_technical_challenge.stg_patients"
[0m11:52:52.381837 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "seed.caspar_health_technical_challenge.stg_patients"} */
COMMIT
[0m11:52:52.584987 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.202 seconds
[0m11:52:52.593199 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.caspar_health_technical_challenge.stg_patients"
[0m11:52:52.626618 [debug] [Thread-1 (]: On seed.caspar_health_technical_challenge.stg_patients: Close
[0m11:52:52.702749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcd5427f-ddad-4367-b244-ada6d3664f7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e54f0>]}
[0m11:52:52.704440 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file public.stg_patients ................................. [[32mCREATE 100[0m in 1.43s]
[0m11:52:52.705888 [debug] [Thread-1 (]: Finished running node seed.caspar_health_technical_challenge.stg_patients
[0m11:52:52.709001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:52.709877 [debug] [MainThread]: Connection 'seed.caspar_health_technical_challenge.stg_patients' was properly closed.
[0m11:52:52.710648 [info ] [MainThread]: 
[0m11:52:52.711333 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m11:52:52.712645 [debug] [MainThread]: Command end result
[0m11:52:52.751673 [info ] [MainThread]: 
[0m11:52:52.752448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:52:52.752875 [info ] [MainThread]: 
[0m11:52:52.753581 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:52:52.754246 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.8961384, "process_in_blocks": "0", "process_kernel_time": 0.586368, "process_mem_max_rss": "128999424", "process_out_blocks": "0", "process_user_time": 2.533576}
[0m11:52:52.755145 [debug] [MainThread]: Command `dbt seed` succeeded at 11:52:52.754786 after 3.90 seconds
[0m11:52:52.755783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1018dc320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104468500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104468650>]}
[0m11:52:52.756318 [debug] [MainThread]: Flushing usage events
[0m12:12:09.545939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114bb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f74680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f74470>]}


============================== 12:12:09.573585 | 199b2cfc-b667-418a-babb-9eb58317ddd4 ==============================
[0m12:12:09.573585 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:12:09.575056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_steps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:12:11.057019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '199b2cfc-b667-418a-babb-9eb58317ddd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112972240>]}
[0m12:12:11.179726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '199b2cfc-b667-418a-babb-9eb58317ddd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129d60f0>]}
[0m12:12:11.182275 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:12:11.458553 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:12:11.818022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m12:12:11.818804 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://models/transform/dim_patients.sql
[0m12:12:11.819236 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://models/transform/fct_exercises.sql
[0m12:12:11.819832 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://models/transform/fct_steps.sql
[0m12:12:12.360215 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:12:12.369405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '199b2cfc-b667-418a-babb-9eb58317ddd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f78890>]}
[0m12:12:12.522258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '199b2cfc-b667-418a-babb-9eb58317ddd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113096fc0>]}
[0m12:12:12.523160 [info ] [MainThread]: Found 3 seeds, 3 models, 577 macros
[0m12:12:12.523761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '199b2cfc-b667-418a-babb-9eb58317ddd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125aa9f0>]}
[0m12:12:12.524737 [warn ] [MainThread]: The selection criterion 'dim_steps' does not match any enabled nodes
[0m12:12:12.526442 [info ] [MainThread]: 
[0m12:12:12.527013 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:12:12.529048 [debug] [MainThread]: Command end result
[0m12:12:12.584029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1680582, "process_in_blocks": "0", "process_kernel_time": 0.5898, "process_mem_max_rss": "119074816", "process_out_blocks": "0", "process_user_time": 2.575417}
[0m12:12:12.585809 [debug] [MainThread]: Command `dbt run` succeeded at 12:12:12.585356 after 3.17 seconds
[0m12:12:12.586656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114bb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b618b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a0a4b0>]}
[0m12:12:12.587353 [debug] [MainThread]: Flushing usage events
[0m12:12:34.877884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108beebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f38650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f38410>]}


============================== 12:12:34.885293 | 740cbb68-7971-4547-9d9c-032cc9e79a5e ==============================
[0m12:12:34.885293 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:12:34.885929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_steps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:12:35.536745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '740cbb68-7971-4547-9d9c-032cc9e79a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f38590>]}
[0m12:12:35.596427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '740cbb68-7971-4547-9d9c-032cc9e79a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d6330>]}
[0m12:12:35.598396 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:12:35.751800 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:12:35.944780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:12:35.945237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:12:35.950443 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:12:35.980342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '740cbb68-7971-4547-9d9c-032cc9e79a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b35790>]}
[0m12:12:36.082708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '740cbb68-7971-4547-9d9c-032cc9e79a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d587d0>]}
[0m12:12:36.083241 [info ] [MainThread]: Found 3 seeds, 3 models, 577 macros
[0m12:12:36.083631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '740cbb68-7971-4547-9d9c-032cc9e79a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d16e40>]}
[0m12:12:36.085340 [info ] [MainThread]: 
[0m12:12:36.085937 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:12:36.086801 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m12:12:36.101603 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m12:12:36.102182 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m12:12:36.102638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:36.648940 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.546 seconds
[0m12:12:36.652744 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m12:12:36.748949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now create_CASPAR_HEALTH_transform)
[0m12:12:36.751684 [debug] [ThreadPool]: Creating schema "database: "CASPAR_HEALTH"
schema: "transform"
"
[0m12:12:36.756943 [debug] [ThreadPool]: Using snowflake connection "create_CASPAR_HEALTH_transform"
[0m12:12:36.757328 [debug] [ThreadPool]: On create_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "create_CASPAR_HEALTH_transform"} */
create schema if not exists CASPAR_HEALTH.transform
[0m12:12:36.757683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:37.120386 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.363 seconds
[0m12:12:37.122227 [debug] [ThreadPool]: On create_CASPAR_HEALTH_transform: Close
[0m12:12:37.239687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_transform)
[0m12:12:37.250547 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m12:12:37.251092 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m12:12:37.251424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:37.670423 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.419 seconds
[0m12:12:37.673004 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m12:12:37.834198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m12:12:37.839797 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m12:12:37.840619 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m12:12:37.841331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:38.180501 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.339 seconds
[0m12:12:38.182331 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m12:12:38.263030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '740cbb68-7971-4547-9d9c-032cc9e79a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ec4b30>]}
[0m12:12:38.264149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:12:38.264846 [info ] [MainThread]: 
[0m12:12:38.270210 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_steps
[0m12:12:38.271273 [info ] [Thread-1 (]: 1 of 1 START sql view model transform.fct_steps ................................ [RUN]
[0m12:12:38.272167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.fct_steps)
[0m12:12:38.272842 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_steps
[0m12:12:38.284061 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_steps"
[0m12:12:38.285513 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_steps
[0m12:12:38.296405 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m12:12:38.296981 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
show parameters like 'query_tag' in session
[0m12:12:38.297598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:38.646110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.348 seconds
[0m12:12:38.647482 [debug] [Thread-1 (]: Setting query_tag to 'fct_steps'. Will reset to '' after materialization.
[0m12:12:38.648600 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m12:12:38.648990 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
alter session set query_tag = 'fct_steps'
[0m12:12:38.720730 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m12:12:38.749129 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_steps"
[0m12:12:38.752710 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m12:12:38.753126 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
create or replace   view CASPAR_HEALTH.transform.fct_steps
  
   as (
    SELECT
    ID,
    EXTERNAL_ID AS PATIENT_ID,
    STEPS,
    TRY_TO_TIMESTAMP_TZ(SUBMISSION_TIME, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS SUBMITTED_AT,
    TRY_TO_TIMESTAMP_TZ(SUBMISSION_TIME, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS UPDATED_AT
FROM ref('stg_steps')
  );
[0m12:12:38.871371 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a0c0-0203-b5f1-0003-18c20001611a
[0m12:12:38.872051 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 8 unexpected '('.
syntax error line 11 at position 2 unexpected ')'.
[0m12:12:38.872783 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: Close
[0m12:12:38.982705 [debug] [Thread-1 (]: Database Error in model fct_steps (models/transform/fct_steps.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 8 unexpected '('.
  syntax error line 11 at position 2 unexpected ')'.
  compiled code at target/run/caspar_health_technical_challenge/models/transform/fct_steps.sql
[0m12:12:38.985825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '740cbb68-7971-4547-9d9c-032cc9e79a5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10847b590>]}
[0m12:12:38.987085 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model transform.fct_steps ....................... [[31mERROR[0m in 0.71s]
[0m12:12:38.988274 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_steps
[0m12:12:38.991487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:38.992153 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.fct_steps' was properly closed.
[0m12:12:38.992761 [info ] [MainThread]: 
[0m12:12:38.993423 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m12:12:38.994579 [debug] [MainThread]: Command end result
[0m12:12:39.030059 [info ] [MainThread]: 
[0m12:12:39.030746 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:12:39.031159 [info ] [MainThread]: 
[0m12:12:39.031633 [error] [MainThread]:   Database Error in model fct_steps (models/transform/fct_steps.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 8 unexpected '('.
  syntax error line 11 at position 2 unexpected ')'.
  compiled code at target/run/caspar_health_technical_challenge/models/transform/fct_steps.sql
[0m12:12:39.032028 [info ] [MainThread]: 
[0m12:12:39.032430 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:12:39.033091 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.2378826, "process_in_blocks": "0", "process_kernel_time": 0.567135, "process_mem_max_rss": "131354624", "process_out_blocks": "0", "process_user_time": 2.491983}
[0m12:12:39.033994 [debug] [MainThread]: Command `dbt run` failed at 12:12:39.033835 after 4.24 seconds
[0m12:12:39.034596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f383e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108beebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637c920>]}
[0m12:12:39.035067 [debug] [MainThread]: Flushing usage events
[0m12:13:07.062380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d53830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108558470>]}


============================== 12:13:07.067460 | f6c67b59-c1bb-4a38-be52-ce60f475cf7a ==============================
[0m12:13:07.067460 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:13:07.068118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_steps', 'send_anonymous_usage_stats': 'True'}
[0m12:13:07.541494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6c67b59-c1bb-4a38-be52-ce60f475cf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8ddf0>]}
[0m12:13:07.600273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6c67b59-c1bb-4a38-be52-ce60f475cf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a9d00>]}
[0m12:13:07.601519 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:13:07.742709 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:13:07.910224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:13:07.910891 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/fct_steps.sql
[0m12:13:08.137985 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:13:08.143870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6c67b59-c1bb-4a38-be52-ce60f475cf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109665af0>]}
[0m12:13:08.250924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6c67b59-c1bb-4a38-be52-ce60f475cf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109338890>]}
[0m12:13:08.251561 [info ] [MainThread]: Found 3 seeds, 3 models, 577 macros
[0m12:13:08.251965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6c67b59-c1bb-4a38-be52-ce60f475cf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10946f110>]}
[0m12:13:08.253686 [info ] [MainThread]: 
[0m12:13:08.254421 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:13:08.255374 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m12:13:08.268234 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m12:13:08.268668 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m12:13:08.268987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:08.866376 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.597 seconds
[0m12:13:08.868147 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m12:13:08.945053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m12:13:08.956087 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m12:13:08.956612 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m12:13:08.956953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:09.325795 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.369 seconds
[0m12:13:09.328305 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m12:13:09.475750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m12:13:09.478223 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m12:13:09.478696 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m12:13:09.479063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:09.853548 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.374 seconds
[0m12:13:09.857434 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m12:13:09.932728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6c67b59-c1bb-4a38-be52-ce60f475cf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109195970>]}
[0m12:13:09.933958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:13:09.934614 [info ] [MainThread]: 
[0m12:13:09.938689 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_steps
[0m12:13:09.939578 [info ] [Thread-1 (]: 1 of 1 START sql view model transform.fct_steps ................................ [RUN]
[0m12:13:09.940354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.fct_steps)
[0m12:13:09.940955 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_steps
[0m12:13:09.951583 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_steps"
[0m12:13:09.952826 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_steps
[0m12:13:09.962786 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m12:13:09.963493 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
show parameters like 'query_tag' in session
[0m12:13:09.964330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:13:10.353416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m12:13:10.357365 [debug] [Thread-1 (]: Setting query_tag to 'fct_steps'. Will reset to '' after materialization.
[0m12:13:10.359067 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m12:13:10.360144 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
alter session set query_tag = 'fct_steps'
[0m12:13:10.420328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.059 seconds
[0m12:13:10.513717 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_steps"
[0m12:13:10.515191 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m12:13:10.515613 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
create or replace   view CASPAR_HEALTH.transform.fct_steps
  
   as (
    SELECT
    ID,
    EXTERNAL_ID AS PATIENT_ID,
    STEPS,
    TRY_TO_TIMESTAMP_TZ(SUBMISSION_TIME, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS SUBMITTED_AT,
    TRY_TO_TIMESTAMP_TZ(SUBMISSION_TIME, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS UPDATED_AT
FROM CASPAR_HEALTH.public.stg_steps
  );
[0m12:13:10.744241 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m12:13:10.766549 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: Close
[0m12:13:10.840093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6c67b59-c1bb-4a38-be52-ce60f475cf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e8f80>]}
[0m12:13:10.841175 [info ] [Thread-1 (]: 1 of 1 OK created sql view model transform.fct_steps ........................... [[32mSUCCESS 1[0m in 0.90s]
[0m12:13:10.842217 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_steps
[0m12:13:10.843892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:10.844366 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.fct_steps' was properly closed.
[0m12:13:10.844825 [info ] [MainThread]: 
[0m12:13:10.845301 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m12:13:10.846194 [debug] [MainThread]: Command end result
[0m12:13:10.898713 [info ] [MainThread]: 
[0m12:13:10.899435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:13:10.899870 [info ] [MainThread]: 
[0m12:13:10.900315 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:13:10.901012 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9077113, "process_in_blocks": "0", "process_kernel_time": 0.465891, "process_mem_max_rss": "131493888", "process_out_blocks": "0", "process_user_time": 2.557603}
[0m12:13:10.901591 [debug] [MainThread]: Command `dbt run` succeeded at 12:13:10.901470 after 3.91 seconds
[0m12:13:10.902046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094926c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093c8110>]}
[0m12:13:10.902471 [debug] [MainThread]: Flushing usage events
[0m12:14:50.186124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134f1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11383c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11383c4a0>]}


============================== 12:14:50.192923 | 2d3542c1-34d9-4194-8a50-5f8de0e72333 ==============================
[0m12:14:50.192923 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:14:50.193555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_exercises', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:14:50.869430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d3542c1-34d9-4194-8a50-5f8de0e72333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114049b80>]}
[0m12:14:50.935140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d3542c1-34d9-4194-8a50-5f8de0e72333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11401e330>]}
[0m12:14:50.937487 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:14:51.102043 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:14:51.345524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:14:51.346266 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:14:51.359621 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:14:51.411875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d3542c1-34d9-4194-8a50-5f8de0e72333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143b8a70>]}
[0m12:14:51.524218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d3542c1-34d9-4194-8a50-5f8de0e72333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11452a960>]}
[0m12:14:51.524761 [info ] [MainThread]: Found 3 seeds, 3 models, 577 macros
[0m12:14:51.525146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d3542c1-34d9-4194-8a50-5f8de0e72333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11355edb0>]}
[0m12:14:51.525908 [warn ] [MainThread]: The selection criterion 'fct_exercises' does not match any enabled nodes
[0m12:14:51.527779 [info ] [MainThread]: 
[0m12:14:51.528557 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:14:51.530617 [debug] [MainThread]: Command end result
[0m12:14:51.558696 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4557805, "process_in_blocks": "0", "process_kernel_time": 0.495403, "process_mem_max_rss": "121229312", "process_out_blocks": "0", "process_user_time": 2.068823}
[0m12:14:51.559416 [debug] [MainThread]: Command `dbt run` succeeded at 12:14:51.559303 after 1.46 seconds
[0m12:14:51.559960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134f1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11326a3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d1a2a0>]}
[0m12:14:51.560518 [debug] [MainThread]: Flushing usage events
[0m12:20:51.497844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c7f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f58650>]}


============================== 12:20:51.504900 | 8bcd679b-7319-49ea-a0d9-e42b0979e41e ==============================
[0m12:20:51.504900 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:20:51.505532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_exercises', 'send_anonymous_usage_stats': 'True'}
[0m12:20:52.169965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bcd679b-7319-49ea-a0d9-e42b0979e41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f05dc0>]}
[0m12:20:52.224225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bcd679b-7319-49ea-a0d9-e42b0979e41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dafb00>]}
[0m12:20:52.226412 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:20:52.380970 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:20:52.597769 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
[0m12:20:52.598539 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/fct_exercises.sql
[0m12:20:52.598951 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/dim_patients.sql
[0m12:20:52.928904 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:20:52.934939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bcd679b-7319-49ea-a0d9-e42b0979e41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a04d0>]}
[0m12:20:53.060385 [error] [MainThread]: Encountered an error:
Found a cycle: model.caspar_health_technical_challenge.dim_patients
[0m12:20:53.067421 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 506, in run
    self._runtime_initialize()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/compile.py", line 125, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.compile_manifest()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/base.py", line 145, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/compilation.py", line 449, in compile
    linker.link_graph(manifest)
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/compilation.py", line 192, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.caspar_health_technical_challenge.dim_patients

[0m12:20:53.069910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6704577, "process_in_blocks": "0", "process_kernel_time": 0.504527, "process_mem_max_rss": "126414848", "process_out_blocks": "0", "process_user_time": 2.250973}
[0m12:20:53.070686 [debug] [MainThread]: Command `dbt run` failed at 12:20:53.070511 after 1.67 seconds
[0m12:20:53.071411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac02f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c0200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d4950>]}
[0m12:20:53.072089 [debug] [MainThread]: Flushing usage events
[0m12:21:30.093532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056a2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105958860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105958620>]}


============================== 12:21:30.099058 | 3b98f6b4-92f1-4a28-8315-c62058c11635 ==============================
[0m12:21:30.099058 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:21:30.099726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_exercises', 'send_anonymous_usage_stats': 'True'}
[0m12:21:30.556863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b98f6b4-92f1-4a28-8315-c62058c11635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105959eb0>]}
[0m12:21:30.611623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b98f6b4-92f1-4a28-8315-c62058c11635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a80b0>]}
[0m12:21:30.612804 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:21:30.745088 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:21:30.869991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:21:30.870431 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:21:30.875684 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:21:30.907398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b98f6b4-92f1-4a28-8315-c62058c11635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661f9b0>]}
[0m12:21:30.996619 [error] [MainThread]: Encountered an error:
Found a cycle: model.caspar_health_technical_challenge.dim_patients
[0m12:21:30.999626 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 506, in run
    self._runtime_initialize()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/compile.py", line 125, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.compile_manifest()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/base.py", line 145, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/compilation.py", line 449, in compile
    linker.link_graph(manifest)
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/compilation.py", line 192, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.caspar_health_technical_challenge.dim_patients

[0m12:21:31.001281 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9763523, "process_in_blocks": "0", "process_kernel_time": 0.369848, "process_mem_max_rss": "120758272", "process_out_blocks": "0", "process_user_time": 1.876482}
[0m12:21:31.001881 [debug] [MainThread]: Command `dbt run` failed at 12:21:31.001768 after 0.98 seconds
[0m12:21:31.002286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059583b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dff80>]}
[0m12:21:31.002636 [debug] [MainThread]: Flushing usage events
[0m12:21:47.391910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c3af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057587d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105758590>]}


============================== 12:21:47.397722 | d4c5891d-0cb0-4661-881a-f0e8a90bd40f ==============================
[0m12:21:47.397722 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:21:47.398422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_exercises', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:21:47.895371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4c5891d-0cb0-4661-881a-f0e8a90bd40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106367200>]}
[0m12:21:47.961972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4c5891d-0cb0-4661-881a-f0e8a90bd40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106179970>]}
[0m12:21:47.963477 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:21:48.102161 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:21:48.234807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:21:48.235499 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://seeds/properties.yml
[0m12:21:48.312290 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:21:48.318376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4c5891d-0cb0-4661-881a-f0e8a90bd40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063080e0>]}
[0m12:21:48.414312 [error] [MainThread]: Encountered an error:
Found a cycle: model.caspar_health_technical_challenge.dim_patients
[0m12:21:48.417080 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 506, in run
    self._runtime_initialize()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/compile.py", line 125, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.compile_manifest()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/base.py", line 145, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/compilation.py", line 449, in compile
    linker.link_graph(manifest)
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/compilation.py", line 192, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.caspar_health_technical_challenge.dim_patients

[0m12:21:48.419080 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1063058, "process_in_blocks": "0", "process_kernel_time": 0.399475, "process_mem_max_rss": "121344000", "process_out_blocks": "0", "process_user_time": 2.066866}
[0m12:21:48.419727 [debug] [MainThread]: Command `dbt run` failed at 12:21:48.419613 after 1.11 seconds
[0m12:21:48.420154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106538740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a8890>]}
[0m12:21:48.420511 [debug] [MainThread]: Flushing usage events
[0m12:22:04.306064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110588fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110838920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108385f0>]}


============================== 12:22:04.311509 | 6478c041-04b9-4181-a522-7f84d7ab7e86 ==============================
[0m12:22:04.311509 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:22:04.312458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_patients', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:22:04.810092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6478c041-04b9-4181-a522-7f84d7ab7e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113b5c10>]}
[0m12:22:04.881710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6478c041-04b9-4181-a522-7f84d7ab7e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107bfd40>]}
[0m12:22:04.883231 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:22:05.038628 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:22:05.178616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:22:05.179059 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:22:05.184465 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:22:05.214346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6478c041-04b9-4181-a522-7f84d7ab7e86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114665d0>]}
[0m12:22:05.304364 [error] [MainThread]: Encountered an error:
Found a cycle: model.caspar_health_technical_challenge.dim_patients
[0m12:22:05.306566 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 506, in run
    self._runtime_initialize()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/compile.py", line 125, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.compile_manifest()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/base.py", line 145, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/compilation.py", line 449, in compile
    linker.link_graph(manifest)
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/compilation.py", line 192, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.caspar_health_technical_challenge.dim_patients

[0m12:22:05.307827 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0819968, "process_in_blocks": "0", "process_kernel_time": 0.408681, "process_mem_max_rss": "122167296", "process_out_blocks": "0", "process_user_time": 2.050228}
[0m12:22:05.308402 [debug] [MainThread]: Command `dbt run` failed at 12:22:05.308288 after 1.08 seconds
[0m12:22:05.308805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102b7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111655250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c412e0>]}
[0m12:22:05.309152 [debug] [MainThread]: Flushing usage events
[0m12:22:49.516189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fee8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11303c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11303c500>]}


============================== 12:22:49.524222 | 924faaa2-08a6-4a96-b3f7-96f0d2e10f25 ==============================
[0m12:22:49.524222 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:22:49.525509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_patients', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:22:50.336847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '924faaa2-08a6-4a96-b3f7-96f0d2e10f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a6e240>]}
[0m12:22:50.420006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '924faaa2-08a6-4a96-b3f7-96f0d2e10f25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b11a00>]}
[0m12:22:50.422721 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:22:50.577772 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:22:50.794924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m12:22:50.795702 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/dim_patients.sql
[0m12:22:50.796209 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/fct_steps.sql
[0m12:22:50.796614 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/fct_exercises.sql
[0m12:22:51.007005 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_patients (models/transform/dim_patients.sql)
  source() takes exactly two arguments (1 given)
[0m12:22:51.008486 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5817738, "process_in_blocks": "0", "process_kernel_time": 0.580148, "process_mem_max_rss": "120954880", "process_out_blocks": "0", "process_user_time": 2.32029}
[0m12:22:51.009178 [debug] [MainThread]: Command `dbt run` failed at 12:22:51.009061 after 1.58 seconds
[0m12:22:51.009638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fc38c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fc3d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fd5580>]}
[0m12:22:51.010097 [debug] [MainThread]: Flushing usage events
[0m12:24:14.480664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b11e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0c7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1345f0>]}


============================== 12:24:14.488371 | 50aebcc0-b085-44ea-a13d-dc9e0687efcc ==============================
[0m12:24:14.488371 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:24:14.489084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_patients', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:24:15.168731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50aebcc0-b085-44ea-a13d-dc9e0687efcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab21310>]}
[0m12:24:15.222004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50aebcc0-b085-44ea-a13d-dc9e0687efcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea39370>]}
[0m12:24:15.224725 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:24:15.379123 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:24:15.599000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:24:15.599455 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:24:15.604689 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:24:15.635891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50aebcc0-b085-44ea-a13d-dc9e0687efcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6a7e00>]}
[0m12:24:15.746184 [error] [MainThread]: Encountered an error:
Found a cycle: model.caspar_health_technical_challenge.dim_patients
[0m12:24:15.752816 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 506, in run
    self._runtime_initialize()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/compile.py", line 125, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.compile_manifest()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/base.py", line 145, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/compilation.py", line 449, in compile
    linker.link_graph(manifest)
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/compilation.py", line 192, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.caspar_health_technical_challenge.dim_patients

[0m12:24:15.754661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.358126, "process_in_blocks": "0", "process_kernel_time": 0.500872, "process_mem_max_rss": "120913920", "process_out_blocks": "0", "process_user_time": 1.968837}
[0m12:24:15.755584 [debug] [MainThread]: Command `dbt run` failed at 12:24:15.755429 after 1.36 seconds
[0m12:24:15.756356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de5faa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0d5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0e4380>]}
[0m12:24:15.756953 [debug] [MainThread]: Flushing usage events
[0m12:24:39.661168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114204ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141e7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142585c0>]}


============================== 12:24:39.668866 | 435586c0-f574-45ac-b151-48ec5368d70c ==============================
[0m12:24:39.668866 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:24:39.669729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_exercises', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:24:40.290009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '435586c0-f574-45ac-b151-48ec5368d70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116c0770>]}
[0m12:24:40.344220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '435586c0-f574-45ac-b151-48ec5368d70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146861b0>]}
[0m12:24:40.346511 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:24:40.494297 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:24:40.700697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:24:40.701134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:24:40.706496 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:24:40.740710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '435586c0-f574-45ac-b151-48ec5368d70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11425a420>]}
[0m12:24:40.852620 [error] [MainThread]: Encountered an error:
Found a cycle: model.caspar_health_technical_challenge.dim_patients
[0m12:24:40.859236 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 506, in run
    self._runtime_initialize()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/compile.py", line 125, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.compile_manifest()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/base.py", line 145, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/compilation.py", line 449, in compile
    linker.link_graph(manifest)
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/compilation.py", line 192, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.caspar_health_technical_challenge.dim_patients

[0m12:24:40.861845 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2898318, "process_in_blocks": "0", "process_kernel_time": 0.476292, "process_mem_max_rss": "121540608", "process_out_blocks": "0", "process_user_time": 1.992836}
[0m12:24:40.862631 [debug] [MainThread]: Command `dbt run` failed at 12:24:40.862488 after 1.29 seconds
[0m12:24:40.863154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bd1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114228e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e93890>]}
[0m12:24:40.863587 [debug] [MainThread]: Flushing usage events
[0m12:24:47.202908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f74740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f74500>]}


============================== 12:24:47.208436 | 42adc7c2-e7f3-4b35-9e6d-ae5f7ccfe136 ==============================
[0m12:24:47.208436 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:24:47.209118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_steps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:24:47.985408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42adc7c2-e7f3-4b35-9e6d-ae5f7ccfe136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108939d30>]}
[0m12:24:48.046097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42adc7c2-e7f3-4b35-9e6d-ae5f7ccfe136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a73b0>]}
[0m12:24:48.047586 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:24:48.197029 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:24:48.468492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:24:48.469055 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:24:48.481608 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:24:48.547447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42adc7c2-e7f3-4b35-9e6d-ae5f7ccfe136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a79130>]}
[0m12:24:48.685327 [error] [MainThread]: Encountered an error:
Found a cycle: model.caspar_health_technical_challenge.dim_patients
[0m12:24:48.695155 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 506, in run
    self._runtime_initialize()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/compile.py", line 125, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.compile_manifest()
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/base.py", line 145, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/compilation.py", line 449, in compile
    linker.link_graph(manifest)
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/compilation.py", line 192, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.caspar_health_technical_challenge.dim_patients

[0m12:24:48.699945 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5735042, "process_in_blocks": "0", "process_kernel_time": 0.479027, "process_mem_max_rss": "121593856", "process_out_blocks": "0", "process_user_time": 2.159963}
[0m12:24:48.701432 [debug] [MainThread]: Command `dbt run` failed at 12:24:48.701187 after 1.58 seconds
[0m12:24:48.702638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c9ecc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d55a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f07bf0>]}
[0m12:24:48.703797 [debug] [MainThread]: Flushing usage events
[0m12:25:17.598975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1019816d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105148800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051485f0>]}


============================== 12:25:17.604851 | b72d7fd7-a9b5-405d-93d4-a269e2967a0b ==============================
[0m12:25:17.604851 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:25:17.605599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_steps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:25:18.123928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b72d7fd7-a9b5-405d-93d4-a269e2967a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105149fa0>]}
[0m12:25:18.186621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b72d7fd7-a9b5-405d-93d4-a269e2967a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055aa7e0>]}
[0m12:25:18.188048 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:25:18.337209 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:25:18.543924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:25:18.544586 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/dim_patients.sql
[0m12:25:18.792371 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:25:18.797937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b72d7fd7-a9b5-405d-93d4-a269e2967a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10626ddc0>]}
[0m12:25:18.907066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b72d7fd7-a9b5-405d-93d4-a269e2967a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f25760>]}
[0m12:25:18.907619 [info ] [MainThread]: Found 3 seeds, 3 models, 577 macros
[0m12:25:18.907997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b72d7fd7-a9b5-405d-93d4-a269e2967a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514a270>]}
[0m12:25:18.909652 [info ] [MainThread]: 
[0m12:25:18.910250 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:25:18.911105 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m12:25:18.924703 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m12:25:18.925162 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m12:25:18.925485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:19.917612 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.992 seconds
[0m12:25:19.920505 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m12:25:20.018879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m12:25:20.031239 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m12:25:20.031800 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m12:25:20.032212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:20.949907 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.918 seconds
[0m12:25:20.954037 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m12:25:21.090103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m12:25:21.096683 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m12:25:21.097517 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m12:25:21.098065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:21.560579 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.462 seconds
[0m12:25:21.563662 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m12:25:21.718531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b72d7fd7-a9b5-405d-93d4-a269e2967a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c970b0>]}
[0m12:25:21.720808 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:21.721729 [info ] [MainThread]: 
[0m12:25:21.727281 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_steps
[0m12:25:21.728404 [info ] [Thread-1 (]: 1 of 1 START sql view model transform.fct_steps ................................ [RUN]
[0m12:25:21.729447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.fct_steps)
[0m12:25:21.730155 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_steps
[0m12:25:21.741040 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_steps"
[0m12:25:21.743851 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_steps
[0m12:25:21.754671 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m12:25:21.755192 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
show parameters like 'query_tag' in session
[0m12:25:21.755558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:22.287516 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.532 seconds
[0m12:25:22.289795 [debug] [Thread-1 (]: Setting query_tag to 'fct_steps'. Will reset to '' after materialization.
[0m12:25:22.292463 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m12:25:22.293086 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
alter session set query_tag = 'fct_steps'
[0m12:25:22.394353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.101 seconds
[0m12:25:22.486004 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_steps"
[0m12:25:22.487765 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m12:25:22.488207 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
create or replace   view CASPAR_HEALTH.transform.fct_steps
  
   as (
    SELECT
    ID,
    EXTERNAL_ID AS PATIENT_ID,
    STEPS,
    TRY_TO_TIMESTAMP_TZ(SUBMISSION_TIME, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS SUBMITTED_AT,
    TRY_TO_TIMESTAMP_TZ(SUBMISSION_TIME, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS UPDATED_AT
FROM CASPAR_HEALTH.public.stg_steps
  );
[0m12:25:23.195537 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m12:25:23.232304 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: Close
[0m12:25:23.390184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b72d7fd7-a9b5-405d-93d4-a269e2967a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f99c10>]}
[0m12:25:23.391194 [info ] [Thread-1 (]: 1 of 1 OK created sql view model transform.fct_steps ........................... [[32mSUCCESS 1[0m in 1.66s]
[0m12:25:23.391996 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_steps
[0m12:25:23.393505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:23.393937 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.fct_steps' was properly closed.
[0m12:25:23.394347 [info ] [MainThread]: 
[0m12:25:23.394782 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m12:25:23.395593 [debug] [MainThread]: Command end result
[0m12:25:23.431191 [info ] [MainThread]: 
[0m12:25:23.431727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:25:23.432070 [info ] [MainThread]: 
[0m12:25:23.432407 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:25:23.433023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9155083, "process_in_blocks": "0", "process_kernel_time": 0.483385, "process_mem_max_rss": "132337664", "process_out_blocks": "0", "process_user_time": 2.671567}
[0m12:25:23.433822 [debug] [MainThread]: Command `dbt run` succeeded at 12:25:23.433460 after 5.92 seconds
[0m12:25:23.434774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b32c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e98380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c24170>]}
[0m12:25:23.435435 [debug] [MainThread]: Flushing usage events
[0m12:25:30.886881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccd05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d338620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3383e0>]}


============================== 12:25:30.896574 | 122158eb-bab0-4673-ad3f-6e46090c1ad0 ==============================
[0m12:25:30.896574 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:25:30.897308 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select fct_exercises', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:25:31.559858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '122158eb-bab0-4673-ad3f-6e46090c1ad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de44e00>]}
[0m12:25:31.634272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '122158eb-bab0-4673-ad3f-6e46090c1ad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de45760>]}
[0m12:25:31.636292 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:25:31.805016 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:25:32.006460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:32.006989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:32.013584 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:25:32.050828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '122158eb-bab0-4673-ad3f-6e46090c1ad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10defc2f0>]}
[0m12:25:32.146561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '122158eb-bab0-4673-ad3f-6e46090c1ad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0fdc70>]}
[0m12:25:32.147069 [info ] [MainThread]: Found 3 seeds, 3 models, 577 macros
[0m12:25:32.147422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '122158eb-bab0-4673-ad3f-6e46090c1ad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de13dd0>]}
[0m12:25:32.149110 [info ] [MainThread]: 
[0m12:25:32.149712 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:25:32.150662 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m12:25:32.165272 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m12:25:32.165756 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m12:25:32.166087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:32.644688 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.478 seconds
[0m12:25:32.647793 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m12:25:32.791688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m12:25:32.803677 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m12:25:32.804215 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m12:25:32.804596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:33.334770 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.530 seconds
[0m12:25:33.337585 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m12:25:33.472428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m12:25:33.477288 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m12:25:33.477915 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m12:25:33.478364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:33.855815 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.377 seconds
[0m12:25:33.858991 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m12:25:33.937372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '122158eb-bab0-4673-ad3f-6e46090c1ad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e117500>]}
[0m12:25:33.938332 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:33.939092 [info ] [MainThread]: 
[0m12:25:33.944184 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_exercises
[0m12:25:33.944979 [info ] [Thread-1 (]: 1 of 1 START sql view model transform.fct_exercises ............................ [RUN]
[0m12:25:33.945624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.fct_exercises)
[0m12:25:33.946093 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_exercises
[0m12:25:33.955674 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_exercises"
[0m12:25:33.957042 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_exercises
[0m12:25:33.967460 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m12:25:33.984971 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
show parameters like 'query_tag' in session
[0m12:25:33.985583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:34.291290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.306 seconds
[0m12:25:34.293630 [debug] [Thread-1 (]: Setting query_tag to 'fct_exercises'. Will reset to '' after materialization.
[0m12:25:34.294652 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m12:25:34.295300 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
alter session set query_tag = 'fct_exercises'
[0m12:25:34.463409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.167 seconds
[0m12:25:34.492575 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_exercises"
[0m12:25:34.494054 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m12:25:34.494456 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
create or replace   view CASPAR_HEALTH.transform.fct_exercises
  
   as (
    SELECT
    ID,
    EXTERNAL_ID AS PATIENT_ID,
    MINUTES,
    COMPLETED_AT::TIMESTAMP_TZ AS COMPLETED_AT,
    UPDATED_AT::TIMESTAMP_TZ AS UPDATED_AT
FROM CASPAR_HEALTH.public.stg_exercises
  );
[0m12:25:34.863521 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.368 seconds
[0m12:25:34.894099 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: Close
[0m12:25:35.019914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '122158eb-bab0-4673-ad3f-6e46090c1ad0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd5acf0>]}
[0m12:25:35.021133 [info ] [Thread-1 (]: 1 of 1 OK created sql view model transform.fct_exercises ....................... [[32mSUCCESS 1[0m in 1.07s]
[0m12:25:35.022132 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_exercises
[0m12:25:35.024125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:35.024678 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.fct_exercises' was properly closed.
[0m12:25:35.025157 [info ] [MainThread]: 
[0m12:25:35.025663 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m12:25:35.026580 [debug] [MainThread]: Command end result
[0m12:25:35.061191 [info ] [MainThread]: 
[0m12:25:35.061709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:25:35.062272 [info ] [MainThread]: 
[0m12:25:35.063161 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:25:35.064466 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.2580886, "process_in_blocks": "0", "process_kernel_time": 0.498174, "process_mem_max_rss": "130326528", "process_out_blocks": "0", "process_user_time": 2.471719}
[0m12:25:35.065567 [debug] [MainThread]: Command `dbt run` succeeded at 12:25:35.065400 after 4.26 seconds
[0m12:25:35.066046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3383b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccd05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd33ec0>]}
[0m12:25:35.066433 [debug] [MainThread]: Flushing usage events
[0m12:25:44.080840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104320e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107938920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079386e0>]}


============================== 12:25:44.086284 | 6d3bf33c-4694-42b1-865d-28895db6c8eb ==============================
[0m12:25:44.086284 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:25:44.087072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_patients', 'send_anonymous_usage_stats': 'True'}
[0m12:25:44.637517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d3bf33c-4694-42b1-865d-28895db6c8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1ca10>]}
[0m12:25:44.698587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d3bf33c-4694-42b1-865d-28895db6c8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108475d00>]}
[0m12:25:44.700034 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:25:44.856889 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:25:45.010798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:45.011315 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:45.017580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:25:45.049052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d3bf33c-4694-42b1-865d-28895db6c8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a0830>]}
[0m12:25:45.141747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d3bf33c-4694-42b1-865d-28895db6c8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ff8f0>]}
[0m12:25:45.142291 [info ] [MainThread]: Found 3 seeds, 3 models, 577 macros
[0m12:25:45.142666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d3bf33c-4694-42b1-865d-28895db6c8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed9880>]}
[0m12:25:45.144404 [info ] [MainThread]: 
[0m12:25:45.145237 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:25:45.146489 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m12:25:45.161643 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m12:25:45.162127 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m12:25:45.162533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:46.109317 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.947 seconds
[0m12:25:46.129375 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m12:25:46.218543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m12:25:46.232210 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m12:25:46.232747 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m12:25:46.233084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:46.617170 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.384 seconds
[0m12:25:46.621401 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m12:25:46.750875 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m12:25:46.757859 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m12:25:46.758643 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m12:25:46.759239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:25:47.569800 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.810 seconds
[0m12:25:47.574162 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m12:25:47.661505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d3bf33c-4694-42b1-865d-28895db6c8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086fe870>]}
[0m12:25:47.663131 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:25:47.664163 [info ] [MainThread]: 
[0m12:25:47.668262 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.dim_patients
[0m12:25:47.669453 [info ] [Thread-1 (]: 1 of 1 START sql view model transform.dim_patients ............................. [RUN]
[0m12:25:47.670505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.dim_patients)
[0m12:25:47.671323 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.dim_patients
[0m12:25:47.685440 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.dim_patients"
[0m12:25:47.687236 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.dim_patients
[0m12:25:47.698944 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m12:25:47.699464 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
show parameters like 'query_tag' in session
[0m12:25:47.699849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:25:47.997287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.297 seconds
[0m12:25:48.000223 [debug] [Thread-1 (]: Setting query_tag to 'dim_patients'. Will reset to '' after materialization.
[0m12:25:48.001596 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m12:25:48.002308 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
alter session set query_tag = 'dim_patients'
[0m12:25:48.105750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m12:25:48.140940 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.dim_patients"
[0m12:25:48.142354 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m12:25:48.142794 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
create or replace   view CASPAR_HEALTH.transform.dim_patients
  
   as (
    SELECT
    ID,
    FIRST_NAME,
    LAST_NAME,
    COUNTRY
FROM CASPAR_HEALTH.public.stg_patients
  );
[0m12:25:48.281587 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a0cd-0203-b6af-0003-18c20001417e
[0m12:25:48.282352 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 4
invalid identifier 'ID'
[0m12:25:48.283187 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: Close
[0m12:25:48.369981 [debug] [Thread-1 (]: Database Error in model dim_patients (models/transform/dim_patients.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'ID'
  compiled code at target/run/caspar_health_technical_challenge/models/transform/dim_patients.sql
[0m12:25:48.372405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d3bf33c-4694-42b1-865d-28895db6c8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a0740>]}
[0m12:25:48.373407 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model transform.dim_patients .................... [[31mERROR[0m in 0.70s]
[0m12:25:48.374427 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.dim_patients
[0m12:25:48.377302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:48.377827 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.dim_patients' was properly closed.
[0m12:25:48.378314 [info ] [MainThread]: 
[0m12:25:48.378886 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m12:25:48.379857 [debug] [MainThread]: Command end result
[0m12:25:48.413238 [info ] [MainThread]: 
[0m12:25:48.414021 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:25:48.414421 [info ] [MainThread]: 
[0m12:25:48.414909 [error] [MainThread]:   Database Error in model dim_patients (models/transform/dim_patients.sql)
  000904 (42000): SQL compilation error: error line 5 at position 4
  invalid identifier 'ID'
  compiled code at target/run/caspar_health_technical_challenge/models/transform/dim_patients.sql
[0m12:25:48.415212 [info ] [MainThread]: 
[0m12:25:48.415530 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:25:48.416262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.413566, "process_in_blocks": "0", "process_kernel_time": 0.487027, "process_mem_max_rss": "129884160", "process_out_blocks": "0", "process_user_time": 2.520518}
[0m12:25:48.416928 [debug] [MainThread]: Command `dbt run` failed at 12:25:48.416799 after 4.41 seconds
[0m12:25:48.417447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073498e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea4050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104320e00>]}
[0m12:25:48.417925 [debug] [MainThread]: Flushing usage events
[0m12:26:10.197512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce63470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e340710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e340500>]}


============================== 12:26:10.205002 | f52af04e-a7f2-4627-a626-26565ddecb64 ==============================
[0m12:26:10.205002 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:26:10.206046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_patients', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:26:10.933289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f52af04e-a7f2-4627-a626-26565ddecb64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec154f0>]}
[0m12:26:10.993231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f52af04e-a7f2-4627-a626-26565ddecb64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd6de80>]}
[0m12:26:10.995426 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:26:11.181616 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:26:11.433222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:26:11.433904 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/dim_patients.sql
[0m12:26:11.757710 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:26:11.763649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f52af04e-a7f2-4627-a626-26565ddecb64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeebec0>]}
[0m12:26:11.883384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f52af04e-a7f2-4627-a626-26565ddecb64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f028410>]}
[0m12:26:11.883945 [info ] [MainThread]: Found 3 seeds, 3 models, 577 macros
[0m12:26:11.884318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f52af04e-a7f2-4627-a626-26565ddecb64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f36a960>]}
[0m12:26:11.885967 [info ] [MainThread]: 
[0m12:26:11.886589 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:26:11.887451 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m12:26:11.902158 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m12:26:11.902707 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m12:26:11.903048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:12.456357 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.553 seconds
[0m12:26:12.458916 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m12:26:12.562446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m12:26:12.573687 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m12:26:12.574197 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m12:26:12.574615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:13.026348 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.452 seconds
[0m12:26:13.028203 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m12:26:13.120302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m12:26:13.124262 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m12:26:13.125024 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m12:26:13.125689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:13.488855 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.363 seconds
[0m12:26:13.491278 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m12:26:13.565535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f52af04e-a7f2-4627-a626-26565ddecb64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f087e30>]}
[0m12:26:13.566244 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:13.566646 [info ] [MainThread]: 
[0m12:26:13.570439 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.dim_patients
[0m12:26:13.571456 [info ] [Thread-1 (]: 1 of 1 START sql view model transform.dim_patients ............................. [RUN]
[0m12:26:13.572221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.dim_patients)
[0m12:26:13.572759 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.dim_patients
[0m12:26:13.582624 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.dim_patients"
[0m12:26:13.583703 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.dim_patients
[0m12:26:13.595764 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m12:26:13.596741 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
show parameters like 'query_tag' in session
[0m12:26:13.597585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:13.910063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.313 seconds
[0m12:26:13.912372 [debug] [Thread-1 (]: Setting query_tag to 'dim_patients'. Will reset to '' after materialization.
[0m12:26:13.913628 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m12:26:13.914094 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
alter session set query_tag = 'dim_patients'
[0m12:26:14.068458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.154 seconds
[0m12:26:14.200982 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.dim_patients"
[0m12:26:14.203097 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m12:26:14.203751 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
create or replace   view CASPAR_HEALTH.transform.dim_patients
  
   as (
    SELECT
    PATIENT_ID AS ID,
    FIRST_NAME,
    LAST_NAME,
    COUNTRY
FROM CASPAR_HEALTH.public.stg_patients
  );
[0m12:26:14.395855 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m12:26:14.423089 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: Close
[0m12:26:14.597887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f52af04e-a7f2-4627-a626-26565ddecb64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d87f500>]}
[0m12:26:14.599150 [info ] [Thread-1 (]: 1 of 1 OK created sql view model transform.dim_patients ........................ [[32mSUCCESS 1[0m in 1.02s]
[0m12:26:14.600242 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.dim_patients
[0m12:26:14.601694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:14.602166 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.dim_patients' was properly closed.
[0m12:26:14.602550 [info ] [MainThread]: 
[0m12:26:14.603012 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.72 seconds (2.72s).
[0m12:26:14.603947 [debug] [MainThread]: Command end result
[0m12:26:14.639591 [info ] [MainThread]: 
[0m12:26:14.640532 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:26:14.641259 [info ] [MainThread]: 
[0m12:26:14.642023 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:26:14.642718 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.538116, "process_in_blocks": "0", "process_kernel_time": 0.599097, "process_mem_max_rss": "131428352", "process_out_blocks": "0", "process_user_time": 2.872938}
[0m12:26:14.643231 [debug] [MainThread]: Command `dbt run` succeeded at 12:26:14.643124 after 4.54 seconds
[0m12:26:14.643637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dcd5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb1ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce63470>]}
[0m12:26:14.644018 [debug] [MainThread]: Flushing usage events
[0m12:31:41.900139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fde900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a448590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a448350>]}


============================== 12:31:41.906595 | c231f101-6458-4421-9a6d-0ef15bb3b7c3 ==============================
[0m12:31:41.906595 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:31:41.907261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select patients_enhanced', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:31:42.580304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c231f101-6458-4421-9a6d-0ef15bb3b7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b055b50>]}
[0m12:31:42.638389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c231f101-6458-4421-9a6d-0ef15bb3b7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad46330>]}
[0m12:31:42.640823 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:31:42.849438 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:31:43.185576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m12:31:43.186182 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://models/transform/patients_enhanced.sql
[0m12:31:43.186610 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/fct_exercises.sql
[0m12:31:43.186994 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/fct_steps.sql
[0m12:31:43.187370 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/dim_patients.sql
[0m12:31:43.484052 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:31:43.490415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c231f101-6458-4421-9a6d-0ef15bb3b7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b47bf50>]}
[0m12:31:43.610484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c231f101-6458-4421-9a6d-0ef15bb3b7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2ccfb0>]}
[0m12:31:43.611132 [info ] [MainThread]: Found 3 seeds, 4 models, 577 macros
[0m12:31:43.611733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c231f101-6458-4421-9a6d-0ef15bb3b7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b553e00>]}
[0m12:31:43.613788 [info ] [MainThread]: 
[0m12:31:43.614589 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:31:43.615642 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m12:31:43.632046 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m12:31:43.632810 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m12:31:43.633249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:31:44.243722 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.611 seconds
[0m12:31:44.245623 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m12:31:44.325401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m12:31:44.337659 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m12:31:44.338314 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m12:31:44.339411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:44.723138 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.384 seconds
[0m12:31:44.726239 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m12:31:44.806835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m12:31:44.811596 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m12:31:44.812166 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m12:31:44.812655 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:31:45.149322 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.337 seconds
[0m12:31:45.153765 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m12:31:45.236886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c231f101-6458-4421-9a6d-0ef15bb3b7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5b7740>]}
[0m12:31:45.238242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:31:45.239268 [info ] [MainThread]: 
[0m12:31:45.245350 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_enhanced
[0m12:31:45.246574 [info ] [Thread-1 (]: 1 of 1 START sql view model transform.patients_enhanced ........................ [RUN]
[0m12:31:45.247873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.patients_enhanced)
[0m12:31:45.249340 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.patients_enhanced
[0m12:31:45.263765 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:31:45.266398 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.patients_enhanced
[0m12:31:45.278756 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:31:45.279258 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_enhanced"} */
show parameters like 'query_tag' in session
[0m12:31:45.279624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:31:45.545013 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.265 seconds
[0m12:31:45.548043 [debug] [Thread-1 (]: Setting query_tag to 'patients_enhanced'. Will reset to '' after materialization.
[0m12:31:45.549295 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:31:45.549987 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_enhanced"} */
alter session set query_tag = 'patients_enhanced'
[0m12:31:45.794022 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.244 seconds
[0m12:31:45.894676 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:31:45.897521 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:31:45.898267 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_enhanced"} */
create or replace   view CASPAR_HEALTH.transform.patients_enhanced
  
   as (
    SELECT
    id,
    first_name,
    last_name,
    country,
    fct_exercises.minutes AS exercises_minutes,
    fct_steps.steps * 0.002 AS steps_minutes
FROM  CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.transform.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.transform.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
  );
[0m12:31:46.085958 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a0d3-0203-b576-0003-18c200010db6
[0m12:31:46.086630 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'ID'
[0m12:31:46.087367 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: Close
[0m12:31:46.160923 [debug] [Thread-1 (]: Database Error in model patients_enhanced (models/transform/patients_enhanced.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'ID'
  compiled code at target/run/caspar_health_technical_challenge/models/transform/patients_enhanced.sql
[0m12:31:46.163358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c231f101-6458-4421-9a6d-0ef15bb3b7c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5534a0>]}
[0m12:31:46.164313 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model transform.patients_enhanced ............... [[31mERROR[0m in 0.91s]
[0m12:31:46.165180 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_enhanced
[0m12:31:46.167758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:31:46.168506 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.patients_enhanced' was properly closed.
[0m12:31:46.169481 [info ] [MainThread]: 
[0m12:31:46.170181 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m12:31:46.171047 [debug] [MainThread]: Command end result
[0m12:31:46.203317 [info ] [MainThread]: 
[0m12:31:46.203841 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:31:46.204181 [info ] [MainThread]: 
[0m12:31:46.204760 [error] [MainThread]:   Database Error in model patients_enhanced (models/transform/patients_enhanced.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'ID'
  compiled code at target/run/caspar_health_technical_challenge/models/transform/patients_enhanced.sql
[0m12:31:46.205094 [info ] [MainThread]: 
[0m12:31:46.205505 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:31:46.206104 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.4016023, "process_in_blocks": "0", "process_kernel_time": 0.63103, "process_mem_max_rss": "134090752", "process_out_blocks": "0", "process_user_time": 2.862233}
[0m12:31:46.206739 [debug] [MainThread]: Command `dbt run` failed at 12:31:46.206627 after 4.40 seconds
[0m12:31:46.207163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fde900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d8aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b28d0a0>]}
[0m12:31:46.207535 [debug] [MainThread]: Flushing usage events
[0m12:32:16.310969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b13d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4587a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e458560>]}


============================== 12:32:16.317038 | 7dd636e7-d0ea-4fc4-ac7f-b067d91bd25c ==============================
[0m12:32:16.317038 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:32:16.317730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select patients_enhanced', 'send_anonymous_usage_stats': 'True'}
[0m12:32:16.778842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dd636e7-d0ea-4fc4-ac7f-b067d91bd25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d553ec0>]}
[0m12:32:16.834839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dd636e7-d0ea-4fc4-ac7f-b067d91bd25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e459dc0>]}
[0m12:32:16.835964 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:32:16.965158 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:32:17.144325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:32:17.144978 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/patients_enhanced.sql
[0m12:32:17.366099 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:32:17.372248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dd636e7-d0ea-4fc4-ac7f-b067d91bd25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f56dfd0>]}
[0m12:32:17.478304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dd636e7-d0ea-4fc4-ac7f-b067d91bd25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f234530>]}
[0m12:32:17.478830 [info ] [MainThread]: Found 3 seeds, 4 models, 577 macros
[0m12:32:17.479200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dd636e7-d0ea-4fc4-ac7f-b067d91bd25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4064b0>]}
[0m12:32:17.480798 [info ] [MainThread]: 
[0m12:32:17.481383 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:32:17.482314 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m12:32:17.496098 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m12:32:17.496616 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m12:32:17.496941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:18.134952 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.638 seconds
[0m12:32:18.143668 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m12:32:18.276412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m12:32:18.289638 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m12:32:18.290191 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m12:32:18.290610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:18.661430 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.371 seconds
[0m12:32:18.666322 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m12:32:18.819561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m12:32:18.823849 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m12:32:18.824358 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m12:32:18.824788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:32:19.241176 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.416 seconds
[0m12:32:19.245374 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m12:32:19.335997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dd636e7-d0ea-4fc4-ac7f-b067d91bd25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f297380>]}
[0m12:32:19.336933 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:19.337726 [info ] [MainThread]: 
[0m12:32:19.341496 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_enhanced
[0m12:32:19.342426 [info ] [Thread-1 (]: 1 of 1 START sql view model transform.patients_enhanced ........................ [RUN]
[0m12:32:19.343202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.patients_enhanced)
[0m12:32:19.343807 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.patients_enhanced
[0m12:32:19.355150 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:32:19.357667 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.patients_enhanced
[0m12:32:19.369872 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:32:19.370564 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_enhanced"} */
show parameters like 'query_tag' in session
[0m12:32:19.370999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:32:19.755657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.385 seconds
[0m12:32:19.758240 [debug] [Thread-1 (]: Setting query_tag to 'patients_enhanced'. Will reset to '' after materialization.
[0m12:32:19.759442 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:32:19.760104 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_enhanced"} */
alter session set query_tag = 'patients_enhanced'
[0m12:32:19.823956 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.063 seconds
[0m12:32:19.854312 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:32:19.856161 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:32:19.856732 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_enhanced"} */
create or replace   view CASPAR_HEALTH.transform.patients_enhanced
  
   as (
    SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    fct_exercises.minutes AS exercises_minutes,
    fct_steps.steps * 0.002 AS steps_minutes
FROM  CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.transform.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.transform.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
  );
[0m12:32:20.234525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.377 seconds
[0m12:32:20.265229 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: Close
[0m12:32:20.632352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7dd636e7-d0ea-4fc4-ac7f-b067d91bd25c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e17c0b0>]}
[0m12:32:20.633479 [info ] [Thread-1 (]: 1 of 1 OK created sql view model transform.patients_enhanced ................... [[32mSUCCESS 1[0m in 1.29s]
[0m12:32:20.634440 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_enhanced
[0m12:32:20.636123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:20.636618 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.patients_enhanced' was properly closed.
[0m12:32:20.637089 [info ] [MainThread]: 
[0m12:32:20.637585 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m12:32:20.639260 [debug] [MainThread]: Command end result
[0m12:32:20.675404 [info ] [MainThread]: 
[0m12:32:20.676349 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:20.676782 [info ] [MainThread]: 
[0m12:32:20.677151 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:32:20.677760 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4405637, "process_in_blocks": "0", "process_kernel_time": 0.451278, "process_mem_max_rss": "132644864", "process_out_blocks": "0", "process_user_time": 2.611857}
[0m12:32:20.678327 [debug] [MainThread]: Command `dbt run` succeeded at 12:32:20.678211 after 4.44 seconds
[0m12:32:20.678774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e14faa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b13d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e04f680>]}
[0m12:32:20.679290 [debug] [MainThread]: Flushing usage events
[0m12:33:13.375736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107734710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077344d0>]}


============================== 12:33:13.383129 | 1a47ce08-59d6-499d-9ad2-3995fd43f404 ==============================
[0m12:33:13.383129 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:33:13.383822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select patients_enhanced', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:33:13.994797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a47ce08-59d6-499d-9ad2-3995fd43f404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108276210>]}
[0m12:33:14.049714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a47ce08-59d6-499d-9ad2-3995fd43f404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108085d00>]}
[0m12:33:14.051343 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:33:14.200078 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:33:14.390012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:33:14.390708 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/patients_enhanced.sql
[0m12:33:14.635858 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:33:14.640946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a47ce08-59d6-499d-9ad2-3995fd43f404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108713470>]}
[0m12:33:14.746068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a47ce08-59d6-499d-9ad2-3995fd43f404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086df6e0>]}
[0m12:33:14.746606 [info ] [MainThread]: Found 3 seeds, 4 models, 577 macros
[0m12:33:14.746970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a47ce08-59d6-499d-9ad2-3995fd43f404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815ab70>]}
[0m12:33:14.748531 [info ] [MainThread]: 
[0m12:33:14.749341 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:33:14.750487 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m12:33:14.763975 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m12:33:14.764464 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m12:33:14.764824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:15.274185 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.509 seconds
[0m12:33:15.277397 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m12:33:15.357336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m12:33:15.368439 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m12:33:15.368980 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m12:33:15.369295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:15.685599 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.316 seconds
[0m12:33:15.689207 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m12:33:15.785533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m12:33:15.790721 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m12:33:15.791323 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m12:33:15.791824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:16.132418 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.340 seconds
[0m12:33:16.134503 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m12:33:16.199843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a47ce08-59d6-499d-9ad2-3995fd43f404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10880daf0>]}
[0m12:33:16.200986 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:16.201814 [info ] [MainThread]: 
[0m12:33:16.206345 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_enhanced
[0m12:33:16.207750 [info ] [Thread-1 (]: 1 of 1 START sql view model transform.patients_enhanced ........................ [RUN]
[0m12:33:16.208653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.patients_enhanced)
[0m12:33:16.209253 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.patients_enhanced
[0m12:33:16.220739 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:33:16.222439 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.patients_enhanced
[0m12:33:16.234381 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:33:16.251663 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_enhanced"} */
show parameters like 'query_tag' in session
[0m12:33:16.252183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:16.751198 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m12:33:16.754856 [debug] [Thread-1 (]: Setting query_tag to 'patients_enhanced'. Will reset to '' after materialization.
[0m12:33:16.756646 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:33:16.757515 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_enhanced"} */
alter session set query_tag = 'patients_enhanced'
[0m12:33:16.839507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.081 seconds
[0m12:33:16.876345 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:33:16.878666 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:33:16.879268 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_enhanced"} */
create or replace   view CASPAR_HEALTH.transform.patients_enhanced
  
   as (
    SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.steps * 0.002) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.steps * 0.002) AS total_minutes
FROM  CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.transform.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.transform.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
  );
[0m12:33:16.976455 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a0d5-0203-b6af-0003-18c200014192
[0m12:33:16.977124 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 2 unexpected ')'.
[0m12:33:16.977848 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: Close
[0m12:33:17.064387 [debug] [Thread-1 (]: Database Error in model patients_enhanced (models/transform/patients_enhanced.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 2 unexpected ')'.
  compiled code at target/run/caspar_health_technical_challenge/models/transform/patients_enhanced.sql
[0m12:33:17.066396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a47ce08-59d6-499d-9ad2-3995fd43f404', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c7b470>]}
[0m12:33:17.067258 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model transform.patients_enhanced ............... [[31mERROR[0m in 0.86s]
[0m12:33:17.068153 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_enhanced
[0m12:33:17.070457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:17.070894 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.patients_enhanced' was properly closed.
[0m12:33:17.071301 [info ] [MainThread]: 
[0m12:33:17.071742 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m12:33:17.072544 [debug] [MainThread]: Command end result
[0m12:33:17.102788 [info ] [MainThread]: 
[0m12:33:17.103338 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:33:17.103991 [info ] [MainThread]: 
[0m12:33:17.104650 [error] [MainThread]:   Database Error in model patients_enhanced (models/transform/patients_enhanced.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 2 unexpected ')'.
  compiled code at target/run/caspar_health_technical_challenge/models/transform/patients_enhanced.sql
[0m12:33:17.105068 [info ] [MainThread]: 
[0m12:33:17.105483 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:33:17.106300 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.806593, "process_in_blocks": "0", "process_kernel_time": 0.504103, "process_mem_max_rss": "132677632", "process_out_blocks": "0", "process_user_time": 2.663369}
[0m12:33:17.107080 [debug] [MainThread]: Command `dbt run` failed at 12:33:17.106872 after 3.81 seconds
[0m12:33:17.107699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d112b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c48f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d9610>]}
[0m12:33:17.108133 [debug] [MainThread]: Flushing usage events
[0m12:33:41.446391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113470500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134702c0>]}


============================== 12:33:41.452522 | be329850-e7ef-45e2-b31d-00ed4a21dff4 ==============================
[0m12:33:41.452522 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:33:41.453376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select patients_enhanced', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:33:41.970628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be329850-e7ef-45e2-b31d-00ed4a21dff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110868410>]}
[0m12:33:42.041437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be329850-e7ef-45e2-b31d-00ed4a21dff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b9b500>]}
[0m12:33:42.042841 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:33:42.187726 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:33:42.322782 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:33:42.323424 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/patients_enhanced.sql
[0m12:33:42.538045 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.analysis
[0m12:33:42.543375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be329850-e7ef-45e2-b31d-00ed4a21dff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11457e060>]}
[0m12:33:42.635914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be329850-e7ef-45e2-b31d-00ed4a21dff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141d7620>]}
[0m12:33:42.636447 [info ] [MainThread]: Found 3 seeds, 4 models, 577 macros
[0m12:33:42.636851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be329850-e7ef-45e2-b31d-00ed4a21dff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114330260>]}
[0m12:33:42.638465 [info ] [MainThread]: 
[0m12:33:42.639091 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:33:42.640025 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m12:33:42.653395 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m12:33:42.653873 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m12:33:42.654384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:43.162108 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.508 seconds
[0m12:33:43.165227 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m12:33:43.248078 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m12:33:43.270207 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m12:33:43.270772 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m12:33:43.271193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:43.702075 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.431 seconds
[0m12:33:43.704796 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m12:33:43.807859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m12:33:43.814355 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m12:33:43.815076 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m12:33:43.815556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:44.409995 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.594 seconds
[0m12:33:44.414179 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m12:33:44.491248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be329850-e7ef-45e2-b31d-00ed4a21dff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f2c5c0>]}
[0m12:33:44.492382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:44.493083 [info ] [MainThread]: 
[0m12:33:44.497259 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_enhanced
[0m12:33:44.498271 [info ] [Thread-1 (]: 1 of 1 START sql view model transform.patients_enhanced ........................ [RUN]
[0m12:33:44.499199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.patients_enhanced)
[0m12:33:44.499902 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.patients_enhanced
[0m12:33:44.512895 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:33:44.515060 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.patients_enhanced
[0m12:33:44.527216 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:33:44.527874 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_enhanced"} */
show parameters like 'query_tag' in session
[0m12:33:44.528484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:33:44.920165 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.392 seconds
[0m12:33:44.922692 [debug] [Thread-1 (]: Setting query_tag to 'patients_enhanced'. Will reset to '' after materialization.
[0m12:33:44.923865 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:33:44.924578 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_enhanced"} */
alter session set query_tag = 'patients_enhanced'
[0m12:33:45.037330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m12:33:45.073902 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:33:45.075857 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_enhanced"
[0m12:33:45.076382 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_enhanced"} */
create or replace   view CASPAR_HEALTH.transform.patients_enhanced
  
   as (
    SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.steps * 0.002) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.steps * 0.002) AS total_minutes
FROM  CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.transform.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.transform.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
  );
[0m12:33:45.536682 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.460 seconds
[0m12:33:45.574226 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_enhanced: Close
[0m12:33:45.642463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be329850-e7ef-45e2-b31d-00ed4a21dff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147070b0>]}
[0m12:33:45.643730 [info ] [Thread-1 (]: 1 of 1 OK created sql view model transform.patients_enhanced ................... [[32mSUCCESS 1[0m in 1.14s]
[0m12:33:45.644762 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_enhanced
[0m12:33:45.646665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:45.647222 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.patients_enhanced' was properly closed.
[0m12:33:45.647755 [info ] [MainThread]: 
[0m12:33:45.648305 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m12:33:45.649339 [debug] [MainThread]: Command end result
[0m12:33:45.684278 [info ] [MainThread]: 
[0m12:33:45.684809 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:33:45.685598 [info ] [MainThread]: 
[0m12:33:45.686136 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:33:45.686856 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.315511, "process_in_blocks": "0", "process_kernel_time": 0.459386, "process_mem_max_rss": "133246976", "process_out_blocks": "0", "process_user_time": 2.691531}
[0m12:33:45.687459 [debug] [MainThread]: Command `dbt run` succeeded at 12:33:45.687304 after 4.32 seconds
[0m12:33:45.688002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114368140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143dfc50>]}
[0m12:33:45.688387 [debug] [MainThread]: Flushing usage events
[0m12:35:09.164787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10556a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10856c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10856c5f0>]}


============================== 12:35:09.172512 | 0446c369-34c4-4a95-bce4-55721018b57c ==============================
[0m12:35:09.172512 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:35:09.173373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select patients_grouped', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:35:09.875452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0446c369-34c4-4a95-bce4-55721018b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e9e750>]}
[0m12:35:09.943768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0446c369-34c4-4a95-bce4-55721018b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085403e0>]}
[0m12:35:09.945873 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:35:10.114617 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:35:10.329683 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m12:35:10.330658 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://models/analysis/patients_grouped.sql
[0m12:35:10.331385 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://models/analysis/patients_results.sql
[0m12:35:10.331859 [debug] [MainThread]: Partial parsing: deleted file: caspar_health_technical_challenge://models/transform/patients_enhanced.sql
[0m12:35:10.614388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0446c369-34c4-4a95-bce4-55721018b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095ee960>]}
[0m12:35:10.719852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0446c369-34c4-4a95-bce4-55721018b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945aa80>]}
[0m12:35:10.720453 [info ] [MainThread]: Found 3 seeds, 5 models, 577 macros
[0m12:35:10.720902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0446c369-34c4-4a95-bce4-55721018b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091de870>]}
[0m12:35:10.723206 [info ] [MainThread]: 
[0m12:35:10.724176 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:35:10.725417 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m12:35:10.741013 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m12:35:10.741620 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m12:35:10.741978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:11.227896 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.486 seconds
[0m12:35:11.229765 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m12:35:11.295255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now create_CASPAR_HEALTH_analysis)
[0m12:35:11.296500 [debug] [ThreadPool]: Creating schema "database: "CASPAR_HEALTH"
schema: "analysis"
"
[0m12:35:11.301322 [debug] [ThreadPool]: Using snowflake connection "create_CASPAR_HEALTH_analysis"
[0m12:35:11.301803 [debug] [ThreadPool]: On create_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "create_CASPAR_HEALTH_analysis"} */
create schema if not exists CASPAR_HEALTH.analysis
[0m12:35:11.302139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:11.723280 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.421 seconds
[0m12:35:11.726569 [debug] [ThreadPool]: On create_CASPAR_HEALTH_analysis: Close
[0m12:35:11.814807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_analysis)
[0m12:35:11.827593 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m12:35:11.828405 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m12:35:11.829294 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:12.094168 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.265 seconds
[0m12:35:12.096701 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m12:35:12.165291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_public)
[0m12:35:12.168199 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m12:35:12.168750 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m12:35:12.169093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:12.476155 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.307 seconds
[0m12:35:12.478293 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m12:35:13.026505 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_transform)
[0m12:35:13.031112 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m12:35:13.031576 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m12:35:13.031900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:13.414222 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.382 seconds
[0m12:35:13.415949 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m12:35:13.491526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0446c369-34c4-4a95-bce4-55721018b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059dc7d0>]}
[0m12:35:13.492209 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:13.492657 [info ] [MainThread]: 
[0m12:35:13.496617 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_grouped
[0m12:35:13.497350 [info ] [Thread-1 (]: 1 of 1 START sql view model analysis.patients_grouped .......................... [RUN]
[0m12:35:13.497910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now model.caspar_health_technical_challenge.patients_grouped)
[0m12:35:13.498370 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.patients_grouped
[0m12:35:13.507101 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.patients_grouped"
[0m12:35:13.508737 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.patients_grouped
[0m12:35:13.518801 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_grouped"
[0m12:35:13.519453 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_grouped: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_grouped"} */
show parameters like 'query_tag' in session
[0m12:35:13.519884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:13.789374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.269 seconds
[0m12:35:13.800202 [debug] [Thread-1 (]: Setting query_tag to 'patients_grouped'. Will reset to '' after materialization.
[0m12:35:13.801118 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_grouped"
[0m12:35:13.801706 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_grouped: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_grouped"} */
alter session set query_tag = 'patients_grouped'
[0m12:35:13.884604 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.082 seconds
[0m12:35:13.911151 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.patients_grouped"
[0m12:35:13.913905 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_grouped"
[0m12:35:13.914450 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_grouped: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_grouped"} */
create or replace   view CASPAR_HEALTH.analysis.patients_grouped
  
   as (
    SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.steps * 0.002) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.steps * 0.002) AS total_minutes
FROM  CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.transform.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.transform.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
  );
[0m12:35:14.417319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m12:35:14.443189 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_grouped: Close
[0m12:35:14.509380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0446c369-34c4-4a95-bce4-55721018b57c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aaf6e0>]}
[0m12:35:14.510697 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analysis.patients_grouped ..................... [[32mSUCCESS 1[0m in 1.01s]
[0m12:35:14.512211 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_grouped
[0m12:35:14.513755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:14.514281 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.patients_grouped' was properly closed.
[0m12:35:14.514636 [info ] [MainThread]: 
[0m12:35:14.515081 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.79 seconds (3.79s).
[0m12:35:14.515893 [debug] [MainThread]: Command end result
[0m12:35:14.558859 [info ] [MainThread]: 
[0m12:35:14.559706 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:35:14.560434 [info ] [MainThread]: 
[0m12:35:14.561240 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:35:14.562502 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.490286, "process_in_blocks": "0", "process_kernel_time": 0.643746, "process_mem_max_rss": "132415488", "process_out_blocks": "0", "process_user_time": 3.022046}
[0m12:35:14.563294 [debug] [MainThread]: Command `dbt run` succeeded at 12:35:14.563179 after 5.49 seconds
[0m12:35:14.563718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081228a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079502f0>]}
[0m12:35:14.564184 [debug] [MainThread]: Flushing usage events
[0m12:35:36.573224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107054800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070545c0>]}


============================== 12:35:36.578265 | 3f604842-0b30-481f-adbf-80c4310f5c6a ==============================
[0m12:35:36.578265 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:35:36.578927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select patients_results', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:35:37.038987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f604842-0b30-481f-adbf-80c4310f5c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107395e80>]}
[0m12:35:37.093437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f604842-0b30-481f-adbf-80c4310f5c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044bcaa0>]}
[0m12:35:37.094497 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:35:37.226510 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:35:37.359165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:35:37.359826 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/patients_results.sql
[0m12:35:37.568455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f604842-0b30-481f-adbf-80c4310f5c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10816a4b0>]}
[0m12:35:37.655033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f604842-0b30-481f-adbf-80c4310f5c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef1f40>]}
[0m12:35:37.656037 [info ] [MainThread]: Found 3 seeds, 5 models, 577 macros
[0m12:35:37.656527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f604842-0b30-481f-adbf-80c4310f5c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c65ac0>]}
[0m12:35:37.658187 [info ] [MainThread]: 
[0m12:35:37.658784 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:35:37.659764 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m12:35:37.672506 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m12:35:37.673021 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m12:35:37.673343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:38.350354 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.677 seconds
[0m12:35:38.353827 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m12:35:38.439274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_analysis)
[0m12:35:38.453629 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m12:35:38.454252 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m12:35:38.454799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:38.797168 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.342 seconds
[0m12:35:38.800571 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m12:35:39.059482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_public)
[0m12:35:39.063479 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m12:35:39.064021 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m12:35:39.064434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:39.588414 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.524 seconds
[0m12:35:39.591504 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m12:35:39.663195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_transform)
[0m12:35:39.667386 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m12:35:39.667892 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m12:35:39.668330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:40.001294 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.333 seconds
[0m12:35:40.005815 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m12:35:40.091647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f604842-0b30-481f-adbf-80c4310f5c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bab440>]}
[0m12:35:40.092577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:40.093137 [info ] [MainThread]: 
[0m12:35:40.095983 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_results
[0m12:35:40.096821 [info ] [Thread-1 (]: 1 of 1 START sql view model analysis.patients_results .......................... [RUN]
[0m12:35:40.097480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now model.caspar_health_technical_challenge.patients_results)
[0m12:35:40.097969 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.patients_results
[0m12:35:40.108435 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.patients_results"
[0m12:35:40.109530 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.patients_results
[0m12:35:40.177561 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m12:35:40.178124 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
show parameters like 'query_tag' in session
[0m12:35:40.178483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:40.516051 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.337 seconds
[0m12:35:40.519616 [debug] [Thread-1 (]: Setting query_tag to 'patients_results'. Will reset to '' after materialization.
[0m12:35:40.520845 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m12:35:40.521547 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
alter session set query_tag = 'patients_results'
[0m12:35:40.581639 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.059 seconds
[0m12:35:40.610660 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.patients_results"
[0m12:35:40.612200 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m12:35:40.612644 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
create or replace   view CASPAR_HEALTH.analysis.patients_results
  
   as (
    SELECT
    id,
    first_name,
    last_name,
    country,
    MAX(total_minutes)
FROM CASPAR_HEALTH.analysis.patients_grouped
  );
[0m12:35:40.810468 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a0d7-0203-b56e-0003-18c200013bda
[0m12:35:40.813822 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m12:35:40.815290 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: Close
[0m12:35:40.902438 [debug] [Thread-1 (]: Database Error in model patients_results (models/analysis/patients_results.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/caspar_health_technical_challenge/models/analysis/patients_results.sql
[0m12:35:40.905067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f604842-0b30-481f-adbf-80c4310f5c6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659b5f0>]}
[0m12:35:40.906254 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analysis.patients_results ................. [[31mERROR[0m in 0.81s]
[0m12:35:40.907195 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_results
[0m12:35:40.909769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:40.910192 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.patients_results' was properly closed.
[0m12:35:40.910600 [info ] [MainThread]: 
[0m12:35:40.911047 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m12:35:40.912116 [debug] [MainThread]: Command end result
[0m12:35:40.949455 [info ] [MainThread]: 
[0m12:35:40.950065 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:35:40.950431 [info ] [MainThread]: 
[0m12:35:40.950830 [error] [MainThread]:   Database Error in model patients_results (models/analysis/patients_results.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/caspar_health_technical_challenge/models/analysis/patients_results.sql
[0m12:35:40.951377 [info ] [MainThread]: 
[0m12:35:40.951910 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:35:40.953638 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.447146, "process_in_blocks": "0", "process_kernel_time": 0.472132, "process_mem_max_rss": "132820992", "process_out_blocks": "0", "process_user_time": 2.612542}
[0m12:35:40.954672 [debug] [MainThread]: Command `dbt run` failed at 12:35:40.954522 after 4.45 seconds
[0m12:35:40.955465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d8bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a864b0>]}
[0m12:35:40.956133 [debug] [MainThread]: Flushing usage events
[0m12:37:22.272437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11166d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c585c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c58380>]}


============================== 12:37:22.279796 | 2bae333b-214e-4754-98b6-d73cb4ebb30a ==============================
[0m12:37:22.279796 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:37:22.280511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select patients_results', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:37:22.975747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bae333b-214e-4754-98b6-d73cb4ebb30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11280b0e0>]}
[0m12:37:23.036208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bae333b-214e-4754-98b6-d73cb4ebb30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127df980>]}
[0m12:37:23.039209 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:37:23.199151 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:37:23.425687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:37:23.426376 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/patients_results.sql
[0m12:37:23.677500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bae333b-214e-4754-98b6-d73cb4ebb30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d6a6c0>]}
[0m12:37:23.816368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bae333b-214e-4754-98b6-d73cb4ebb30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b4d460>]}
[0m12:37:23.816937 [info ] [MainThread]: Found 3 seeds, 5 models, 577 macros
[0m12:37:23.817421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bae333b-214e-4754-98b6-d73cb4ebb30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d6a420>]}
[0m12:37:23.819140 [info ] [MainThread]: 
[0m12:37:23.819797 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:37:23.820711 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m12:37:23.834160 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m12:37:23.834625 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m12:37:23.834971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:24.291737 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.457 seconds
[0m12:37:24.293984 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m12:37:24.776370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_analysis)
[0m12:37:24.787794 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m12:37:24.788262 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m12:37:24.788599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:25.104127 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.315 seconds
[0m12:37:25.106032 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m12:37:25.221072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_transform)
[0m12:37:25.224087 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m12:37:25.224516 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m12:37:25.224852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:25.559550 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.335 seconds
[0m12:37:25.561539 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m12:37:25.623510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m12:37:25.626916 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m12:37:25.627414 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m12:37:25.627739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:25.942553 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.315 seconds
[0m12:37:25.944303 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m12:37:26.019362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bae333b-214e-4754-98b6-d73cb4ebb30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dea300>]}
[0m12:37:26.020050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:26.020499 [info ] [MainThread]: 
[0m12:37:26.024059 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_results
[0m12:37:26.024825 [info ] [Thread-1 (]: 1 of 1 START sql view model analysis.patients_results .......................... [RUN]
[0m12:37:26.025329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.patients_results)
[0m12:37:26.025737 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.patients_results
[0m12:37:26.034559 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.patients_results"
[0m12:37:26.037283 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.patients_results
[0m12:37:26.110630 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m12:37:26.111214 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
show parameters like 'query_tag' in session
[0m12:37:26.111642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:26.472595 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.361 seconds
[0m12:37:26.474166 [debug] [Thread-1 (]: Setting query_tag to 'patients_results'. Will reset to '' after materialization.
[0m12:37:26.474910 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m12:37:26.475360 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
alter session set query_tag = 'patients_results'
[0m12:37:26.538649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.063 seconds
[0m12:37:26.565217 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.patients_results"
[0m12:37:26.566876 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m12:37:26.567404 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
create or replace   view CASPAR_HEALTH.analysis.patients_results
  
   as (
    SELECT
    id,
    first_name,
    last_name,
    country,
    MAX(total_minutes)
FROM CASPAR_HEALTH.analysis.patients_grouped
GROUP BY
    id,
    first_name,
    last_name,
    country
  );
[0m12:37:26.768593 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a0d9-0203-b580-0003-18c20001719e
[0m12:37:26.769099 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m12:37:26.769616 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: Close
[0m12:37:26.854077 [debug] [Thread-1 (]: Database Error in model patients_results (models/analysis/patients_results.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/caspar_health_technical_challenge/models/analysis/patients_results.sql
[0m12:37:26.855563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bae333b-214e-4754-98b6-d73cb4ebb30a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11118f770>]}
[0m12:37:26.856197 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analysis.patients_results ................. [[31mERROR[0m in 0.83s]
[0m12:37:26.856820 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_results
[0m12:37:26.858539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:26.858875 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.patients_results' was properly closed.
[0m12:37:26.859189 [info ] [MainThread]: 
[0m12:37:26.859519 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m12:37:26.860134 [debug] [MainThread]: Command end result
[0m12:37:26.891893 [info ] [MainThread]: 
[0m12:37:26.892496 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:37:26.893388 [info ] [MainThread]: 
[0m12:37:26.894115 [error] [MainThread]:   Database Error in model patients_results (models/analysis/patients_results.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/caspar_health_technical_challenge/models/analysis/patients_results.sql
[0m12:37:26.894798 [info ] [MainThread]: 
[0m12:37:26.895479 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:37:26.896507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.711107, "process_in_blocks": "0", "process_kernel_time": 0.591204, "process_mem_max_rss": "132694016", "process_out_blocks": "0", "process_user_time": 2.687498}
[0m12:37:26.897129 [debug] [MainThread]: Command `dbt run` failed at 12:37:26.896993 after 4.71 seconds
[0m12:37:26.897591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11180d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11166d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d6ac00>]}
[0m12:37:26.898038 [debug] [MainThread]: Flushing usage events
[0m12:38:02.702608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6e7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6e7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e758410>]}


============================== 12:38:02.708041 | fba1ff4d-2b67-463a-b9e6-cb68298c361c ==============================
[0m12:38:02.708041 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:38:02.709071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select patients_results', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:38:03.384721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fba1ff4d-2b67-463a-b9e6-cb68298c361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecf80e0>]}
[0m12:38:03.447826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fba1ff4d-2b67-463a-b9e6-cb68298c361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2de1b0>]}
[0m12:38:03.449237 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:38:03.590200 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:38:03.735507 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:38:03.736154 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/patients_results.sql
[0m12:38:03.990247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fba1ff4d-2b67-463a-b9e6-cb68298c361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f86e630>]}
[0m12:38:04.091555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fba1ff4d-2b67-463a-b9e6-cb68298c361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5f46b0>]}
[0m12:38:04.092313 [info ] [MainThread]: Found 3 seeds, 5 models, 577 macros
[0m12:38:04.092761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fba1ff4d-2b67-463a-b9e6-cb68298c361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f853680>]}
[0m12:38:04.094489 [info ] [MainThread]: 
[0m12:38:04.095122 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:38:04.095990 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m12:38:04.115458 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m12:38:04.116173 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m12:38:04.117156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:04.628561 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.511 seconds
[0m12:38:04.630918 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m12:38:04.797947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m12:38:04.809699 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m12:38:04.810263 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m12:38:04.810725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:05.115325 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.304 seconds
[0m12:38:05.119402 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m12:38:05.224060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_analysis)
[0m12:38:05.228808 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m12:38:05.229427 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m12:38:05.229940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:05.554639 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.325 seconds
[0m12:38:05.557986 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m12:38:05.657939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_transform)
[0m12:38:05.663867 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m12:38:05.664780 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m12:38:05.665549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:05.952605 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.287 seconds
[0m12:38:05.955325 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m12:38:06.501295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fba1ff4d-2b67-463a-b9e6-cb68298c361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec01be0>]}
[0m12:38:06.501974 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:38:06.502370 [info ] [MainThread]: 
[0m12:38:06.504646 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_results
[0m12:38:06.505377 [info ] [Thread-1 (]: 1 of 1 START sql view model analysis.patients_results .......................... [RUN]
[0m12:38:06.506162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now model.caspar_health_technical_challenge.patients_results)
[0m12:38:06.506625 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.patients_results
[0m12:38:06.514935 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.patients_results"
[0m12:38:06.516110 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.patients_results
[0m12:38:06.590160 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m12:38:06.590708 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
show parameters like 'query_tag' in session
[0m12:38:06.591067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:07.057649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m12:38:07.060102 [debug] [Thread-1 (]: Setting query_tag to 'patients_results'. Will reset to '' after materialization.
[0m12:38:07.061109 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m12:38:07.061725 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
alter session set query_tag = 'patients_results'
[0m12:38:07.129560 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.067 seconds
[0m12:38:07.165255 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.patients_results"
[0m12:38:07.166835 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m12:38:07.167367 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
create or replace   view CASPAR_HEALTH.analysis.patients_results
  
   as (
    SELECT
    id,
    first_name,
    last_name,
    country,
    MAX(total_minutes) AS total_minutes
FROM CASPAR_HEALTH.analysis.patients_grouped
GROUP BY
    id,
    first_name,
    last_name,
    country
  );
[0m12:38:07.554628 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.387 seconds
[0m12:38:07.584273 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: Close
[0m12:38:07.688002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fba1ff4d-2b67-463a-b9e6-cb68298c361c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb531a0>]}
[0m12:38:07.689252 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analysis.patients_results ..................... [[32mSUCCESS 1[0m in 1.18s]
[0m12:38:07.690283 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_results
[0m12:38:07.692189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:07.692737 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.patients_results' was properly closed.
[0m12:38:07.693258 [info ] [MainThread]: 
[0m12:38:07.693819 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m12:38:07.694858 [debug] [MainThread]: Command end result
[0m12:38:07.727843 [info ] [MainThread]: 
[0m12:38:07.728383 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:07.728777 [info ] [MainThread]: 
[0m12:38:07.729213 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:38:07.729994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.1075687, "process_in_blocks": "0", "process_kernel_time": 0.534136, "process_mem_max_rss": "133038080", "process_out_blocks": "0", "process_user_time": 2.910342}
[0m12:38:07.730577 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:07.730464 after 5.11 seconds
[0m12:38:07.730989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e349cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4aeba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6546e0>]}
[0m12:38:07.731655 [debug] [MainThread]: Flushing usage events
[0m12:59:29.181350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ee8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f40860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f40620>]}


============================== 12:59:29.187941 | 5e40f34a-9945-40a6-a093-0c80e7f2736b ==============================
[0m12:59:29.187941 [info ] [MainThread]: Running with dbt=1.8.9
[0m12:59:29.188692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select patients_results', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:59:29.885537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e40f34a-9945-40a6-a093-0c80e7f2736b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa3e150>]}
[0m12:59:29.950471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e40f34a-9945-40a6-a093-0c80e7f2736b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa3faa0>]}
[0m12:59:29.953126 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m12:59:30.220024 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m12:59:30.472187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:59:30.472924 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/patients_results.sql
[0m12:59:30.707214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e40f34a-9945-40a6-a093-0c80e7f2736b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9c8980>]}
[0m12:59:30.814774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e40f34a-9945-40a6-a093-0c80e7f2736b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad3c7d0>]}
[0m12:59:30.816234 [info ] [MainThread]: Found 3 seeds, 5 models, 577 macros
[0m12:59:30.816948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e40f34a-9945-40a6-a093-0c80e7f2736b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad66660>]}
[0m12:59:30.819048 [info ] [MainThread]: 
[0m12:59:30.819883 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:59:30.820926 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m12:59:30.840172 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m12:59:30.840796 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m12:59:30.841619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:32.547557 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.706 seconds
[0m12:59:32.550662 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m12:59:32.669685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m12:59:32.680318 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m12:59:32.680793 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m12:59:32.681135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:33.021891 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.341 seconds
[0m12:59:33.024815 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m12:59:33.105402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_analysis)
[0m12:59:33.110238 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m12:59:33.110853 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m12:59:33.111302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:33.517060 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.406 seconds
[0m12:59:33.521268 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m12:59:33.658669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_transform)
[0m12:59:33.662919 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m12:59:33.663429 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m12:59:33.663820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:34.437390 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.773 seconds
[0m12:59:34.440162 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m12:59:34.512609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e40f34a-9945-40a6-a093-0c80e7f2736b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa3e5d0>]}
[0m12:59:34.513596 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:59:34.514194 [info ] [MainThread]: 
[0m12:59:34.519108 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_results
[0m12:59:34.520029 [info ] [Thread-1 (]: 1 of 1 START sql view model analysis.patients_results .......................... [RUN]
[0m12:59:34.520989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now model.caspar_health_technical_challenge.patients_results)
[0m12:59:34.521561 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.patients_results
[0m12:59:34.533630 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.patients_results"
[0m12:59:34.534967 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.patients_results
[0m12:59:34.610635 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m12:59:34.611271 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
show parameters like 'query_tag' in session
[0m12:59:34.611666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:34.871121 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.259 seconds
[0m12:59:34.872795 [debug] [Thread-1 (]: Setting query_tag to 'patients_results'. Will reset to '' after materialization.
[0m12:59:34.873660 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m12:59:34.874231 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
alter session set query_tag = 'patients_results'
[0m12:59:34.962242 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m12:59:35.002797 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.patients_results"
[0m12:59:35.006370 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m12:59:35.007162 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
create or replace   view CASPAR_HEALTH.analysis.patients_results
  
   as (
    WITH top_minutes_patient AS (
SELECT
  MAX_BY(patients_grouped.id, patients_grouped.total_minutes) AS id
FROM CASPAR_HEALTH.analysis.patients_grouped
  AS patients_grouped
)

SELECT
top_minutes_patient.*,
dim_patients.*
FROM top_minutes_patient
FROM CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
  ON dim_patients.id =   top_minutes_patient.id
  );
[0m12:59:35.098774 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a0ef-0203-b42e-0003-18c200012bd6
[0m12:59:35.099428 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 15 at position 0 unexpected 'FROM'.
[0m12:59:35.100110 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: Close
[0m12:59:35.183557 [debug] [Thread-1 (]: Database Error in model patients_results (models/analysis/patients_results.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 0 unexpected 'FROM'.
  compiled code at target/run/caspar_health_technical_challenge/models/analysis/patients_results.sql
[0m12:59:35.185609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e40f34a-9945-40a6-a093-0c80e7f2736b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094736b0>]}
[0m12:59:35.186409 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analysis.patients_results ................. [[31mERROR[0m in 0.66s]
[0m12:59:35.187110 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_results
[0m12:59:35.189270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:35.189823 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.patients_results' was properly closed.
[0m12:59:35.190247 [info ] [MainThread]: 
[0m12:59:35.190704 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.37 seconds (4.37s).
[0m12:59:35.191807 [debug] [MainThread]: Command end result
[0m12:59:35.230783 [info ] [MainThread]: 
[0m12:59:35.232545 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:59:35.233575 [info ] [MainThread]: 
[0m12:59:35.234229 [error] [MainThread]:   Database Error in model patients_results (models/analysis/patients_results.sql)
  001003 (42000): SQL compilation error:
  syntax error line 15 at position 0 unexpected 'FROM'.
  compiled code at target/run/caspar_health_technical_challenge/models/analysis/patients_results.sql
[0m12:59:35.235122 [info ] [MainThread]: 
[0m12:59:35.235768 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:59:35.236436 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.155807, "process_in_blocks": "0", "process_kernel_time": 0.725424, "process_mem_max_rss": "132943872", "process_out_blocks": "0", "process_user_time": 3.007151}
[0m12:59:35.236906 [debug] [MainThread]: Command `dbt run` failed at 12:59:35.236809 after 6.16 seconds
[0m12:59:35.237448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a678560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996a480>]}
[0m12:59:35.237881 [debug] [MainThread]: Flushing usage events
[0m13:00:47.686294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa1b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4c7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5384a0>]}


============================== 13:00:47.691450 | 4081a389-3bc4-4223-a721-1c14ecf10c26 ==============================
[0m13:00:47.691450 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:00:47.692377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select patients_results', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:00:48.156034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4081a389-3bc4-4223-a721-1c14ecf10c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089209b0>]}
[0m13:00:48.212160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4081a389-3bc4-4223-a721-1c14ecf10c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b50ae10>]}
[0m13:00:48.213357 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:00:48.341148 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:00:48.531249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:00:48.532060 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/patients_results.sql
[0m13:00:48.750898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4081a389-3bc4-4223-a721-1c14ecf10c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5ea540>]}
[0m13:00:48.842517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4081a389-3bc4-4223-a721-1c14ecf10c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3b7c80>]}
[0m13:00:48.843044 [info ] [MainThread]: Found 3 seeds, 5 models, 577 macros
[0m13:00:48.843418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4081a389-3bc4-4223-a721-1c14ecf10c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5e6120>]}
[0m13:00:48.844993 [info ] [MainThread]: 
[0m13:00:48.845565 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:00:48.846505 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m13:00:48.858950 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m13:00:48.859366 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m13:00:48.859737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:49.438186 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.578 seconds
[0m13:00:49.443301 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m13:00:49.669764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_analysis)
[0m13:00:49.680485 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m13:00:49.681052 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m13:00:49.681394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:50.085620 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.404 seconds
[0m13:00:50.090198 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m13:00:50.285309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_transform)
[0m13:00:50.289292 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m13:00:50.290072 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m13:00:50.290628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:51.271301 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.980 seconds
[0m13:00:51.276281 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m13:00:51.548230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m13:00:51.555909 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m13:00:51.557461 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m13:00:51.558298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:52.974377 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.416 seconds
[0m13:00:52.978109 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m13:00:53.076565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4081a389-3bc4-4223-a721-1c14ecf10c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3b7b00>]}
[0m13:00:53.077544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:00:53.078133 [info ] [MainThread]: 
[0m13:00:53.080851 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_results
[0m13:00:53.081643 [info ] [Thread-1 (]: 1 of 1 START sql view model analysis.patients_results .......................... [RUN]
[0m13:00:53.082332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.patients_results)
[0m13:00:53.082857 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.patients_results
[0m13:00:53.093714 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.patients_results"
[0m13:00:53.096067 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.patients_results
[0m13:00:53.165868 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m13:00:53.166379 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
show parameters like 'query_tag' in session
[0m13:00:53.166725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:54.461377 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.294 seconds
[0m13:00:54.464728 [debug] [Thread-1 (]: Setting query_tag to 'patients_results'. Will reset to '' after materialization.
[0m13:00:54.465933 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m13:00:54.466650 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
alter session set query_tag = 'patients_results'
[0m13:00:54.551571 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m13:00:54.587846 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.patients_results"
[0m13:00:54.589571 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m13:00:54.590073 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
create or replace   view CASPAR_HEALTH.analysis.patients_results
  
   as (
    WITH top_minutes_patient AS (
SELECT
  MAX_BY(patients_grouped.id, patients_grouped.total_minutes) AS id
FROM CASPAR_HEALTH.analysis.patients_grouped
  AS patients_grouped
)

SELECT
top_minutes_patient.*,
dim_patients.*
FROM top_minutes_patient
LEFT JOIN CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
  ON dim_patients.id =   top_minutes_patient.id
  );
[0m13:00:54.869142 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a0f0-0203-b576-0003-18c200010e1a
[0m13:00:54.869810 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'ID'
[0m13:00:54.870529 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: Close
[0m13:00:55.018049 [debug] [Thread-1 (]: Database Error in model patients_results (models/analysis/patients_results.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'ID'
  compiled code at target/run/caspar_health_technical_challenge/models/analysis/patients_results.sql
[0m13:00:55.021203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4081a389-3bc4-4223-a721-1c14ecf10c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4f0860>]}
[0m13:00:55.022409 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analysis.patients_results ................. [[31mERROR[0m in 1.94s]
[0m13:00:55.023900 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_results
[0m13:00:55.027081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:55.027680 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.patients_results' was properly closed.
[0m13:00:55.028198 [info ] [MainThread]: 
[0m13:00:55.028739 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.18 seconds (6.18s).
[0m13:00:55.029763 [debug] [MainThread]: Command end result
[0m13:00:55.067584 [info ] [MainThread]: 
[0m13:00:55.068153 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:00:55.068545 [info ] [MainThread]: 
[0m13:00:55.068955 [error] [MainThread]:   Database Error in model patients_results (models/analysis/patients_results.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'ID'
  compiled code at target/run/caspar_health_technical_challenge/models/analysis/patients_results.sql
[0m13:00:55.069565 [info ] [MainThread]: 
[0m13:00:55.070372 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:00:55.071199 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.459194, "process_in_blocks": "0", "process_kernel_time": 0.482235, "process_mem_max_rss": "132800512", "process_out_blocks": "0", "process_user_time": 2.697671}
[0m13:00:55.072060 [debug] [MainThread]: Command `dbt run` failed at 13:00:55.071864 after 7.46 seconds
[0m13:00:55.072507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4c7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4c7b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4c7bf0>]}
[0m13:00:55.072991 [debug] [MainThread]: Flushing usage events
[0m13:01:24.700010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c69b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d158590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d158350>]}


============================== 13:01:24.707482 | 1e713fe6-39a8-4093-ba96-2c076ea53722 ==============================
[0m13:01:24.707482 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:01:24.708480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select patients_results', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:25.368756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e713fe6-39a8-4093-ba96-2c076ea53722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da8a750>]}
[0m13:01:25.446182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e713fe6-39a8-4093-ba96-2c076ea53722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6c7230>]}
[0m13:01:25.448097 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:01:25.617093 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:01:25.818299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:01:25.818961 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/patients_results.sql
[0m13:01:26.058463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e713fe6-39a8-4093-ba96-2c076ea53722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd97830>]}
[0m13:01:26.168692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e713fe6-39a8-4093-ba96-2c076ea53722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfdf8f0>]}
[0m13:01:26.169236 [info ] [MainThread]: Found 3 seeds, 5 models, 577 macros
[0m13:01:26.169624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e713fe6-39a8-4093-ba96-2c076ea53722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e253680>]}
[0m13:01:26.171251 [info ] [MainThread]: 
[0m13:01:26.171843 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:01:26.172772 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m13:01:26.186636 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m13:01:26.187090 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m13:01:26.187422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:27.817528 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.630 seconds
[0m13:01:27.821992 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m13:01:27.923225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:27.924308 [debug] [MainThread]: Connection 'list_CASPAR_HEALTH' was properly closed.
[0m13:01:27.925238 [info ] [MainThread]: 
[0m13:01:27.926252 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m13:01:27.927519 [error] [MainThread]: Encountered an error:

[0m13:01:27.939102 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
              ^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 486, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/run.py", line 459, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/task/runnable.py", line 626, in create_schemas
    for ls_future in as_completed(list_futures):
  File "/Users/jonfernandez/.local/share/uv/python/cpython-3.12.0-macos-x86_64-none/lib/python3.12/concurrent/futures/_base.py", line 243, in as_completed
    waiter.event.wait(wait_timeout)
  File "/Users/jonfernandez/.local/share/uv/python/cpython-3.12.0-macos-x86_64-none/lib/python3.12/threading.py", line 634, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/.local/share/uv/python/cpython-3.12.0-macos-x86_64-none/lib/python3.12/threading.py", line 334, in wait
    waiter.acquire()
KeyboardInterrupt

[0m13:01:27.943836 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.335014, "process_in_blocks": "0", "process_kernel_time": 0.576334, "process_mem_max_rss": "130940928", "process_out_blocks": "0", "process_user_time": 2.453084}
[0m13:01:27.945241 [debug] [MainThread]: Command `dbt run` failed at 13:01:27.944891 after 3.34 seconds
[0m13:01:27.946144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1582f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e51c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e51ef60>]}
[0m13:01:27.946874 [debug] [MainThread]: Flushing usage events
[0m13:01:31.007816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e60edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f12c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f12c4a0>]}


============================== 13:01:31.013150 | ca22123a-cb0f-4618-be12-e5981c322964 ==============================
[0m13:01:31.013150 [info ] [MainThread]: Running with dbt=1.8.9
[0m13:01:31.013811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select patients_results', 'send_anonymous_usage_stats': 'True'}
[0m13:01:31.523414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca22123a-cb0f-4618-be12-e5981c322964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb27e00>]}
[0m13:01:31.586382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca22123a-cb0f-4618-be12-e5981c322964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa58470>]}
[0m13:01:31.587728 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m13:01:31.732896 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m13:01:31.880821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:01:31.881508 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/patients_results.sql
[0m13:01:32.115078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca22123a-cb0f-4618-be12-e5981c322964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11008fad0>]}
[0m13:01:32.241218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca22123a-cb0f-4618-be12-e5981c322964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fed48c0>]}
[0m13:01:32.241813 [info ] [MainThread]: Found 3 seeds, 5 models, 577 macros
[0m13:01:32.242238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca22123a-cb0f-4618-be12-e5981c322964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df81910>]}
[0m13:01:32.243851 [info ] [MainThread]: 
[0m13:01:32.245042 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:01:32.246499 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m13:01:32.260193 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m13:01:32.260777 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m13:01:32.261517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:33.646770 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.385 seconds
[0m13:01:33.648911 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m13:01:33.780964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_analysis)
[0m13:01:33.792122 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m13:01:33.792735 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m13:01:33.793117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:34.192633 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.399 seconds
[0m13:01:34.195558 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m13:01:34.569061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_public)
[0m13:01:34.574080 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m13:01:34.574968 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m13:01:34.575724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:36.315405 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.740 seconds
[0m13:01:36.330501 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m13:01:36.410980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_transform)
[0m13:01:36.415622 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m13:01:36.416381 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m13:01:36.417062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:37.233786 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.816 seconds
[0m13:01:37.240453 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m13:01:37.340333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca22123a-cb0f-4618-be12-e5981c322964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c510830>]}
[0m13:01:37.341155 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:01:37.341686 [info ] [MainThread]: 
[0m13:01:37.349265 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_results
[0m13:01:37.350416 [info ] [Thread-1 (]: 1 of 1 START sql view model analysis.patients_results .......................... [RUN]
[0m13:01:37.368739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now model.caspar_health_technical_challenge.patients_results)
[0m13:01:37.369500 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.patients_results
[0m13:01:37.384926 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.patients_results"
[0m13:01:37.386131 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.patients_results
[0m13:01:37.511644 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m13:01:37.512456 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
show parameters like 'query_tag' in session
[0m13:01:37.513239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:38.110401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m13:01:38.113115 [debug] [Thread-1 (]: Setting query_tag to 'patients_results'. Will reset to '' after materialization.
[0m13:01:38.114880 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m13:01:38.115606 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
alter session set query_tag = 'patients_results'
[0m13:01:38.179415 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.063 seconds
[0m13:01:38.208333 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.patients_results"
[0m13:01:38.210503 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m13:01:38.211392 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
create or replace   view CASPAR_HEALTH.analysis.patients_results
  
   as (
    WITH top_minutes_patient AS (
SELECT
  MAX_BY(patients_grouped.id, patients_grouped.total_minutes) AS id
FROM CASPAR_HEALTH.analysis.patients_grouped
  AS patients_grouped
)

SELECT
  top_minutes_patient.id,
  dim_patients.first_name,
  dim_patients.last_name,
  dim_patients.country
FROM top_minutes_patient
LEFT JOIN CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
  ON dim_patients.id =   top_minutes_patient.id
  );
[0m13:01:38.844844 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m13:01:38.982715 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: Close
[0m13:01:39.108134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca22123a-cb0f-4618-be12-e5981c322964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e66f590>]}
[0m13:01:39.108980 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analysis.patients_results ..................... [[32mSUCCESS 1[0m in 1.74s]
[0m13:01:39.109803 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_results
[0m13:01:39.111429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:39.111853 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.patients_results' was properly closed.
[0m13:01:39.112194 [info ] [MainThread]: 
[0m13:01:39.112817 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.87 seconds (6.87s).
[0m13:01:39.113936 [debug] [MainThread]: Command end result
[0m13:01:39.221193 [info ] [MainThread]: 
[0m13:01:39.221959 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:39.222736 [info ] [MainThread]: 
[0m13:01:39.223277 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:01:39.224161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.293223, "process_in_blocks": "0", "process_kernel_time": 0.505006, "process_mem_max_rss": "132075520", "process_out_blocks": "0", "process_user_time": 2.847075}
[0m13:01:39.224762 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:39.224667 after 8.29 seconds
[0m13:01:39.225207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec0faa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101245f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e722b70>]}
[0m13:01:39.225634 [debug] [MainThread]: Flushing usage events
[0m14:27:55.903086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e3e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575c230>]}


============================== 14:27:55.910003 | 06f176fa-46fb-4f53-8e2c-0dd95e0678d3 ==============================
[0m14:27:55.910003 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:27:55.910844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:27:56.578325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06f176fa-46fb-4f53-8e2c-0dd95e0678d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d30980>]}
[0m14:27:56.640112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06f176fa-46fb-4f53-8e2c-0dd95e0678d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106084590>]}
[0m14:27:56.642933 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:27:56.798855 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:27:57.025181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:27:57.025872 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://models/transform/schema.yml
[0m14:27:57.161154 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:27:57.233725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06f176fa-46fb-4f53-8e2c-0dd95e0678d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106861430>]}
[0m14:27:57.381419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06f176fa-46fb-4f53-8e2c-0dd95e0678d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a47560>]}
[0m14:27:57.381971 [info ] [MainThread]: Found 3 seeds, 5 models, 577 macros
[0m14:27:57.382355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06f176fa-46fb-4f53-8e2c-0dd95e0678d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653d520>]}
[0m14:27:57.384128 [info ] [MainThread]: 
[0m14:27:57.384619 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:27:57.385494 [debug] [MainThread]: Command end result
[0m14:27:57.420969 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.6090105, "process_in_blocks": "0", "process_kernel_time": 0.4342, "process_mem_max_rss": "126201856", "process_out_blocks": "0", "process_user_time": 2.204604}
[0m14:27:57.421729 [debug] [MainThread]: Command `dbt test` succeeded at 14:27:57.421588 after 1.61 seconds
[0m14:27:57.422317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10634d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575c2c0>]}
[0m14:27:57.422821 [debug] [MainThread]: Flushing usage events
[0m14:28:34.930081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107417680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f38380>]}


============================== 14:28:34.935438 | 2dbe08ad-c54a-4926-a0c0-09fd9ca87ca1 ==============================
[0m14:28:34.935438 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:28:34.936039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:28:35.390119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dbe08ad-c54a-4926-a0c0-09fd9ca87ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f08770>]}
[0m14:28:35.449958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2dbe08ad-c54a-4926-a0c0-09fd9ca87ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108363470>]}
[0m14:28:35.451120 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:28:35.597020 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:28:35.751156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:35.751633 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:35.787375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2dbe08ad-c54a-4926-a0c0-09fd9ca87ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a77620>]}
[0m14:28:35.894974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2dbe08ad-c54a-4926-a0c0-09fd9ca87ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbf9b0>]}
[0m14:28:35.895489 [info ] [MainThread]: Found 3 seeds, 5 models, 577 macros
[0m14:28:35.895860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dbe08ad-c54a-4926-a0c0-09fd9ca87ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a764b0>]}
[0m14:28:35.897734 [info ] [MainThread]: 
[0m14:28:35.898353 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:28:35.902676 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m14:28:35.919062 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:28:35.919543 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:28:35.919873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:36.908901 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.989 seconds
[0m14:28:36.912638 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:28:37.094883 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:28:37.095545 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:28:37.096012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:37.642891 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.547 seconds
[0m14:28:37.647035 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:28:37.786901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m14:28:37.802851 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m14:28:37.803424 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m14:28:37.803870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:38.551089 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.747 seconds
[0m14:28:38.554778 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m14:28:38.657724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_transform)
[0m14:28:38.661798 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m14:28:38.662339 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m14:28:38.662785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:39.184985 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.522 seconds
[0m14:28:39.187627 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m14:28:39.275442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_analysis)
[0m14:28:39.280396 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m14:28:39.281098 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m14:28:39.281624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:39.747978 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.466 seconds
[0m14:28:39.751375 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m14:28:39.844372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2dbe08ad-c54a-4926-a0c0-09fd9ca87ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082aa300>]}
[0m14:28:39.845620 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:39.846590 [info ] [MainThread]: 
[0m14:28:39.852077 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.dim_patients
[0m14:28:39.852839 [info ] [Thread-1 (]: 1 of 5 START sql view model transform.dim_patients ............................. [RUN]
[0m14:28:39.853481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now model.caspar_health_technical_challenge.dim_patients)
[0m14:28:39.854409 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.dim_patients
[0m14:28:39.864511 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:28:39.868867 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.dim_patients
[0m14:28:39.879510 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:28:39.880143 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
show parameters like 'query_tag' in session
[0m14:28:39.880543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:40.180838 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.300 seconds
[0m14:28:40.183872 [debug] [Thread-1 (]: Setting query_tag to 'dim_patients'. Will reset to '' after materialization.
[0m14:28:40.186337 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:28:40.187534 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
alter session set query_tag = 'dim_patients'
[0m14:28:40.305137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.117 seconds
[0m14:28:40.345042 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:28:40.345548 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
    ) as __dbt_sbq
    where false
    limit 0
[0m14:28:41.022944 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.677 seconds
[0m14:28:41.047763 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:28:41.048690 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id
    ) as __dbt_sbq
    where false
    limit 0
[0m14:28:41.200850 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.151 seconds
[0m14:28:41.206871 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: Close
[0m14:28:41.306865 [debug] [Thread-1 (]: Compilation Error in model dim_patients (models/transform/dim_patients.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason     |
  | ----------- | --------------- | ------------- | ------------------- |
  | COUNTRY     | TEXT            |               | missing in contract |
  | FIRST_NAME  | TEXT            |               | missing in contract |
  | LAST_NAME   | TEXT            |               | missing in contract |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro snowflake__create_view_as_with_temp_flag (macros/relations/view/create.sql)
  > called by macro snowflake__create_view_as (macros/relations/view/create.sql)
  > called by macro create_view_as (macros/relations/view/create.sql)
  > called by macro default__get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro snowflake__create_or_replace_view (macros/relations/view/create.sql)
  > called by macro materialization_view_snowflake (macros/materializations/view.sql)
  > called by model dim_patients (models/transform/dim_patients.sql)
[0m14:28:41.309321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dbe08ad-c54a-4926-a0c0-09fd9ca87ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c0c50>]}
[0m14:28:41.310190 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model transform.dim_patients .................... [[31mERROR[0m in 1.45s]
[0m14:28:41.310962 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.dim_patients
[0m14:28:41.311408 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_exercises
[0m14:28:41.313075 [info ] [Thread-1 (]: 2 of 5 START sql view model transform.fct_exercises ............................ [RUN]
[0m14:28:41.313660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.dim_patients, now model.caspar_health_technical_challenge.fct_exercises)
[0m14:28:41.314027 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_exercises
[0m14:28:41.316840 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_exercises"
[0m14:28:41.319579 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_exercises
[0m14:28:41.322519 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:28:41.323011 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
show parameters like 'query_tag' in session
[0m14:28:41.323366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:41.689586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.366 seconds
[0m14:28:41.691181 [debug] [Thread-1 (]: Setting query_tag to 'fct_exercises'. Will reset to '' after materialization.
[0m14:28:41.692060 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:28:41.692513 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
alter session set query_tag = 'fct_exercises'
[0m14:28:41.775431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.082 seconds
[0m14:28:41.777463 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_exercises"
[0m14:28:41.779767 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:28:41.780236 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
create or replace   view CASPAR_HEALTH.transform.fct_exercises
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    minutes,
    completed_at::TIMESTAMP_TZ AS completed_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_exercises
  );
[0m14:28:42.147423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.367 seconds
[0m14:28:42.173968 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: Close
[0m14:28:42.249783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dbe08ad-c54a-4926-a0c0-09fd9ca87ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10895ae40>]}
[0m14:28:42.250608 [info ] [Thread-1 (]: 2 of 5 OK created sql view model transform.fct_exercises ....................... [[32mSUCCESS 1[0m in 0.94s]
[0m14:28:42.251271 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_exercises
[0m14:28:42.251763 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_steps
[0m14:28:42.252403 [info ] [Thread-1 (]: 3 of 5 START sql view model transform.fct_steps ................................ [RUN]
[0m14:28:42.253066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.fct_exercises, now model.caspar_health_technical_challenge.fct_steps)
[0m14:28:42.253506 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_steps
[0m14:28:42.257006 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_steps"
[0m14:28:42.261349 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_steps
[0m14:28:42.264013 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:28:42.264487 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
show parameters like 'query_tag' in session
[0m14:28:42.265041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:42.579251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.314 seconds
[0m14:28:42.580777 [debug] [Thread-1 (]: Setting query_tag to 'fct_steps'. Will reset to '' after materialization.
[0m14:28:42.581549 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:28:42.581978 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
alter session set query_tag = 'fct_steps'
[0m14:28:42.809348 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.227 seconds
[0m14:28:42.811554 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_steps"
[0m14:28:42.815088 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:28:42.815784 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
create or replace   view CASPAR_HEALTH.transform.fct_steps
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    steps,
    TRY_TO_TIMESTAMP_TZ(submission_time, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS submitted_at,
    TRY_TO_TIMESTAMP_TZ(updated_at, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
  );
[0m14:28:43.096540 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.280 seconds
[0m14:28:43.098838 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: Close
[0m14:28:43.185789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2dbe08ad-c54a-4926-a0c0-09fd9ca87ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104795670>]}
[0m14:28:43.186850 [info ] [Thread-1 (]: 3 of 5 OK created sql view model transform.fct_steps ........................... [[32mSUCCESS 1[0m in 0.93s]
[0m14:28:43.187770 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_steps
[0m14:28:43.188962 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_grouped
[0m14:28:43.189689 [info ] [Thread-1 (]: 4 of 5 SKIP relation analysis.patients_grouped ................................. [[33mSKIP[0m]
[0m14:28:43.190261 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_grouped
[0m14:28:43.191178 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_results
[0m14:28:43.191846 [info ] [Thread-1 (]: 5 of 5 SKIP relation analysis.patients_results ................................. [[33mSKIP[0m]
[0m14:28:43.192710 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_results
[0m14:28:43.194007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:43.194604 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.fct_steps' was properly closed.
[0m14:28:43.195207 [info ] [MainThread]: 
[0m14:28:43.195740 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.30 seconds (7.30s).
[0m14:28:43.197338 [debug] [MainThread]: Command end result
[0m14:28:43.304581 [info ] [MainThread]: 
[0m14:28:43.305167 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:28:43.305565 [info ] [MainThread]: 
[0m14:28:43.306015 [error] [MainThread]:   Compilation Error in model dim_patients (models/transform/dim_patients.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason     |
  | ----------- | --------------- | ------------- | ------------------- |
  | COUNTRY     | TEXT            |               | missing in contract |
  | FIRST_NAME  | TEXT            |               | missing in contract |
  | LAST_NAME   | TEXT            |               | missing in contract |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro snowflake__create_view_as_with_temp_flag (macros/relations/view/create.sql)
  > called by macro snowflake__create_view_as (macros/relations/view/create.sql)
  > called by macro create_view_as (macros/relations/view/create.sql)
  > called by macro default__get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro snowflake__create_or_replace_view (macros/relations/view/create.sql)
  > called by macro materialization_view_snowflake (macros/materializations/view.sql)
  > called by model dim_patients (models/transform/dim_patients.sql)
[0m14:28:43.306570 [info ] [MainThread]: 
[0m14:28:43.307060 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m14:28:43.307740 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.446318, "process_in_blocks": "0", "process_kernel_time": 0.486653, "process_mem_max_rss": "130551808", "process_out_blocks": "0", "process_user_time": 2.744162}
[0m14:28:43.308308 [debug] [MainThread]: Command `dbt run` failed at 14:28:43.308190 after 8.45 seconds
[0m14:28:43.308718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075680b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053803e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107417680>]}
[0m14:28:43.309102 [debug] [MainThread]: Flushing usage events
[0m14:30:37.022877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e35e570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113786e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113784a0>]}


============================== 14:30:37.030532 | 16172010-d6c0-43cc-a3f8-b733a7309e3b ==============================
[0m14:30:37.030532 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:30:37.031194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:30:37.708318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16172010-d6c0-43cc-a3f8-b733a7309e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bc5850>]}
[0m14:30:37.764806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16172010-d6c0-43cc-a3f8-b733a7309e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e36c30>]}
[0m14:30:37.767189 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:30:37.917097 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:30:38.143893 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
[0m14:30:38.144637 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/schema.yml
[0m14:30:38.382201 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:30:38.454469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16172010-d6c0-43cc-a3f8-b733a7309e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124f37d0>]}
[0m14:30:38.565755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16172010-d6c0-43cc-a3f8-b733a7309e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f12b0>]}
[0m14:30:38.566298 [info ] [MainThread]: Found 3 seeds, 5 models, 577 macros
[0m14:30:38.566651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16172010-d6c0-43cc-a3f8-b733a7309e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11230da60>]}
[0m14:30:38.568543 [info ] [MainThread]: 
[0m14:30:38.569124 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:30:38.574158 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m14:30:38.588351 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:30:38.588899 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:30:38.589214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:39.528414 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.939 seconds
[0m14:30:39.531452 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:30:39.617412 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:30:39.618137 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:30:39.618630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:39.942930 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.324 seconds
[0m14:30:39.945179 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:30:40.041885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m14:30:40.053810 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m14:30:40.054343 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m14:30:40.054761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:40.534742 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.480 seconds
[0m14:30:40.538457 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m14:30:40.621297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_analysis)
[0m14:30:40.625476 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m14:30:40.627014 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m14:30:40.627943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:40.982398 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.354 seconds
[0m14:30:40.986738 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m14:30:41.099444 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_transform)
[0m14:30:41.104581 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m14:30:41.105255 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m14:30:41.105851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:41.425546 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.320 seconds
[0m14:30:41.429171 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m14:30:41.533005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16172010-d6c0-43cc-a3f8-b733a7309e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e770740>]}
[0m14:30:41.533923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:30:41.534491 [info ] [MainThread]: 
[0m14:30:41.538872 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.dim_patients
[0m14:30:41.539666 [info ] [Thread-1 (]: 1 of 5 START sql view model transform.dim_patients ............................. [RUN]
[0m14:30:41.540354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now model.caspar_health_technical_challenge.dim_patients)
[0m14:30:41.540869 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.dim_patients
[0m14:30:41.552352 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:30:41.556552 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.dim_patients
[0m14:30:41.566249 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:30:41.566838 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
show parameters like 'query_tag' in session
[0m14:30:41.567346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:42.437818 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.871 seconds
[0m14:30:42.439374 [debug] [Thread-1 (]: Setting query_tag to 'dim_patients'. Will reset to '' after materialization.
[0m14:30:42.440692 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:30:42.441201 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
alter session set query_tag = 'dim_patients'
[0m14:30:42.583389 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.142 seconds
[0m14:30:42.627615 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:30:42.628326 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
    ) as __dbt_sbq
    where false
    limit 0
[0m14:30:42.788877 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.160 seconds
[0m14:30:42.802300 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:30:42.802929 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country
    ) as __dbt_sbq
    where false
    limit 0
[0m14:30:42.883696 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.080 seconds
[0m14:30:42.889258 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:30:42.892820 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:30:42.893280 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
create or replace   view CASPAR_HEALTH.transform.dim_patients
  
   as (
    SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
  );
[0m14:30:43.287443 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m14:30:43.311745 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: Close
[0m14:30:43.384954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16172010-d6c0-43cc-a3f8-b733a7309e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108bb680>]}
[0m14:30:43.385829 [info ] [Thread-1 (]: 1 of 5 OK created sql view model transform.dim_patients ........................ [[32mSUCCESS 1[0m in 1.84s]
[0m14:30:43.386662 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.dim_patients
[0m14:30:43.387178 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_exercises
[0m14:30:43.387808 [info ] [Thread-1 (]: 2 of 5 START sql view model transform.fct_exercises ............................ [RUN]
[0m14:30:43.388419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.dim_patients, now model.caspar_health_technical_challenge.fct_exercises)
[0m14:30:43.388851 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_exercises
[0m14:30:43.392002 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_exercises"
[0m14:30:43.394194 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_exercises
[0m14:30:43.397052 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:30:43.397626 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
show parameters like 'query_tag' in session
[0m14:30:43.398166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:43.760774 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.363 seconds
[0m14:30:43.762418 [debug] [Thread-1 (]: Setting query_tag to 'fct_exercises'. Will reset to '' after materialization.
[0m14:30:43.763136 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:30:43.763618 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
alter session set query_tag = 'fct_exercises'
[0m14:30:44.108643 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.345 seconds
[0m14:30:44.110830 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_exercises"
[0m14:30:44.112359 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:30:44.112944 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
create or replace   view CASPAR_HEALTH.transform.fct_exercises
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    minutes,
    completed_at::TIMESTAMP_TZ AS completed_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_exercises
  );
[0m14:30:45.234337 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.121 seconds
[0m14:30:45.240567 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: Close
[0m14:30:45.338817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16172010-d6c0-43cc-a3f8-b733a7309e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11210b410>]}
[0m14:30:45.340970 [info ] [Thread-1 (]: 2 of 5 OK created sql view model transform.fct_exercises ....................... [[32mSUCCESS 1[0m in 1.95s]
[0m14:30:45.342758 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_exercises
[0m14:30:45.343747 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_steps
[0m14:30:45.345023 [info ] [Thread-1 (]: 3 of 5 START sql view model transform.fct_steps ................................ [RUN]
[0m14:30:45.346165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.fct_exercises, now model.caspar_health_technical_challenge.fct_steps)
[0m14:30:45.347008 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_steps
[0m14:30:45.352155 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_steps"
[0m14:30:45.354943 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_steps
[0m14:30:45.360831 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:30:45.361622 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
show parameters like 'query_tag' in session
[0m14:30:45.362146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:45.702882 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.341 seconds
[0m14:30:45.706170 [debug] [Thread-1 (]: Setting query_tag to 'fct_steps'. Will reset to '' after materialization.
[0m14:30:45.707447 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:30:45.708163 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
alter session set query_tag = 'fct_steps'
[0m14:30:45.774381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.065 seconds
[0m14:30:45.777851 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_steps"
[0m14:30:45.780040 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:30:45.780782 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
create or replace   view CASPAR_HEALTH.transform.fct_steps
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    steps,
    TRY_TO_TIMESTAMP_TZ(submission_time, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS submitted_at,
    TRY_TO_TIMESTAMP_TZ(updated_at, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
  );
[0m14:30:46.257968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m14:30:46.260991 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: Close
[0m14:30:46.349511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16172010-d6c0-43cc-a3f8-b733a7309e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dacdc40>]}
[0m14:30:46.350615 [info ] [Thread-1 (]: 3 of 5 OK created sql view model transform.fct_steps ........................... [[32mSUCCESS 1[0m in 1.00s]
[0m14:30:46.351488 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_steps
[0m14:30:46.352597 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_grouped
[0m14:30:46.353611 [info ] [Thread-1 (]: 4 of 5 START sql view model analysis.patients_grouped .......................... [RUN]
[0m14:30:46.354395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.fct_steps, now model.caspar_health_technical_challenge.patients_grouped)
[0m14:30:46.355065 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.patients_grouped
[0m14:30:46.359688 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.patients_grouped"
[0m14:30:46.363682 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.patients_grouped
[0m14:30:46.366925 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_grouped"
[0m14:30:46.367516 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_grouped: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_grouped"} */
show parameters like 'query_tag' in session
[0m14:30:46.368027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:46.996327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.628 seconds
[0m14:30:46.998764 [debug] [Thread-1 (]: Setting query_tag to 'patients_grouped'. Will reset to '' after materialization.
[0m14:30:46.999736 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_grouped"
[0m14:30:47.000338 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_grouped: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_grouped"} */
alter session set query_tag = 'patients_grouped'
[0m14:30:47.106729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m14:30:47.110860 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.patients_grouped"
[0m14:30:47.114373 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_grouped"
[0m14:30:47.115237 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_grouped: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_grouped"} */
create or replace   view CASPAR_HEALTH.analysis.patients_grouped
  
   as (
    SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.steps * 0.002) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.steps * 0.002) AS total_minutes
FROM  CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.transform.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.transform.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
  );
[0m14:30:47.715750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m14:30:47.718981 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_grouped: Close
[0m14:30:47.810823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16172010-d6c0-43cc-a3f8-b733a7309e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dace510>]}
[0m14:30:47.811896 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analysis.patients_grouped ..................... [[32mSUCCESS 1[0m in 1.46s]
[0m14:30:47.812936 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_grouped
[0m14:30:47.814053 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_results
[0m14:30:47.814840 [info ] [Thread-1 (]: 5 of 5 START sql view model analysis.patients_results .......................... [RUN]
[0m14:30:47.815569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.patients_grouped, now model.caspar_health_technical_challenge.patients_results)
[0m14:30:47.816115 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.patients_results
[0m14:30:47.821202 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.patients_results"
[0m14:30:47.823486 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.patients_results
[0m14:30:47.826227 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m14:30:47.826729 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
show parameters like 'query_tag' in session
[0m14:30:47.827152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:48.130874 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.304 seconds
[0m14:30:48.132492 [debug] [Thread-1 (]: Setting query_tag to 'patients_results'. Will reset to '' after materialization.
[0m14:30:48.133237 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m14:30:48.133674 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
alter session set query_tag = 'patients_results'
[0m14:30:48.203117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.069 seconds
[0m14:30:48.208058 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.patients_results"
[0m14:30:48.211314 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m14:30:48.212238 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
create or replace   view CASPAR_HEALTH.analysis.patients_results
  
   as (
    WITH top_minutes_patient AS (
SELECT
  MAX_BY(patients_grouped.id, patients_grouped.total_minutes) AS id
FROM CASPAR_HEALTH.analysis.patients_grouped
  AS patients_grouped
)

SELECT
  top_minutes_patient.id,
  dim_patients.first_name,
  dim_patients.last_name,
  dim_patients.country
FROM top_minutes_patient
LEFT JOIN CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
  ON dim_patients.id =   top_minutes_patient.id
  );
[0m14:30:48.508655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.295 seconds
[0m14:30:48.512367 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: Close
[0m14:30:48.616669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16172010-d6c0-43cc-a3f8-b733a7309e3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127a2270>]}
[0m14:30:48.618158 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analysis.patients_results ..................... [[32mSUCCESS 1[0m in 0.80s]
[0m14:30:48.619558 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_results
[0m14:30:48.622066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:48.622781 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.patients_results' was properly closed.
[0m14:30:48.623850 [info ] [MainThread]: 
[0m14:30:48.624672 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 10.05 seconds (10.05s).
[0m14:30:48.627194 [debug] [MainThread]: Command end result
[0m14:30:48.672491 [info ] [MainThread]: 
[0m14:30:48.673061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:30:48.673452 [info ] [MainThread]: 
[0m14:30:48.673811 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:30:48.674441 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.733151, "process_in_blocks": "0", "process_kernel_time": 0.63058, "process_mem_max_rss": "134774784", "process_out_blocks": "0", "process_user_time": 3.251517}
[0m14:30:48.674989 [debug] [MainThread]: Command `dbt run` succeeded at 14:30:48.674880 after 11.73 seconds
[0m14:30:48.675392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112220860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e35e570>]}
[0m14:30:48.675798 [debug] [MainThread]: Flushing usage events
[0m14:34:51.927400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113bd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e40650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e40410>]}


============================== 14:34:51.934283 | 70b205f5-af41-473d-85a6-c166ef8b8f61 ==============================
[0m14:34:51.934283 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:34:51.934937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:34:52.718454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70b205f5-af41-473d-85a6-c166ef8b8f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e0cad0>]}
[0m14:34:52.795829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70b205f5-af41-473d-85a6-c166ef8b8f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11285c2c0>]}
[0m14:34:52.797607 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:34:52.967288 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:34:53.077445 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:34:53.078060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '70b205f5-af41-473d-85a6-c166ef8b8f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c884d0>]}
[0m14:34:54.602243 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:34:54.684717 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.dim_patients
[0m14:34:54.689990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70b205f5-af41-473d-85a6-c166ef8b8f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128fb080>]}
[0m14:34:54.806425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70b205f5-af41-473d-85a6-c166ef8b8f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f475f0>]}
[0m14:34:54.807229 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m14:34:54.807736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70b205f5-af41-473d-85a6-c166ef8b8f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ed7fe0>]}
[0m14:34:54.809955 [info ] [MainThread]: 
[0m14:34:54.810705 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:34:54.816934 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m14:34:54.831787 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:34:54.832260 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:34:54.833024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:55.441627 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.609 seconds
[0m14:34:55.445765 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:34:55.870913 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:34:55.871907 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:34:55.872753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:56.186109 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.313 seconds
[0m14:34:56.189345 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:34:56.308818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_analysis)
[0m14:34:56.325118 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m14:34:56.325798 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m14:34:56.326309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:56.762885 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.436 seconds
[0m14:34:56.765922 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m14:34:56.853285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_transform)
[0m14:34:56.859797 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m14:34:56.861175 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m14:34:56.862095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:57.419678 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.557 seconds
[0m14:34:57.423786 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m14:34:57.505687 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m14:34:57.511859 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m14:34:57.512536 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m14:34:57.513119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:57.906429 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.393 seconds
[0m14:34:57.909147 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m14:34:58.020258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70b205f5-af41-473d-85a6-c166ef8b8f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e6f620>]}
[0m14:34:58.020965 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:34:58.021390 [info ] [MainThread]: 
[0m14:34:58.025118 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.dim_patients
[0m14:34:58.025744 [info ] [Thread-1 (]: 1 of 5 START sql view model transform.dim_patients ............................. [RUN]
[0m14:34:58.026217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.dim_patients)
[0m14:34:58.026602 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.dim_patients
[0m14:34:58.034505 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:34:58.038404 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.dim_patients
[0m14:34:58.047603 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:34:58.048086 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
show parameters like 'query_tag' in session
[0m14:34:58.048623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:58.417597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.369 seconds
[0m14:34:58.420662 [debug] [Thread-1 (]: Setting query_tag to 'dim_patients'. Will reset to '' after materialization.
[0m14:34:58.422432 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:34:58.423261 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
alter session set query_tag = 'dim_patients'
[0m14:34:58.487349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.063 seconds
[0m14:34:58.535946 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:34:58.536434 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
    ) as __dbt_sbq
    where false
    limit 0
[0m14:34:58.634578 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.098 seconds
[0m14:34:58.646308 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:34:58.646799 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country
    ) as __dbt_sbq
    where false
    limit 0
[0m14:34:58.698874 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.052 seconds
[0m14:34:58.706533 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:34:58.756512 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:34:58.757411 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
create or replace   view CASPAR_HEALTH.transform.dim_patients
  
   as (
    SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
  );
[0m14:34:58.986749 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.229 seconds
[0m14:34:59.023081 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: Close
[0m14:34:59.132197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b205f5-af41-473d-85a6-c166ef8b8f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11285ef90>]}
[0m14:34:59.133474 [info ] [Thread-1 (]: 1 of 5 OK created sql view model transform.dim_patients ........................ [[32mSUCCESS 1[0m in 1.10s]
[0m14:34:59.134485 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.dim_patients
[0m14:34:59.135195 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_exercises
[0m14:34:59.136095 [info ] [Thread-1 (]: 2 of 5 START sql view model transform.fct_exercises ............................ [RUN]
[0m14:34:59.136917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.dim_patients, now model.caspar_health_technical_challenge.fct_exercises)
[0m14:34:59.137534 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_exercises
[0m14:34:59.141380 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_exercises"
[0m14:34:59.144370 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_exercises
[0m14:34:59.149126 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:34:59.149710 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
show parameters like 'query_tag' in session
[0m14:34:59.150227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:59.498116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.348 seconds
[0m14:34:59.500291 [debug] [Thread-1 (]: Setting query_tag to 'fct_exercises'. Will reset to '' after materialization.
[0m14:34:59.501269 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:34:59.501929 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
alter session set query_tag = 'fct_exercises'
[0m14:34:59.738914 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.236 seconds
[0m14:34:59.742241 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_exercises"
[0m14:34:59.744265 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:34:59.744950 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
create or replace   view CASPAR_HEALTH.transform.fct_exercises
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    minutes,
    completed_at::TIMESTAMP_TZ AS completed_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_exercises
  );
[0m14:34:59.934550 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.189 seconds
[0m14:34:59.937276 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: Close
[0m14:35:00.031007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b205f5-af41-473d-85a6-c166ef8b8f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113363740>]}
[0m14:35:00.032092 [info ] [Thread-1 (]: 2 of 5 OK created sql view model transform.fct_exercises ....................... [[32mSUCCESS 1[0m in 0.89s]
[0m14:35:00.033086 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_exercises
[0m14:35:00.033733 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_steps
[0m14:35:00.034852 [info ] [Thread-1 (]: 3 of 5 START sql view model transform.fct_steps ................................ [RUN]
[0m14:35:00.036139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.fct_exercises, now model.caspar_health_technical_challenge.fct_steps)
[0m14:35:00.037035 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_steps
[0m14:35:00.040760 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_steps"
[0m14:35:00.042927 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_steps
[0m14:35:00.045903 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:35:00.046459 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
show parameters like 'query_tag' in session
[0m14:35:00.047093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:00.391644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.344 seconds
[0m14:35:00.394586 [debug] [Thread-1 (]: Setting query_tag to 'fct_steps'. Will reset to '' after materialization.
[0m14:35:00.395817 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:35:00.396502 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
alter session set query_tag = 'fct_steps'
[0m14:35:00.454126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.057 seconds
[0m14:35:00.458935 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_steps"
[0m14:35:00.463096 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:35:00.464015 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
create or replace   view CASPAR_HEALTH.transform.fct_steps
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    steps,
    TRY_TO_TIMESTAMP_TZ(submission_time, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS submitted_at,
    TRY_TO_TIMESTAMP_TZ(updated_at, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
  );
[0m14:35:00.705563 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.241 seconds
[0m14:35:00.709566 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: Close
[0m14:35:00.822437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b205f5-af41-473d-85a6-c166ef8b8f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11329e510>]}
[0m14:35:00.823984 [info ] [Thread-1 (]: 3 of 5 OK created sql view model transform.fct_steps ........................... [[32mSUCCESS 1[0m in 0.79s]
[0m14:35:00.825060 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_steps
[0m14:35:00.826340 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_grouped
[0m14:35:00.827228 [info ] [Thread-1 (]: 4 of 5 START sql view model analysis.patients_grouped .......................... [RUN]
[0m14:35:00.828070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.fct_steps, now model.caspar_health_technical_challenge.patients_grouped)
[0m14:35:00.828678 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.patients_grouped
[0m14:35:00.834131 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.patients_grouped"
[0m14:35:00.836976 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.patients_grouped
[0m14:35:00.840938 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_grouped"
[0m14:35:00.841909 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_grouped: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_grouped"} */
show parameters like 'query_tag' in session
[0m14:35:00.842730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:01.160444 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m14:35:01.161920 [debug] [Thread-1 (]: Setting query_tag to 'patients_grouped'. Will reset to '' after materialization.
[0m14:35:01.162584 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_grouped"
[0m14:35:01.162966 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_grouped: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_grouped"} */
alter session set query_tag = 'patients_grouped'
[0m14:35:01.239867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.076 seconds
[0m14:35:01.242759 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.patients_grouped"
[0m14:35:01.245114 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_grouped"
[0m14:35:01.245780 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_grouped: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_grouped"} */
create or replace   view CASPAR_HEALTH.analysis.patients_grouped
  
   as (
    SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.steps * 0.002) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.steps * 0.002) AS total_minutes
FROM  CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.transform.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.transform.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
  );
[0m14:35:01.823323 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m14:35:01.826871 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_grouped: Close
[0m14:35:01.919846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b205f5-af41-473d-85a6-c166ef8b8f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11324a870>]}
[0m14:35:01.921066 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analysis.patients_grouped ..................... [[32mSUCCESS 1[0m in 1.09s]
[0m14:35:01.922207 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_grouped
[0m14:35:01.923667 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.patients_results
[0m14:35:01.924638 [info ] [Thread-1 (]: 5 of 5 START sql view model analysis.patients_results .......................... [RUN]
[0m14:35:01.925415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.patients_grouped, now model.caspar_health_technical_challenge.patients_results)
[0m14:35:01.926074 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.patients_results
[0m14:35:01.930549 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.patients_results"
[0m14:35:01.931829 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.patients_results
[0m14:35:01.934937 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m14:35:01.935475 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
show parameters like 'query_tag' in session
[0m14:35:01.935936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:02.326951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.391 seconds
[0m14:35:02.329828 [debug] [Thread-1 (]: Setting query_tag to 'patients_results'. Will reset to '' after materialization.
[0m14:35:02.331062 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m14:35:02.331753 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
alter session set query_tag = 'patients_results'
[0m14:35:02.451860 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m14:35:02.454171 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.patients_results"
[0m14:35:02.455947 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.patients_results"
[0m14:35:02.456582 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.patients_results"} */
create or replace   view CASPAR_HEALTH.analysis.patients_results
  
   as (
    WITH top_minutes_patient AS (
SELECT
  MAX_BY(patients_grouped.id, patients_grouped.total_minutes) AS id
FROM CASPAR_HEALTH.analysis.patients_grouped
  AS patients_grouped
)

SELECT
  top_minutes_patient.id,
  dim_patients.first_name,
  dim_patients.last_name,
  dim_patients.country
FROM top_minutes_patient
LEFT JOIN CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
  ON dim_patients.id =   top_minutes_patient.id
  );
[0m14:35:02.790647 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.333 seconds
[0m14:35:02.794708 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.patients_results: Close
[0m14:35:03.360835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b205f5-af41-473d-85a6-c166ef8b8f61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133dde50>]}
[0m14:35:03.362097 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analysis.patients_results ..................... [[32mSUCCESS 1[0m in 1.44s]
[0m14:35:03.363183 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.patients_results
[0m14:35:03.365052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:03.365587 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.patients_results' was properly closed.
[0m14:35:03.366183 [info ] [MainThread]: 
[0m14:35:03.366706 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 8.56 seconds (8.56s).
[0m14:35:03.369007 [debug] [MainThread]: Command end result
[0m14:35:03.405276 [info ] [MainThread]: 
[0m14:35:03.406003 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:03.407233 [info ] [MainThread]: 
[0m14:35:03.408008 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:35:03.409428 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.568248, "process_in_blocks": "0", "process_kernel_time": 0.676157, "process_mem_max_rss": "136912896", "process_out_blocks": "0", "process_user_time": 4.516378}
[0m14:35:03.411040 [debug] [MainThread]: Command `dbt run` succeeded at 14:35:03.410740 after 11.57 seconds
[0m14:35:03.412043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b62960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea71a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117d4980>]}
[0m14:35:03.413005 [debug] [MainThread]: Flushing usage events
[0m14:35:28.654133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f88c9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a3c590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a3c350>]}


============================== 14:35:28.659542 | e7e069c5-7830-4be0-86f4-e9c3a3d35712 ==============================
[0m14:35:28.659542 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:35:28.660169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:35:29.100884 [error] [MainThread]: Encountered an error:

[0m14:35:29.111242 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 234, in wrapper
    project = load_project(
              ^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/config/runtime.py", line 51, in load_project
    project = Project.from_project_root(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/config/project.py", line 765, in from_project_root
    return partial.render(renderer)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/config/project.py", line 335, in render
    return self.create_project(rendered)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/config/project.py", line 482, in create_project
    packages: PackageConfig = package_config_from_data(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/dbt/config/project.py", line 151, in package_config_from_data
    packages = PackageConfig.from_dict(packages_data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 3, in __mashumaro_from_dict__
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/mashumaro/core/meta/code/builder.py", line 584, in add_unpack_method
    self._add_unpack_method_lines(method_name)
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/mashumaro/core/meta/code/builder.py", line 489, in _add_unpack_method_lines
    ).build(
      ^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/mashumaro/core/meta/code/builder.py", line 1316, in build
    field_type = self.parent.get_type_name_identifier(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/mashumaro/core/meta/code/builder.py", line 228, in get_type_name_identifier
    field_type = type_name(typ, resolved_type_params=resolved_type_params)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/mashumaro/core/meta/helpers.py", line 248, in type_name
    args_str = _get_args_str(typ, short, resolved_type_params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/mashumaro/core/meta/helpers.py", line 144, in _get_args_str
    type_name(
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/mashumaro/core/meta/helpers.py", line 214, in type_name
    args_str = _get_args_str(
               ^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/mashumaro/core/meta/helpers.py", line 140, in _get_args_str
    args = _flatten_type_args(get_args(typ)[:limit])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/mashumaro/core/meta/helpers.py", line 516, in _flatten_type_args
    if is_unpack(type_arg):
       ^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/Documents/caspar_health_technical_challenge/.venv/lib/python3.12/site-packages/mashumaro/core/meta/helpers.py", line 703, in is_unpack
    with suppress(AttributeError):
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/jonfernandez/.local/share/uv/python/cpython-3.12.0-macos-x86_64-none/lib/python3.12/contextlib.py", line 428, in __init__
    def __init__(self, *exceptions):
    
KeyboardInterrupt

[0m14:35:29.114177 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.53064615, "process_in_blocks": "0", "process_kernel_time": 0.284881, "process_mem_max_rss": "110772224", "process_out_blocks": "0", "process_user_time": 1.5462}
[0m14:35:29.114759 [debug] [MainThread]: Command `dbt run` failed at 14:35:29.114638 after 0.53 seconds
[0m14:35:29.115148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11075faa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104b19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111458da0>]}
[0m14:35:29.115519 [debug] [MainThread]: Flushing usage events
[0m14:35:37.454029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104423b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f489b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f48770>]}


============================== 14:35:37.459315 | af4c4384-6220-4a2a-8e5e-30682ade160a ==============================
[0m14:35:37.459315 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:35:37.460084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_patients', 'send_anonymous_usage_stats': 'True'}
[0m14:35:37.917680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af4c4384-6220-4a2a-8e5e-30682ade160a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f16660>]}
[0m14:35:37.971021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af4c4384-6220-4a2a-8e5e-30682ade160a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056f2ff0>]}
[0m14:35:37.972211 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:35:38.104342 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:35:38.188782 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:35:38.189365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'af4c4384-6220-4a2a-8e5e-30682ade160a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c98380>]}
[0m14:35:39.511271 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:35:39.596294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af4c4384-6220-4a2a-8e5e-30682ade160a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106065970>]}
[0m14:35:39.681841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af4c4384-6220-4a2a-8e5e-30682ade160a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600e840>]}
[0m14:35:39.682358 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m14:35:39.682716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af4c4384-6220-4a2a-8e5e-30682ade160a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b4110>]}
[0m14:35:39.684213 [info ] [MainThread]: 
[0m14:35:39.684765 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:35:39.685610 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m14:35:39.699252 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:35:39.699705 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:35:39.700145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:40.403798 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.704 seconds
[0m14:35:40.406732 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:35:40.505562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now create_CASPAR_HEALTH_dim_patients)
[0m14:35:40.506777 [debug] [ThreadPool]: Creating schema "database: "CASPAR_HEALTH"
schema: "dim_patients"
"
[0m14:35:40.514689 [debug] [ThreadPool]: Using snowflake connection "create_CASPAR_HEALTH_dim_patients"
[0m14:35:40.515359 [debug] [ThreadPool]: On create_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "create_CASPAR_HEALTH_dim_patients"} */
create schema if not exists CASPAR_HEALTH.dim_patients
[0m14:35:40.515886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:40.897059 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.381 seconds
[0m14:35:40.899943 [debug] [ThreadPool]: On create_CASPAR_HEALTH_dim_patients: Close
[0m14:35:40.996196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_CASPAR_HEALTH_dim_patients, now list_CASPAR_HEALTH_public)
[0m14:35:41.005540 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m14:35:41.006190 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m14:35:41.006556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:41.452665 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.446 seconds
[0m14:35:41.455786 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m14:35:41.595420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_transform)
[0m14:35:41.600235 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m14:35:41.600830 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m14:35:41.601336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:41.914088 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.313 seconds
[0m14:35:41.916730 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m14:35:41.997223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_dim_patients)
[0m14:35:42.003341 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_dim_patients"
[0m14:35:42.003843 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_dim_patients"} */
show objects in CASPAR_HEALTH.dim_patients limit 10000
[0m14:35:42.004215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:42.463829 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.458 seconds
[0m14:35:42.491392 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: Close
[0m14:35:42.649321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_dim_patients, now list_CASPAR_HEALTH_analysis)
[0m14:35:42.652041 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m14:35:42.652462 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m14:35:42.652854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:43.070596 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.418 seconds
[0m14:35:43.074098 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m14:35:43.501461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af4c4384-6220-4a2a-8e5e-30682ade160a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b80f80>]}
[0m14:35:43.502546 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:35:43.503166 [info ] [MainThread]: 
[0m14:35:43.509262 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.dim_patients
[0m14:35:43.510424 [info ] [Thread-1 (]: 1 of 1 START sql view model dim_patients.dim_patients .......................... [RUN]
[0m14:35:43.511133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now model.caspar_health_technical_challenge.dim_patients)
[0m14:35:43.511668 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.dim_patients
[0m14:35:43.521657 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:35:43.524038 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.dim_patients
[0m14:35:43.535040 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:35:43.535679 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
show parameters like 'query_tag' in session
[0m14:35:43.536050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:43.978692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.442 seconds
[0m14:35:43.982273 [debug] [Thread-1 (]: Setting query_tag to 'dim_patients'. Will reset to '' after materialization.
[0m14:35:43.983655 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:35:43.984499 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
alter session set query_tag = 'dim_patients'
[0m14:35:44.063349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m14:35:44.116841 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:35:44.117341 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
    ) as __dbt_sbq
    where false
    limit 0
[0m14:35:44.226384 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.109 seconds
[0m14:35:44.238472 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:35:44.238993 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country
    ) as __dbt_sbq
    where false
    limit 0
[0m14:35:44.313543 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.074 seconds
[0m14:35:44.319287 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:35:44.321805 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:35:44.322248 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
create or replace   view CASPAR_HEALTH.dim_patients.dim_patients
  
   as (
    SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
  );
[0m14:35:44.728449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.406 seconds
[0m14:35:44.750239 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: Close
[0m14:35:44.824996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af4c4384-6220-4a2a-8e5e-30682ade160a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044875c0>]}
[0m14:35:44.825843 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dim_patients.dim_patients ..................... [[32mSUCCESS 1[0m in 1.31s]
[0m14:35:44.826530 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.dim_patients
[0m14:35:44.828124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:44.828474 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.dim_patients' was properly closed.
[0m14:35:44.828899 [info ] [MainThread]: 
[0m14:35:44.829248 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.14 seconds (5.14s).
[0m14:35:44.830036 [debug] [MainThread]: Command end result
[0m14:35:44.864772 [info ] [MainThread]: 
[0m14:35:44.865760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:44.866289 [info ] [MainThread]: 
[0m14:35:44.866910 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:35:44.868194 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.48339, "process_in_blocks": "0", "process_kernel_time": 0.463157, "process_mem_max_rss": "136781824", "process_out_blocks": "0", "process_user_time": 3.832907}
[0m14:35:44.868855 [debug] [MainThread]: Command `dbt run` succeeded at 14:35:44.868741 after 7.48 seconds
[0m14:35:44.869273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c4f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f48aa0>]}
[0m14:35:44.869648 [debug] [MainThread]: Flushing usage events
[0m14:36:10.330850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c18770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067386b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106738470>]}


============================== 14:36:10.337766 | 4913d120-a75b-4bbb-abb5-613a210f68ec ==============================
[0m14:36:10.337766 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:36:10.338398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select dim_patients', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:36:10.952671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4913d120-a75b-4bbb-abb5-613a210f68ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10712e120>]}
[0m14:36:11.008422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4913d120-a75b-4bbb-abb5-613a210f68ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10670d370>]}
[0m14:36:11.010986 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:36:11.180055 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:36:11.394134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:36:11.394841 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/schema.yml
[0m14:36:11.470459 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named dim_patients. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for dim_patients in one of these files:
   - models/transform/schema.yml
  models/transform/dim_patients.yml
[0m14:36:11.471509 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2227777, "process_in_blocks": "0", "process_kernel_time": 0.47011, "process_mem_max_rss": "120483840", "process_out_blocks": "0", "process_user_time": 1.948765}
[0m14:36:11.472118 [debug] [MainThread]: Command `dbt run` failed at 14:36:11.472004 after 1.22 seconds
[0m14:36:11.472597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106738350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107381c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d2f00>]}
[0m14:36:11.472966 [debug] [MainThread]: Flushing usage events
[0m14:36:33.937363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7b7d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad3c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad3c440>]}


============================== 14:36:33.943044 | 8f33c50d-f14b-4303-94c8-55656d8b4f21 ==============================
[0m14:36:33.943044 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:36:33.944011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select dim_patients', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:36:34.402124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f33c50d-f14b-4303-94c8-55656d8b4f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b02e0c0>]}
[0m14:36:34.458060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f33c50d-f14b-4303-94c8-55656d8b4f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b167470>]}
[0m14:36:34.460097 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:36:34.599401 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:36:34.785839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:36:34.786546 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/dim_patients.yml
[0m14:36:34.786972 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/schema.yml
[0m14:36:35.040465 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:36:35.106089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f33c50d-f14b-4303-94c8-55656d8b4f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b98b3b0>]}
[0m14:36:35.205251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f33c50d-f14b-4303-94c8-55656d8b4f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb03080>]}
[0m14:36:35.206088 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m14:36:35.206571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f33c50d-f14b-4303-94c8-55656d8b4f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bce1e50>]}
[0m14:36:35.208312 [info ] [MainThread]: 
[0m14:36:35.208989 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:36:35.209926 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m14:36:35.224552 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:36:35.225007 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:36:35.225330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:36.441087 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.216 seconds
[0m14:36:36.443820 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:36:36.570203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m14:36:36.582462 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m14:36:36.583045 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m14:36:36.583587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:37.146574 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.563 seconds
[0m14:36:37.149775 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m14:36:37.242823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m14:36:37.247435 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m14:36:37.248040 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m14:36:37.248534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:37.661788 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.413 seconds
[0m14:36:37.664360 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m14:36:37.747567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_analysis)
[0m14:36:37.752433 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m14:36:37.753053 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m14:36:37.753573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:38.125443 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.372 seconds
[0m14:36:38.127984 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m14:36:38.227801 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_dim_patients)
[0m14:36:38.231652 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_dim_patients"
[0m14:36:38.232924 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_dim_patients"} */
show objects in CASPAR_HEALTH.dim_patients limit 10000
[0m14:36:38.233455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:38.645130 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.412 seconds
[0m14:36:38.647938 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: Close
[0m14:36:38.727614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f33c50d-f14b-4303-94c8-55656d8b4f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0ae2d0>]}
[0m14:36:38.728718 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:36:38.729409 [info ] [MainThread]: 
[0m14:36:38.734172 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.dim_patients
[0m14:36:38.735086 [info ] [Thread-1 (]: 1 of 1 START sql view model dim_patients.dim_patients .......................... [RUN]
[0m14:36:38.735846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_dim_patients, now model.caspar_health_technical_challenge.dim_patients)
[0m14:36:38.736417 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.dim_patients
[0m14:36:38.748320 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:36:38.749481 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.dim_patients
[0m14:36:38.758883 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:36:38.759386 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
show parameters like 'query_tag' in session
[0m14:36:38.759730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:39.062626 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m14:36:39.065553 [debug] [Thread-1 (]: Setting query_tag to 'dim_patients'. Will reset to '' after materialization.
[0m14:36:39.068233 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:36:39.069393 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
alter session set query_tag = 'dim_patients'
[0m14:36:39.150337 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.080 seconds
[0m14:36:39.217592 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:36:39.218139 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
    ) as __dbt_sbq
    where false
    limit 0
[0m14:36:39.292960 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.074 seconds
[0m14:36:39.308233 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:36:39.308805 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country
    ) as __dbt_sbq
    where false
    limit 0
[0m14:36:39.376526 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.067 seconds
[0m14:36:39.384318 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:36:39.385990 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:36:39.386590 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
create or replace   view CASPAR_HEALTH.dim_patients.dim_patients
  
   as (
    SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
  );
[0m14:36:39.715544 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.328 seconds
[0m14:36:39.745347 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: Close
[0m14:36:39.830320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f33c50d-f14b-4303-94c8-55656d8b4f21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a27f4a0>]}
[0m14:36:39.831423 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dim_patients.dim_patients ..................... [[32mSUCCESS 1[0m in 1.09s]
[0m14:36:39.832395 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.dim_patients
[0m14:36:39.834082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:39.834559 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.dim_patients' was properly closed.
[0m14:36:39.835029 [info ] [MainThread]: 
[0m14:36:39.835520 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.63 seconds (4.63s).
[0m14:36:39.836442 [debug] [MainThread]: Command end result
[0m14:36:39.870565 [info ] [MainThread]: 
[0m14:36:39.871183 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:36:39.871528 [info ] [MainThread]: 
[0m14:36:39.872200 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:36:39.873161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.01733, "process_in_blocks": "0", "process_kernel_time": 0.486824, "process_mem_max_rss": "133591040", "process_out_blocks": "0", "process_user_time": 2.881519}
[0m14:36:39.874238 [debug] [MainThread]: Command `dbt run` succeeded at 14:36:39.874002 after 6.02 seconds
[0m14:36:39.874947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21ee70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be74d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8438c0>]}
[0m14:36:39.875456 [debug] [MainThread]: Flushing usage events
[0m14:36:55.539616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10944f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097586e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097584a0>]}


============================== 14:36:55.544992 | d0a991a7-ce87-4d7d-81d3-7c939a720730 ==============================
[0m14:36:55.544992 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:36:55.545645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_patients', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:36:56.063150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0a991a7-ce87-4d7d-81d3-7c939a720730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca70e0>]}
[0m14:36:56.126241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0a991a7-ce87-4d7d-81d3-7c939a720730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097680b0>]}
[0m14:36:56.127500 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:36:56.289338 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:36:56.446736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:36:56.447482 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/schema.yml
[0m14:36:56.448076 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/dim_patients.yml
[0m14:36:56.735956 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:36:56.804997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0a991a7-ce87-4d7d-81d3-7c939a720730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5b23c0>]}
[0m14:36:56.918662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0a991a7-ce87-4d7d-81d3-7c939a720730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a596ab0>]}
[0m14:36:56.919342 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m14:36:56.919947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0a991a7-ce87-4d7d-81d3-7c939a720730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a95ca10>]}
[0m14:36:56.921638 [info ] [MainThread]: 
[0m14:36:56.922246 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:36:56.923425 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m14:36:56.939222 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:36:56.940095 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:36:56.940615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:57.695644 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.755 seconds
[0m14:36:57.698166 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:36:58.309368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m14:36:58.321454 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m14:36:58.322167 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m14:36:58.322874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:58.852506 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.530 seconds
[0m14:36:58.855186 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m14:36:58.936125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_dim_patients)
[0m14:36:58.952254 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_dim_patients"
[0m14:36:58.967450 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_dim_patients"} */
show objects in CASPAR_HEALTH.dim_patients limit 10000
[0m14:36:58.968243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:59.340732 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.372 seconds
[0m14:36:59.344023 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: Close
[0m14:36:59.431719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_dim_patients, now list_CASPAR_HEALTH_analysis)
[0m14:36:59.435250 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m14:36:59.435903 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m14:36:59.436511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:59.824347 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.388 seconds
[0m14:36:59.826549 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m14:36:59.900731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_public)
[0m14:36:59.904899 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m14:36:59.905420 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m14:36:59.905856 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:00.219823 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.314 seconds
[0m14:37:00.221953 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m14:37:00.315276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0a991a7-ce87-4d7d-81d3-7c939a720730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab305f0>]}
[0m14:37:00.316007 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:37:00.316512 [info ] [MainThread]: 
[0m14:37:00.318746 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.dim_patients
[0m14:37:00.319439 [info ] [Thread-1 (]: 1 of 1 START sql view model dim_patients.dim_patients .......................... [RUN]
[0m14:37:00.320165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.dim_patients)
[0m14:37:00.320705 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.dim_patients
[0m14:37:00.330158 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:37:00.331412 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.dim_patients
[0m14:37:00.342383 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:37:00.343055 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
show parameters like 'query_tag' in session
[0m14:37:00.343516 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:00.734465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.391 seconds
[0m14:37:00.736499 [debug] [Thread-1 (]: Setting query_tag to 'dim_patients'. Will reset to '' after materialization.
[0m14:37:00.737359 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:37:00.737773 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
alter session set query_tag = 'dim_patients'
[0m14:37:00.805203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.067 seconds
[0m14:37:00.842778 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:37:00.843344 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
    ) as __dbt_sbq
    where false
    limit 0
[0m14:37:00.932387 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.089 seconds
[0m14:37:00.945520 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:37:00.946043 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country
    ) as __dbt_sbq
    where false
    limit 0
[0m14:37:01.008428 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.062 seconds
[0m14:37:01.015705 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: Close
[0m14:37:01.193006 [debug] [Thread-1 (]: Compilation Error in model dim_patients (models/transform/dim_patients.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason     |
  | ----------- | --------------- | ------------- | ------------------- |
  | FIRST_NAME  | TEXT            |               | missing in contract |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro snowflake__create_view_as_with_temp_flag (macros/relations/view/create.sql)
  > called by macro snowflake__create_view_as (macros/relations/view/create.sql)
  > called by macro create_view_as (macros/relations/view/create.sql)
  > called by macro default__get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro snowflake__create_or_replace_view (macros/relations/view/create.sql)
  > called by macro materialization_view_snowflake (macros/materializations/view.sql)
  > called by model dim_patients (models/transform/dim_patients.sql)
[0m14:37:01.195125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0a991a7-ce87-4d7d-81d3-7c939a720730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109705130>]}
[0m14:37:01.196052 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dim_patients.dim_patients ................. [[31mERROR[0m in 0.87s]
[0m14:37:01.197304 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.dim_patients
[0m14:37:01.199443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:01.199856 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.dim_patients' was properly closed.
[0m14:37:01.200204 [info ] [MainThread]: 
[0m14:37:01.200558 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.28 seconds (4.28s).
[0m14:37:01.201253 [debug] [MainThread]: Command end result
[0m14:37:01.239014 [info ] [MainThread]: 
[0m14:37:01.239631 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:37:01.239997 [info ] [MainThread]: 
[0m14:37:01.240446 [error] [MainThread]:   Compilation Error in model dim_patients (models/transform/dim_patients.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason     |
  | ----------- | --------------- | ------------- | ------------------- |
  | FIRST_NAME  | TEXT            |               | missing in contract |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro snowflake__create_view_as_with_temp_flag (macros/relations/view/create.sql)
  > called by macro snowflake__create_view_as (macros/relations/view/create.sql)
  > called by macro create_view_as (macros/relations/view/create.sql)
  > called by macro default__get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro snowflake__create_or_replace_view (macros/relations/view/create.sql)
  > called by macro materialization_view_snowflake (macros/materializations/view.sql)
  > called by model dim_patients (models/transform/dim_patients.sql)
[0m14:37:01.240922 [info ] [MainThread]: 
[0m14:37:01.241480 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:37:01.242090 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.780212, "process_in_blocks": "0", "process_kernel_time": 0.51746, "process_mem_max_rss": "133476352", "process_out_blocks": "0", "process_user_time": 2.998284}
[0m14:37:01.242582 [debug] [MainThread]: Command `dbt run` failed at 14:37:01.242481 after 5.78 seconds
[0m14:37:01.242970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109079c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10944f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a855970>]}
[0m14:37:01.243329 [debug] [MainThread]: Flushing usage events
[0m14:37:09.943388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b95340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106958860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106958620>]}


============================== 14:37:09.949092 | 9adb7909-3fe6-42ab-a165-7551be41642b ==============================
[0m14:37:09.949092 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:37:09.949759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_patients', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:37:10.413153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9adb7909-3fe6-42ab-a165-7551be41642b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072553a0>]}
[0m14:37:10.470176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9adb7909-3fe6-42ab-a165-7551be41642b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106958710>]}
[0m14:37:10.471289 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:37:10.599914 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:37:10.688287 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:37:10.688811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9adb7909-3fe6-42ab-a165-7551be41642b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107882a20>]}
[0m14:37:12.043073 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:37:12.124440 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.caspar_health_technical_challenge.dim_patients
[0m14:37:12.130585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9adb7909-3fe6-42ab-a165-7551be41642b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077be5a0>]}
[0m14:37:12.238537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9adb7909-3fe6-42ab-a165-7551be41642b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b94fe0>]}
[0m14:37:12.239101 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m14:37:12.239480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9adb7909-3fe6-42ab-a165-7551be41642b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a34410>]}
[0m14:37:12.241020 [info ] [MainThread]: 
[0m14:37:12.241580 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:37:12.242421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m14:37:12.256554 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:37:12.257013 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:37:12.257330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:12.673463 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.416 seconds
[0m14:37:12.676422 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:37:13.107955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m14:37:13.119731 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m14:37:13.120237 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m14:37:13.120640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:13.451570 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.331 seconds
[0m14:37:13.454456 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m14:37:13.543609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_transform)
[0m14:37:13.547970 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m14:37:13.548469 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m14:37:13.548896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:13.926148 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.377 seconds
[0m14:37:13.928828 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m14:37:14.036903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_analysis)
[0m14:37:14.039884 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m14:37:14.040261 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m14:37:14.040560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:14.409293 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.369 seconds
[0m14:37:14.411997 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m14:37:14.520465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9adb7909-3fe6-42ab-a165-7551be41642b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a34410>]}
[0m14:37:14.521445 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:37:14.522044 [info ] [MainThread]: 
[0m14:37:14.526262 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.dim_patients
[0m14:37:14.544055 [info ] [Thread-1 (]: 1 of 1 START sql view model transform.dim_patients ............................. [RUN]
[0m14:37:14.545314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now model.caspar_health_technical_challenge.dim_patients)
[0m14:37:14.546189 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.dim_patients
[0m14:37:14.562483 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:37:14.563935 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.dim_patients
[0m14:37:14.582649 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:37:14.583173 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
show parameters like 'query_tag' in session
[0m14:37:14.583612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:14.858080 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.274 seconds
[0m14:37:14.860269 [debug] [Thread-1 (]: Setting query_tag to 'dim_patients'. Will reset to '' after materialization.
[0m14:37:14.861288 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:37:14.861912 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
alter session set query_tag = 'dim_patients'
[0m14:37:14.934695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m14:37:14.974902 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:37:14.975399 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
    ) as __dbt_sbq
    where false
    limit 0
[0m14:37:15.081955 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.106 seconds
[0m14:37:15.096302 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:37:15.097166 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country
    ) as __dbt_sbq
    where false
    limit 0
[0m14:37:15.182148 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.084 seconds
[0m14:37:15.191073 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: Close
[0m14:37:15.291926 [debug] [Thread-1 (]: Compilation Error in model dim_patients (models/transform/dim_patients.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason     |
  | ----------- | --------------- | ------------- | ------------------- |
  | FIRST_NAME  | TEXT            |               | missing in contract |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro snowflake__create_view_as_with_temp_flag (macros/relations/view/create.sql)
  > called by macro snowflake__create_view_as (macros/relations/view/create.sql)
  > called by macro create_view_as (macros/relations/view/create.sql)
  > called by macro default__get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro snowflake__create_or_replace_view (macros/relations/view/create.sql)
  > called by macro materialization_view_snowflake (macros/materializations/view.sql)
  > called by model dim_patients (models/transform/dim_patients.sql)
[0m14:37:15.293850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9adb7909-3fe6-42ab-a165-7551be41642b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ebbaa0>]}
[0m14:37:15.294718 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model transform.dim_patients .................... [[31mERROR[0m in 0.75s]
[0m14:37:15.295510 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.dim_patients
[0m14:37:15.297933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:15.298609 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.dim_patients' was properly closed.
[0m14:37:15.299041 [info ] [MainThread]: 
[0m14:37:15.299619 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.06 seconds (3.06s).
[0m14:37:15.300456 [debug] [MainThread]: Command end result
[0m14:37:15.334403 [info ] [MainThread]: 
[0m14:37:15.335056 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:37:15.335423 [info ] [MainThread]: 
[0m14:37:15.335841 [error] [MainThread]:   Compilation Error in model dim_patients (models/transform/dim_patients.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason     |
  | ----------- | --------------- | ------------- | ------------------- |
  | FIRST_NAME  | TEXT            |               | missing in contract |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro snowflake__create_view_as_with_temp_flag (macros/relations/view/create.sql)
  > called by macro snowflake__create_view_as (macros/relations/view/create.sql)
  > called by macro create_view_as (macros/relations/view/create.sql)
  > called by macro default__get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro snowflake__create_or_replace_view (macros/relations/view/create.sql)
  > called by macro materialization_view_snowflake (macros/materializations/view.sql)
  > called by model dim_patients (models/transform/dim_patients.sql)
[0m14:37:15.336486 [info ] [MainThread]: 
[0m14:37:15.336920 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:37:15.337594 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.463429, "process_in_blocks": "0", "process_kernel_time": 0.454982, "process_mem_max_rss": "132734976", "process_out_blocks": "0", "process_user_time": 3.754819}
[0m14:37:15.338186 [debug] [MainThread]: Command `dbt run` failed at 14:37:15.338078 after 5.46 seconds
[0m14:37:15.338599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106958290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f25eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e9b440>]}
[0m14:37:15.338952 [debug] [MainThread]: Flushing usage events
[0m14:41:59.787996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b23200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105648680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105648440>]}


============================== 14:41:59.795065 | a55fcb07-9c08-47e3-8a5a-d11495997d9e ==============================
[0m14:41:59.795065 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:41:59.795707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_exercises', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:42:00.511827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a55fcb07-9c08-47e3-8a5a-d11495997d9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105648560>]}
[0m14:42:00.571089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a55fcb07-9c08-47e3-8a5a-d11495997d9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1f9e0>]}
[0m14:42:00.573767 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:42:00.733053 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:42:00.834889 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:42:00.835469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a55fcb07-9c08-47e3-8a5a-d11495997d9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106563800>]}
[0m14:42:02.423724 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/transform/fct_exercises.yml @ models: {'name': 'fct_exercises', 'config': {'contract': {'enforced': True}}, 'constraints': [{'type': 'primary_key', 'columns': ['id']}], 'columns': [{'name': 'id', 'data_type': 'number(38, 0)', 'constraints': [{'type': 'not_null'}, {'type': 'unique'}]}, {'type': 'foreign_key', 'columns': ['patient_id'], 'to': "ref('dim_patients')", 'to_columns': ['id']}, {'name': 'minutes', 'data_type': 'number(38, 0)'}, {'name': 'completed_at', 'data_type': 'timestamp_tz'}, {'name': 'updated_at', 'data_type': 'timestamp_tz'}], 'original_file_path': 'models/transform/fct_exercises.yml', 'yaml_key': 'models', 'package_name': 'caspar_health_technical_challenge'} - at path ['columns'][1]: 'name' is a required property
[0m14:42:02.425086 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.7230148, "process_in_blocks": "0", "process_kernel_time": 0.606058, "process_mem_max_rss": "122368000", "process_out_blocks": "0", "process_user_time": 3.453829}
[0m14:42:02.425641 [debug] [MainThread]: Command `dbt run` failed at 14:42:02.425528 after 2.72 seconds
[0m14:42:02.426053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105648080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10449ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674eae0>]}
[0m14:42:02.426474 [debug] [MainThread]: Flushing usage events
[0m14:47:44.208424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11206fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123806e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123804a0>]}


============================== 14:47:44.216509 | cef17950-5df3-45b4-bcc6-1cadbb14bf8a ==============================
[0m14:47:44.216509 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:47:44.217353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_exercises', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:47:44.842384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cef17950-5df3-45b4-bcc6-1cadbb14bf8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123275f0>]}
[0m14:47:44.896812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cef17950-5df3-45b4-bcc6-1cadbb14bf8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b246b0>]}
[0m14:47:44.899272 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:47:45.050193 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:47:45.141807 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:47:45.142400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cef17950-5df3-45b4-bcc6-1cadbb14bf8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113223b00>]}
[0m14:47:46.532887 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:47:46.536498 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:47:46.619861 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.dim_patients
- models.caspar_health_technical_challenge.fct_exercises
[0m14:47:46.625252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cef17950-5df3-45b4-bcc6-1cadbb14bf8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e3b080>]}
[0m14:47:46.746050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cef17950-5df3-45b4-bcc6-1cadbb14bf8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133d5820>]}
[0m14:47:46.746550 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m14:47:46.746916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cef17950-5df3-45b4-bcc6-1cadbb14bf8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113439d90>]}
[0m14:47:46.748504 [info ] [MainThread]: 
[0m14:47:46.749183 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:47:46.750317 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m14:47:46.763537 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:47:46.764039 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:47:46.764353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:47.679658 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.915 seconds
[0m14:47:47.682204 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:47:47.787729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m14:47:47.804735 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m14:47:47.805529 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m14:47:47.806083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:47:48.144004 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.338 seconds
[0m14:47:48.148640 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m14:47:48.267122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cef17950-5df3-45b4-bcc6-1cadbb14bf8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11353abd0>]}
[0m14:47:48.268434 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:47:48.269263 [info ] [MainThread]: 
[0m14:47:48.274911 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_exercises
[0m14:47:48.276123 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fct_exercises ............................... [RUN]
[0m14:47:48.277174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.fct_exercises)
[0m14:47:48.278208 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_exercises
[0m14:47:48.292231 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_exercises"
[0m14:47:48.294902 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_exercises
[0m14:47:48.309952 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:47:48.310652 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
show parameters like 'query_tag' in session
[0m14:47:48.311143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:49.200865 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.889 seconds
[0m14:47:49.205026 [debug] [Thread-1 (]: Setting query_tag to 'fct_exercises'. Will reset to '' after materialization.
[0m14:47:49.207965 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:47:49.209149 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
alter session set query_tag = 'fct_exercises'
[0m14:47:49.339532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.129 seconds
[0m14:47:49.390167 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:47:49.390673 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
select * from (
        SELECT
    id,
    external_id AS patient_id,
    minutes,
    completed_at::TIMESTAMP_TZ AS completed_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_exercises
    ) as __dbt_sbq
    where false
    limit 0
[0m14:47:49.956016 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.564 seconds
[0m14:47:49.974045 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:47:49.974645 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as number(38, 0))
     as patient_id, 
      
    cast(null as number(38, 0))
     as minutes, 
      
    cast(null as timestamp_tz)
     as completed_at, 
      
    cast(null as timestamp_tz)
     as updated_at
    ) as __dbt_sbq
    where false
    limit 0
[0m14:47:50.268550 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.293 seconds
[0m14:47:50.277474 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_exercises"
[0m14:47:50.279284 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:47:50.279946 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
create or replace   view CASPAR_HEALTH.public.fct_exercises
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    minutes,
    completed_at::TIMESTAMP_TZ AS completed_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_exercises
  );
[0m14:47:50.443024 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a15b-0203-b55c-0003-18c200015226
[0m14:47:50.443712 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'PUBLIC'
[0m14:47:50.444437 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: Close
[0m14:47:50.528500 [debug] [Thread-1 (]: Database Error in model fct_exercises (models/transform/fct_exercises.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'PUBLIC'
  compiled code at target/run/caspar_health_technical_challenge/models/transform/fct_exercises.sql
[0m14:47:50.530630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cef17950-5df3-45b4-bcc6-1cadbb14bf8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118bb290>]}
[0m14:47:50.531536 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fct_exercises ...................... [[31mERROR[0m in 2.25s]
[0m14:47:50.532434 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_exercises
[0m14:47:50.534860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:50.535332 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.fct_exercises' was properly closed.
[0m14:47:50.535741 [info ] [MainThread]: 
[0m14:47:50.536172 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.79 seconds (3.79s).
[0m14:47:50.536971 [debug] [MainThread]: Command end result
[0m14:47:50.589361 [info ] [MainThread]: 
[0m14:47:50.589891 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:47:50.590234 [info ] [MainThread]: 
[0m14:47:50.590623 [error] [MainThread]:   Database Error in model fct_exercises (models/transform/fct_exercises.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'PUBLIC'
  compiled code at target/run/caspar_health_technical_challenge/models/transform/fct_exercises.sql
[0m14:47:50.591104 [info ] [MainThread]: 
[0m14:47:50.591495 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:47:50.592208 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.4699445, "process_in_blocks": "0", "process_kernel_time": 0.601845, "process_mem_max_rss": "136110080", "process_out_blocks": "0", "process_user_time": 3.778744}
[0m14:47:50.592712 [debug] [MainThread]: Command `dbt run` failed at 14:47:50.592611 after 6.47 seconds
[0m14:47:50.593439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118f9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113247e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112380560>]}
[0m14:47:50.594137 [debug] [MainThread]: Flushing usage events
[0m14:48:52.934132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c05370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c544d0>]}


============================== 14:48:52.940473 | 9a91005f-c568-4a9d-9d1c-609c42d6c618 ==============================
[0m14:48:52.940473 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:48:52.941150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select dim_patients', 'send_anonymous_usage_stats': 'True'}
[0m14:48:53.594687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a91005f-c568-4a9d-9d1c-609c42d6c618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c65370>]}
[0m14:48:53.650322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a91005f-c568-4a9d-9d1c-609c42d6c618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b063f0>]}
[0m14:48:53.652928 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:48:53.796852 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:48:53.999031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:48:53.999522 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:48:54.006666 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.fct_exercises
- models.caspar_health_technical_challenge.dim_patients
[0m14:48:54.039081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a91005f-c568-4a9d-9d1c-609c42d6c618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095f7c80>]}
[0m14:48:54.182042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a91005f-c568-4a9d-9d1c-609c42d6c618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3a4e0>]}
[0m14:48:54.182725 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m14:48:54.183101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a91005f-c568-4a9d-9d1c-609c42d6c618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7a990>]}
[0m14:48:54.184738 [info ] [MainThread]: 
[0m14:48:54.185328 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:48:54.186263 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m14:48:54.200410 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:48:54.200898 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:48:54.201365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:54.775113 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.574 seconds
[0m14:48:54.777988 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:48:54.878622 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m14:48:54.892072 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m14:48:54.892714 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m14:48:54.893204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:55.763206 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.870 seconds
[0m14:48:55.767345 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m14:48:55.852969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a91005f-c568-4a9d-9d1c-609c42d6c618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108689f40>]}
[0m14:48:55.853967 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:48:55.854566 [info ] [MainThread]: 
[0m14:48:55.858301 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.dim_patients
[0m14:48:55.859159 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_patients ................................ [RUN]
[0m14:48:55.860020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.dim_patients)
[0m14:48:55.860640 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.dim_patients
[0m14:48:55.871857 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:48:55.874641 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.dim_patients
[0m14:48:55.883896 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:48:55.884395 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
show parameters like 'query_tag' in session
[0m14:48:55.884742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:56.167060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.282 seconds
[0m14:48:56.170097 [debug] [Thread-1 (]: Setting query_tag to 'dim_patients'. Will reset to '' after materialization.
[0m14:48:56.171357 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:48:56.172063 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
alter session set query_tag = 'dim_patients'
[0m14:48:56.292854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m14:48:56.341913 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:48:56.342411 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
    ) as __dbt_sbq
    where false
    limit 0
[0m14:48:56.406410 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.063 seconds
[0m14:48:56.424460 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:48:56.425059 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country
    ) as __dbt_sbq
    where false
    limit 0
[0m14:48:56.487504 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.062 seconds
[0m14:48:56.495312 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:48:56.497004 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:48:56.497623 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
create or replace   view CASPAR_HEALTH.public.dim_patients
  
   as (
    SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
  );
[0m14:48:56.592382 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a15c-0203-b576-0003-18c200010e6a
[0m14:48:56.593077 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'PUBLIC'
[0m14:48:56.593806 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: Close
[0m14:48:56.676722 [debug] [Thread-1 (]: Database Error in model dim_patients (models/transform/dim_patients.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'PUBLIC'
  compiled code at target/run/caspar_health_technical_challenge/models/transform/dim_patients.sql
[0m14:48:56.678980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a91005f-c568-4a9d-9d1c-609c42d6c618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10819b4a0>]}
[0m14:48:56.679958 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.dim_patients ....................... [[31mERROR[0m in 0.82s]
[0m14:48:56.680870 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.dim_patients
[0m14:48:56.683349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:56.683952 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.dim_patients' was properly closed.
[0m14:48:56.684596 [info ] [MainThread]: 
[0m14:48:56.685123 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m14:48:56.686030 [debug] [MainThread]: Command end result
[0m14:48:56.724908 [info ] [MainThread]: 
[0m14:48:56.725519 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:48:56.725855 [info ] [MainThread]: 
[0m14:48:56.726356 [error] [MainThread]:   Database Error in model dim_patients (models/transform/dim_patients.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'PUBLIC'
  compiled code at target/run/caspar_health_technical_challenge/models/transform/dim_patients.sql
[0m14:48:56.726711 [info ] [MainThread]: 
[0m14:48:56.727038 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:48:56.727829 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.873537, "process_in_blocks": "0", "process_kernel_time": 0.533873, "process_mem_max_rss": "130928640", "process_out_blocks": "0", "process_user_time": 2.397669}
[0m14:48:56.728844 [debug] [MainThread]: Command `dbt run` failed at 14:48:56.728599 after 3.87 seconds
[0m14:48:56.729353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108975bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2bef0>]}
[0m14:48:56.729978 [debug] [MainThread]: Flushing usage events
[0m14:49:32.107520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049710d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6c500>]}


============================== 14:49:32.117725 | 46caf89b-c751-4984-8597-50c1376dd505 ==============================
[0m14:49:32.117725 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:49:32.118703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_patients', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:49:32.813528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46caf89b-c751-4984-8597-50c1376dd505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10559ef60>]}
[0m14:49:32.867687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46caf89b-c751-4984-8597-50c1376dd505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102554c20>]}
[0m14:49:32.870660 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:49:33.030610 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:49:33.263319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:49:33.263973 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:49:33.269650 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.caspar_health_technical_challenge.dim_patients
- models.caspar_health_technical_challenge.fct_exercises
[0m14:49:33.302171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46caf89b-c751-4984-8597-50c1376dd505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10694cc50>]}
[0m14:49:33.413787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46caf89b-c751-4984-8597-50c1376dd505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a90110>]}
[0m14:49:33.414366 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m14:49:33.414752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46caf89b-c751-4984-8597-50c1376dd505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631b740>]}
[0m14:49:33.416554 [info ] [MainThread]: 
[0m14:49:33.417315 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:49:33.418297 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m14:49:33.432722 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:49:33.433173 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:49:33.433493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:33.970219 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.537 seconds
[0m14:49:33.972881 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:49:34.065199 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m14:49:34.075688 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m14:49:34.076192 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m14:49:34.076561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:34.397751 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.321 seconds
[0m14:49:34.399991 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m14:49:34.488608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46caf89b-c751-4984-8597-50c1376dd505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bf200>]}
[0m14:49:34.489430 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:34.489871 [info ] [MainThread]: 
[0m14:49:34.493610 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.dim_patients
[0m14:49:34.494307 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_patients ................................ [RUN]
[0m14:49:34.494888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.dim_patients)
[0m14:49:34.495341 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.dim_patients
[0m14:49:34.504132 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:49:34.506917 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.dim_patients
[0m14:49:34.515624 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:49:34.516094 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
show parameters like 'query_tag' in session
[0m14:49:34.516447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:34.841700 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.325 seconds
[0m14:49:34.844181 [debug] [Thread-1 (]: Setting query_tag to 'dim_patients'. Will reset to '' after materialization.
[0m14:49:34.845332 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:49:34.845941 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
alter session set query_tag = 'dim_patients'
[0m14:49:34.922318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.076 seconds
[0m14:49:34.969996 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:49:34.970493 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
    ) as __dbt_sbq
    where false
    limit 0
[0m14:49:35.064800 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.094 seconds
[0m14:49:35.081929 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:49:35.082470 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country
    ) as __dbt_sbq
    where false
    limit 0
[0m14:49:35.134551 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.051 seconds
[0m14:49:35.143513 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:49:35.145428 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:49:35.146131 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
create or replace   view CASPAR_HEALTH.public.dim_patients
  
   as (
    SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
  );
[0m14:49:35.241713 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a15d-0203-b42e-0003-18c200012c66
[0m14:49:35.242507 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on schema 'PUBLIC'
[0m14:49:35.243346 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: Close
[0m14:49:35.378089 [debug] [Thread-1 (]: Database Error in model dim_patients (models/transform/dim_patients.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'PUBLIC'
  compiled code at target/run/caspar_health_technical_challenge/models/transform/dim_patients.sql
[0m14:49:35.381169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46caf89b-c751-4984-8597-50c1376dd505', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050af380>]}
[0m14:49:35.382582 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.dim_patients ....................... [[31mERROR[0m in 0.88s]
[0m14:49:35.383763 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.dim_patients
[0m14:49:35.386910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:35.387580 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.dim_patients' was properly closed.
[0m14:49:35.388199 [info ] [MainThread]: 
[0m14:49:35.388907 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m14:49:35.390266 [debug] [MainThread]: Command end result
[0m14:49:35.429852 [info ] [MainThread]: 
[0m14:49:35.430531 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:49:35.430865 [info ] [MainThread]: 
[0m14:49:35.431306 [error] [MainThread]:   Database Error in model dim_patients (models/transform/dim_patients.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on schema 'PUBLIC'
  compiled code at target/run/caspar_health_technical_challenge/models/transform/dim_patients.sql
[0m14:49:35.431611 [info ] [MainThread]: 
[0m14:49:35.432001 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:49:35.432579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4057906, "process_in_blocks": "0", "process_kernel_time": 0.584029, "process_mem_max_rss": "130650112", "process_out_blocks": "0", "process_user_time": 2.382929}
[0m14:49:35.433491 [debug] [MainThread]: Command `dbt run` failed at 14:49:35.433263 after 3.41 seconds
[0m14:49:35.434285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105583ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10694d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c2ae0>]}
[0m14:49:35.435062 [debug] [MainThread]: Flushing usage events
[0m14:50:46.015881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10463b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104948920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049486e0>]}


============================== 14:50:46.022437 | d3b073fc-b7cd-4c06-a03c-d2bfd601e068 ==============================
[0m14:50:46.022437 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:50:46.023770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select dim_patients', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:46.558721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3b073fc-b7cd-4c06-a03c-d2bfd601e068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10521e630>]}
[0m14:50:46.624876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3b073fc-b7cd-4c06-a03c-d2bfd601e068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101da8b00>]}
[0m14:50:46.627031 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:50:46.774872 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:50:46.873660 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:50:46.874212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd3b073fc-b7cd-4c06-a03c-d2bfd601e068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036dd370>]}
[0m14:50:48.307810 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:50:48.311696 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:50:48.403050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3b073fc-b7cd-4c06-a03c-d2bfd601e068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c9be0>]}
[0m14:50:48.503745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3b073fc-b7cd-4c06-a03c-d2bfd601e068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588b890>]}
[0m14:50:48.504249 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m14:50:48.504633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3b073fc-b7cd-4c06-a03c-d2bfd601e068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059526f0>]}
[0m14:50:48.506160 [info ] [MainThread]: 
[0m14:50:48.506713 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:50:48.507706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m14:50:48.520963 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:50:48.521405 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:50:48.521707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:49.237135 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.715 seconds
[0m14:50:49.239476 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:50:49.348721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m14:50:49.363242 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m14:50:49.363849 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m14:50:49.364310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:49.754606 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.390 seconds
[0m14:50:49.758030 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m14:50:49.848698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_fct_exercises)
[0m14:50:49.853968 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_exercises"
[0m14:50:49.854580 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_exercises"} */
show objects in CASPAR_HEALTH.fct_exercises limit 10000
[0m14:50:49.855255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:50.143903 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8a15e-0203-b5f1-0003-18c200016236
[0m14:50:50.144454 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:50:50.144992 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m14:50:50.145410 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:50:50.145898 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: Close
[0m14:50:50.226101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_exercises, now list_CASPAR_HEALTH_analysis)
[0m14:50:50.230100 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m14:50:50.230603 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m14:50:50.230952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:50.557848 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.327 seconds
[0m14:50:50.559949 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m14:50:50.638991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_dim_patients)
[0m14:50:50.642364 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_dim_patients"
[0m14:50:50.642845 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_dim_patients"} */
show objects in CASPAR_HEALTH.dim_patients limit 10000
[0m14:50:50.643206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:51.042565 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.399 seconds
[0m14:50:51.044274 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: Close
[0m14:50:51.130607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3b073fc-b7cd-4c06-a03c-d2bfd601e068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb6480>]}
[0m14:50:51.131257 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:50:51.131648 [info ] [MainThread]: 
[0m14:50:51.135216 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.dim_patients
[0m14:50:51.135915 [info ] [Thread-1 (]: 1 of 1 START sql view model dim_patients.dim_patients .......................... [RUN]
[0m14:50:51.136682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_dim_patients, now model.caspar_health_technical_challenge.dim_patients)
[0m14:50:51.137096 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.dim_patients
[0m14:50:51.144789 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:50:51.146343 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.dim_patients
[0m14:50:51.156533 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:50:51.157089 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
show parameters like 'query_tag' in session
[0m14:50:51.157839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:51.449368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.291 seconds
[0m14:50:51.450770 [debug] [Thread-1 (]: Setting query_tag to 'dim_patients'. Will reset to '' after materialization.
[0m14:50:51.451429 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:50:51.451792 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
alter session set query_tag = 'dim_patients'
[0m14:50:51.527383 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m14:50:51.568835 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:50:51.569717 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
    ) as __dbt_sbq
    where false
    limit 0
[0m14:50:51.676827 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.106 seconds
[0m14:50:51.690762 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:50:51.691431 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country
    ) as __dbt_sbq
    where false
    limit 0
[0m14:50:51.744677 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.053 seconds
[0m14:50:51.750114 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.dim_patients"
[0m14:50:51.751440 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m14:50:51.751935 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
create or replace   view CASPAR_HEALTH.dim_patients.dim_patients
  
   as (
    SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
  );
[0m14:50:51.991587 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m14:50:52.017205 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: Close
[0m14:50:52.105345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3b073fc-b7cd-4c06-a03c-d2bfd601e068', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105366de0>]}
[0m14:50:52.106243 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dim_patients.dim_patients ..................... [[32mSUCCESS 1[0m in 0.97s]
[0m14:50:52.106984 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.dim_patients
[0m14:50:52.108446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:52.108857 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.dim_patients' was properly closed.
[0m14:50:52.109204 [info ] [MainThread]: 
[0m14:50:52.109555 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.60 seconds (3.60s).
[0m14:50:52.110313 [debug] [MainThread]: Command end result
[0m14:50:52.147088 [info ] [MainThread]: 
[0m14:50:52.147663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:52.148023 [info ] [MainThread]: 
[0m14:50:52.148373 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:50:52.149295 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.22196, "process_in_blocks": "0", "process_kernel_time": 0.538404, "process_mem_max_rss": "137383936", "process_out_blocks": "0", "process_user_time": 4.045145}
[0m14:50:52.150086 [debug] [MainThread]: Command `dbt run` succeeded at 14:50:52.149896 after 6.22 seconds
[0m14:50:52.150591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc02f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e25ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104379760>]}
[0m14:50:52.151061 [debug] [MainThread]: Flushing usage events
[0m14:50:57.757214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4c9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb805f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb803b0>]}


============================== 14:50:57.764392 | c2c3d4b9-90c4-4cfa-886b-d0b3ad62b871 ==============================
[0m14:50:57.764392 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:50:57.765099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_exercises', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:50:58.376645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2c3d4b9-90c4-4cfa-886b-d0b3ad62b871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f63a750>]}
[0m14:50:58.433377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2c3d4b9-90c4-4cfa-886b-d0b3ad62b871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eeb9bb0>]}
[0m14:50:58.435055 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:50:58.578828 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:50:58.777288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:58.777736 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:58.814155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2c3d4b9-90c4-4cfa-886b-d0b3ad62b871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e16e720>]}
[0m14:50:58.913391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2c3d4b9-90c4-4cfa-886b-d0b3ad62b871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb2ee10>]}
[0m14:50:58.913915 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m14:50:58.914287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c3d4b9-90c4-4cfa-886b-d0b3ad62b871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dba0b00>]}
[0m14:50:58.915885 [info ] [MainThread]: 
[0m14:50:58.916481 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:50:58.917446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m14:50:58.932295 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:50:58.932802 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:50:58.933128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:59.350197 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.417 seconds
[0m14:50:59.352880 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:50:59.449843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now create_CASPAR_HEALTH_fct_exercises)
[0m14:50:59.453355 [debug] [ThreadPool]: Creating schema "database: "CASPAR_HEALTH"
schema: "fct_exercises"
"
[0m14:50:59.462013 [debug] [ThreadPool]: Using snowflake connection "create_CASPAR_HEALTH_fct_exercises"
[0m14:50:59.462635 [debug] [ThreadPool]: On create_CASPAR_HEALTH_fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "create_CASPAR_HEALTH_fct_exercises"} */
create schema if not exists CASPAR_HEALTH.fct_exercises
[0m14:50:59.463512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:50:59.788924 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.325 seconds
[0m14:50:59.791689 [debug] [ThreadPool]: On create_CASPAR_HEALTH_fct_exercises: Close
[0m14:50:59.890546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_CASPAR_HEALTH_fct_exercises, now list_CASPAR_HEALTH_fct_exercises)
[0m14:50:59.901410 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_exercises"
[0m14:50:59.901907 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_exercises"} */
show objects in CASPAR_HEALTH.fct_exercises limit 10000
[0m14:50:59.902225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:00.180122 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.278 seconds
[0m14:51:00.183443 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: Close
[0m14:51:00.287166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_exercises, now list_CASPAR_HEALTH_public)
[0m14:51:00.291408 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m14:51:00.292126 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m14:51:00.292724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:00.636200 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.343 seconds
[0m14:51:00.639550 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m14:51:01.260672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_dim_patients)
[0m14:51:01.264362 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_dim_patients"
[0m14:51:01.264933 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_dim_patients"} */
show objects in CASPAR_HEALTH.dim_patients limit 10000
[0m14:51:01.265359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:01.593699 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.328 seconds
[0m14:51:01.596147 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: Close
[0m14:51:01.698273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_dim_patients, now list_CASPAR_HEALTH_analysis)
[0m14:51:01.702812 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m14:51:01.718926 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m14:51:01.719681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:02.160551 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.441 seconds
[0m14:51:02.164169 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m14:51:02.244944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2c3d4b9-90c4-4cfa-886b-d0b3ad62b871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc63920>]}
[0m14:51:02.245785 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:51:02.246272 [info ] [MainThread]: 
[0m14:51:02.249577 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_exercises
[0m14:51:02.250261 [info ] [Thread-1 (]: 1 of 1 START sql view model fct_exercises.fct_exercises ........................ [RUN]
[0m14:51:02.250836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now model.caspar_health_technical_challenge.fct_exercises)
[0m14:51:02.251244 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_exercises
[0m14:51:02.261536 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_exercises"
[0m14:51:02.263642 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_exercises
[0m14:51:02.275937 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:51:02.276853 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
show parameters like 'query_tag' in session
[0m14:51:02.277823 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:02.588931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.311 seconds
[0m14:51:02.592793 [debug] [Thread-1 (]: Setting query_tag to 'fct_exercises'. Will reset to '' after materialization.
[0m14:51:02.593898 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:51:02.594507 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
alter session set query_tag = 'fct_exercises'
[0m14:51:02.661064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.066 seconds
[0m14:51:02.712579 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:51:02.713105 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
select * from (
        SELECT
    id,
    external_id AS patient_id,
    minutes,
    completed_at::TIMESTAMP_TZ AS completed_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_exercises
    ) as __dbt_sbq
    where false
    limit 0
[0m14:51:02.800293 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.086 seconds
[0m14:51:02.823125 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:51:02.823746 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as number(38, 0))
     as patient_id, 
      
    cast(null as number(38, 0))
     as minutes, 
      
    cast(null as timestamp_tz)
     as completed_at, 
      
    cast(null as timestamp_tz)
     as updated_at
    ) as __dbt_sbq
    where false
    limit 0
[0m14:51:03.322539 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.498 seconds
[0m14:51:03.333975 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_exercises"
[0m14:51:03.336182 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:51:03.336872 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
create or replace   view CASPAR_HEALTH.fct_exercises.fct_exercises
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    minutes,
    completed_at::TIMESTAMP_TZ AS completed_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_exercises
  );
[0m14:51:03.583431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.246 seconds
[0m14:51:03.607056 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: Close
[0m14:51:03.742401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2c3d4b9-90c4-4cfa-886b-d0b3ad62b871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0bb5f0>]}
[0m14:51:03.743694 [info ] [Thread-1 (]: 1 of 1 OK created sql view model fct_exercises.fct_exercises ................... [[32mSUCCESS 1[0m in 1.49s]
[0m14:51:03.744725 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_exercises
[0m14:51:03.746680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:03.747236 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.fct_exercises' was properly closed.
[0m14:51:03.747770 [info ] [MainThread]: 
[0m14:51:03.748479 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.83 seconds (4.83s).
[0m14:51:03.749862 [debug] [MainThread]: Command end result
[0m14:51:03.844312 [info ] [MainThread]: 
[0m14:51:03.844930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:03.845323 [info ] [MainThread]: 
[0m14:51:03.845658 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:51:03.846210 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.165967, "process_in_blocks": "0", "process_kernel_time": 0.548666, "process_mem_max_rss": "131039232", "process_out_blocks": "0", "process_user_time": 2.825908}
[0m14:51:03.846729 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:03.846628 after 6.17 seconds
[0m14:51:03.847089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6e7aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4c9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b564e60>]}
[0m14:51:03.847420 [debug] [MainThread]: Flushing usage events
[0m14:51:16.926372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b7a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108258740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108258500>]}


============================== 14:51:16.947426 | a768577f-64a5-49b2-a91f-1bce571fef21 ==============================
[0m14:51:16.947426 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:51:16.948315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_exercises', 'send_anonymous_usage_stats': 'True'}
[0m14:51:17.659907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a768577f-64a5-49b2-a91f-1bce571fef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6a510>]}
[0m14:51:17.715684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a768577f-64a5-49b2-a91f-1bce571fef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10822cd70>]}
[0m14:51:17.717710 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:51:17.877715 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:51:18.125122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:51:18.125996 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/fct_exercises.yml
[0m14:51:18.380839 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:51:18.464301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a768577f-64a5-49b2-a91f-1bce571fef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f1a810>]}
[0m14:51:18.561035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a768577f-64a5-49b2-a91f-1bce571fef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10914cf50>]}
[0m14:51:18.561595 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m14:51:18.561973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a768577f-64a5-49b2-a91f-1bce571fef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e97ec0>]}
[0m14:51:18.563618 [info ] [MainThread]: 
[0m14:51:18.564280 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:51:18.565165 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m14:51:18.580005 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:51:18.580491 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:51:18.580844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:19.182465 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.603 seconds
[0m14:51:19.184184 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:51:19.289585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m14:51:19.298772 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m14:51:19.299284 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m14:51:19.299645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:19.631532 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.333 seconds
[0m14:51:19.633676 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m14:51:19.714259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_analysis)
[0m14:51:19.716624 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m14:51:19.717086 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m14:51:19.717986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:20.075279 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.358 seconds
[0m14:51:20.077092 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m14:51:20.164832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_fct_exercises)
[0m14:51:20.168111 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_exercises"
[0m14:51:20.168636 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_exercises"} */
show objects in CASPAR_HEALTH.fct_exercises limit 10000
[0m14:51:20.168999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:20.495705 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.327 seconds
[0m14:51:20.497422 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: Close
[0m14:51:20.579311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_exercises, now list_CASPAR_HEALTH_dim_patients)
[0m14:51:20.582160 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_dim_patients"
[0m14:51:20.582571 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_dim_patients"} */
show objects in CASPAR_HEALTH.dim_patients limit 10000
[0m14:51:20.582890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:20.912019 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.330 seconds
[0m14:51:20.913904 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: Close
[0m14:51:20.990657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a768577f-64a5-49b2-a91f-1bce571fef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109456900>]}
[0m14:51:20.991339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:51:20.991746 [info ] [MainThread]: 
[0m14:51:20.995145 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_exercises
[0m14:51:20.995870 [info ] [Thread-1 (]: 1 of 1 START sql view model fct_exercises.fct_exercises ........................ [RUN]
[0m14:51:20.996580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_dim_patients, now model.caspar_health_technical_challenge.fct_exercises)
[0m14:51:20.996991 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_exercises
[0m14:51:21.006354 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_exercises"
[0m14:51:21.008072 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_exercises
[0m14:51:21.019655 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:51:21.020188 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
show parameters like 'query_tag' in session
[0m14:51:21.020678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:21.376424 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.356 seconds
[0m14:51:21.377863 [debug] [Thread-1 (]: Setting query_tag to 'fct_exercises'. Will reset to '' after materialization.
[0m14:51:21.378597 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:51:21.379013 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
alter session set query_tag = 'fct_exercises'
[0m14:51:21.444634 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.065 seconds
[0m14:51:21.482499 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:51:21.484012 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
select * from (
        SELECT
    id,
    external_id AS patient_id,
    minutes,
    completed_at::TIMESTAMP_TZ AS completed_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_exercises
    ) as __dbt_sbq
    where false
    limit 0
[0m14:51:21.557850 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.073 seconds
[0m14:51:21.574324 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m14:51:21.574909 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as number(38, 0))
     as patient_id, 
      
    cast(null as timestamp_tz)
     as completed_at, 
      
    cast(null as timestamp_tz)
     as updated_at
    ) as __dbt_sbq
    where false
    limit 0
[0m14:51:21.857570 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.283 seconds
[0m14:51:21.866883 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: Close
[0m14:51:21.974132 [debug] [Thread-1 (]: Compilation Error in model fct_exercises (models/transform/fct_exercises.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason     |
  | ----------- | --------------- | ------------- | ------------------- |
  | MINUTES     | FIXED           |               | missing in contract |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro snowflake__create_view_as_with_temp_flag (macros/relations/view/create.sql)
  > called by macro snowflake__create_view_as (macros/relations/view/create.sql)
  > called by macro create_view_as (macros/relations/view/create.sql)
  > called by macro default__get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro snowflake__create_or_replace_view (macros/relations/view/create.sql)
  > called by macro materialization_view_snowflake (macros/materializations/view.sql)
  > called by model fct_exercises (models/transform/fct_exercises.sql)
[0m14:51:21.976310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a768577f-64a5-49b2-a91f-1bce571fef21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10778f8c0>]}
[0m14:51:21.977232 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model fct_exercises.fct_exercises ............... [[31mERROR[0m in 0.98s]
[0m14:51:21.978165 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_exercises
[0m14:51:21.980459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:21.980913 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.fct_exercises' was properly closed.
[0m14:51:21.981329 [info ] [MainThread]: 
[0m14:51:21.981770 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.42 seconds (3.42s).
[0m14:51:21.982670 [debug] [MainThread]: Command end result
[0m14:51:22.018971 [info ] [MainThread]: 
[0m14:51:22.019506 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:51:22.019879 [info ] [MainThread]: 
[0m14:51:22.020306 [error] [MainThread]:   Compilation Error in model fct_exercises (models/transform/fct_exercises.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason     |
  | ----------- | --------------- | ------------- | ------------------- |
  | MINUTES     | FIXED           |               | missing in contract |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro snowflake__create_view_as_with_temp_flag (macros/relations/view/create.sql)
  > called by macro snowflake__create_view_as (macros/relations/view/create.sql)
  > called by macro create_view_as (macros/relations/view/create.sql)
  > called by macro default__get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro snowflake__create_or_replace_view (macros/relations/view/create.sql)
  > called by macro materialization_view_snowflake (macros/materializations/view.sql)
  > called by model fct_exercises (models/transform/fct_exercises.sql)
[0m14:51:22.020857 [info ] [MainThread]: 
[0m14:51:22.021329 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:51:22.021959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.185783, "process_in_blocks": "0", "process_kernel_time": 0.628222, "process_mem_max_rss": "133332992", "process_out_blocks": "0", "process_user_time": 2.890123}
[0m14:51:22.023203 [debug] [MainThread]: Command `dbt run` failed at 14:51:22.023017 after 5.19 seconds
[0m14:51:22.023779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b7a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e51610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096b3080>]}
[0m14:51:22.024141 [debug] [MainThread]: Flushing usage events
[0m14:53:15.071343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10943fce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10946c380>]}


============================== 14:53:15.078565 | 5245fbc4-ec4e-47b9-a4e3-64f8fd5fe713 ==============================
[0m14:53:15.078565 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:53:15.079212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_steps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:53:15.737038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5245fbc4-ec4e-47b9-a4e3-64f8fd5fe713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109192c60>]}
[0m14:53:15.795734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5245fbc4-ec4e-47b9-a4e3-64f8fd5fe713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086cdd30>]}
[0m14:53:15.797774 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:53:15.953688 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:53:16.043612 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:53:16.044193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5245fbc4-ec4e-47b9-a4e3-64f8fd5fe713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3acda0>]}
[0m14:53:17.474070 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:53:17.477987 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:53:17.482049 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:53:17.571447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5245fbc4-ec4e-47b9-a4e3-64f8fd5fe713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3db560>]}
[0m14:53:17.673358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5245fbc4-ec4e-47b9-a4e3-64f8fd5fe713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a43dc10>]}
[0m14:53:17.673944 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m14:53:17.674347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5245fbc4-ec4e-47b9-a4e3-64f8fd5fe713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1338c0>]}
[0m14:53:17.675991 [info ] [MainThread]: 
[0m14:53:17.676614 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:53:17.677791 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m14:53:17.690662 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:53:17.691323 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:53:17.691977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:18.525922 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.834 seconds
[0m14:53:18.530100 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:53:18.627430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now create_CASPAR_HEALTH_fct_steps)
[0m14:53:18.629680 [debug] [ThreadPool]: Creating schema "database: "CASPAR_HEALTH"
schema: "fct_steps"
"
[0m14:53:18.640213 [debug] [ThreadPool]: Using snowflake connection "create_CASPAR_HEALTH_fct_steps"
[0m14:53:18.641034 [debug] [ThreadPool]: On create_CASPAR_HEALTH_fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "create_CASPAR_HEALTH_fct_steps"} */
create schema if not exists CASPAR_HEALTH.fct_steps
[0m14:53:18.641641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:19.004895 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.363 seconds
[0m14:53:19.007180 [debug] [ThreadPool]: On create_CASPAR_HEALTH_fct_steps: Close
[0m14:53:19.102970 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_CASPAR_HEALTH_fct_steps, now list_CASPAR_HEALTH_public)
[0m14:53:19.117109 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m14:53:19.117726 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m14:53:19.118193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:19.661288 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.543 seconds
[0m14:53:19.665934 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m14:53:19.746886 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_fct_steps)
[0m14:53:19.753772 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_steps"
[0m14:53:19.754434 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_steps"} */
show objects in CASPAR_HEALTH.fct_steps limit 10000
[0m14:53:19.754955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:20.028881 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.274 seconds
[0m14:53:20.030832 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: Close
[0m14:53:20.114473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_steps, now list_CASPAR_HEALTH_dim_patients)
[0m14:53:20.120143 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_dim_patients"
[0m14:53:20.121028 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_dim_patients"} */
show objects in CASPAR_HEALTH.dim_patients limit 10000
[0m14:53:20.121761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:20.417388 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.295 seconds
[0m14:53:20.421367 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: Close
[0m14:53:20.513932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_dim_patients, now list_CASPAR_HEALTH_fct_exercises)
[0m14:53:20.517323 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_exercises"
[0m14:53:20.517882 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_exercises"} */
show objects in CASPAR_HEALTH.fct_exercises limit 10000
[0m14:53:20.518325 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:20.904377 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.386 seconds
[0m14:53:20.907607 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: Close
[0m14:53:20.994534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_exercises, now list_CASPAR_HEALTH_analysis)
[0m14:53:20.998161 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m14:53:20.998654 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m14:53:20.999102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:21.455478 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.456 seconds
[0m14:53:21.459321 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m14:53:21.586429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5245fbc4-ec4e-47b9-a4e3-64f8fd5fe713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f9d00>]}
[0m14:53:21.587568 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:21.588267 [info ] [MainThread]: 
[0m14:53:21.593617 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_steps
[0m14:53:21.594684 [info ] [Thread-1 (]: 1 of 1 START sql view model fct_steps.fct_steps ................................ [RUN]
[0m14:53:21.595598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now model.caspar_health_technical_challenge.fct_steps)
[0m14:53:21.596295 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_steps
[0m14:53:21.607656 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_steps"
[0m14:53:21.610370 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_steps
[0m14:53:21.621050 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:53:21.621923 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
show parameters like 'query_tag' in session
[0m14:53:21.622562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:21.992908 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.370 seconds
[0m14:53:21.995424 [debug] [Thread-1 (]: Setting query_tag to 'fct_steps'. Will reset to '' after materialization.
[0m14:53:21.996587 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:53:21.997431 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
alter session set query_tag = 'fct_steps'
[0m14:53:22.159634 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.161 seconds
[0m14:53:22.202959 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:53:22.203507 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
select * from (
        SELECT
    id,
    external_id AS patient_id,
    steps,
    steps * 0.002 AS minutes
    TRY_TO_TIMESTAMP_TZ(submission_time, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS submitted_at,
    TRY_TO_TIMESTAMP_TZ(updated_at, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
    ) as __dbt_sbq
    where false
    limit 0
[0m14:53:22.338921 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b8a161-0203-b580-0003-18c200017256
[0m14:53:22.339804 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 4 unexpected 'TRY_TO_TIMESTAMP_TZ'.
syntax error line 7 at position 76 unexpected ')'.
[0m14:53:22.340775 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: Close
[0m14:53:22.473649 [debug] [Thread-1 (]: Database Error in model fct_steps (models/transform/fct_steps.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 4 unexpected 'TRY_TO_TIMESTAMP_TZ'.
  syntax error line 7 at position 76 unexpected ')'.
[0m14:53:22.475070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5245fbc4-ec4e-47b9-a4e3-64f8fd5fe713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b43e120>]}
[0m14:53:22.475685 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model fct_steps.fct_steps ....................... [[31mERROR[0m in 0.88s]
[0m14:53:22.476287 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_steps
[0m14:53:22.478080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:22.478413 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.fct_steps' was properly closed.
[0m14:53:22.478730 [info ] [MainThread]: 
[0m14:53:22.479066 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.80 seconds (4.80s).
[0m14:53:22.479678 [debug] [MainThread]: Command end result
[0m14:53:22.511308 [info ] [MainThread]: 
[0m14:53:22.512268 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:53:22.512901 [info ] [MainThread]: 
[0m14:53:22.513376 [error] [MainThread]:   Database Error in model fct_steps (models/transform/fct_steps.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 4 unexpected 'TRY_TO_TIMESTAMP_TZ'.
  syntax error line 7 at position 76 unexpected ')'.
[0m14:53:22.513821 [info ] [MainThread]: 
[0m14:53:22.514482 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:53:22.515349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.5279613, "process_in_blocks": "0", "process_kernel_time": 0.603985, "process_mem_max_rss": "137191424", "process_out_blocks": "0", "process_user_time": 4.003875}
[0m14:53:22.515886 [debug] [MainThread]: Command `dbt run` failed at 14:53:22.515782 after 7.53 seconds
[0m14:53:22.516283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086682f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109021c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a130aa0>]}
[0m14:53:22.516637 [debug] [MainThread]: Flushing usage events
[0m14:53:32.864174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11212ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112438740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112438530>]}


============================== 14:53:32.870033 | 7485bf15-387d-48aa-abcb-8d78ab1057db ==============================
[0m14:53:32.870033 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:53:32.870754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_steps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:53:33.353467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7485bf15-387d-48aa-abcb-8d78ab1057db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d3a2a0>]}
[0m14:53:33.411907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7485bf15-387d-48aa-abcb-8d78ab1057db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112439d00>]}
[0m14:53:33.413056 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:53:33.544810 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:53:33.696480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:53:33.697153 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/fct_steps.sql
[0m14:53:33.937955 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:53:34.003746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7485bf15-387d-48aa-abcb-8d78ab1057db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134da4e0>]}
[0m14:53:34.089918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7485bf15-387d-48aa-abcb-8d78ab1057db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113249910>]}
[0m14:53:34.090497 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m14:53:34.090897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7485bf15-387d-48aa-abcb-8d78ab1057db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135eeff0>]}
[0m14:53:34.092643 [info ] [MainThread]: 
[0m14:53:34.093375 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:53:34.094317 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m14:53:34.109142 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m14:53:34.109974 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m14:53:34.110642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:34.622608 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.512 seconds
[0m14:53:34.625497 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m14:53:34.740989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_fct_exercises)
[0m14:53:34.750587 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_exercises"
[0m14:53:34.751015 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_exercises"} */
show objects in CASPAR_HEALTH.fct_exercises limit 10000
[0m14:53:34.751334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:35.128682 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.377 seconds
[0m14:53:35.133018 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: Close
[0m14:53:35.234139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_exercises, now list_CASPAR_HEALTH_analysis)
[0m14:53:35.237794 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m14:53:35.238844 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m14:53:35.239365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:35.600661 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.361 seconds
[0m14:53:35.602316 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m14:53:35.679503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_dim_patients)
[0m14:53:35.682320 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_dim_patients"
[0m14:53:35.682770 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_dim_patients"} */
show objects in CASPAR_HEALTH.dim_patients limit 10000
[0m14:53:35.683077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:36.062548 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.379 seconds
[0m14:53:36.064208 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: Close
[0m14:53:36.144646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_dim_patients, now list_CASPAR_HEALTH_public)
[0m14:53:36.147497 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m14:53:36.147902 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m14:53:36.148349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:36.539692 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.391 seconds
[0m14:53:36.542050 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m14:53:36.621826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_fct_steps)
[0m14:53:36.626454 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_steps"
[0m14:53:36.626879 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_steps"} */
show objects in CASPAR_HEALTH.fct_steps limit 10000
[0m14:53:36.627233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:36.984480 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.357 seconds
[0m14:53:36.986625 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: Close
[0m14:53:37.069318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7485bf15-387d-48aa-abcb-8d78ab1057db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123e4ce0>]}
[0m14:53:37.070244 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:37.070674 [info ] [MainThread]: 
[0m14:53:37.072803 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_steps
[0m14:53:37.073602 [info ] [Thread-1 (]: 1 of 1 START sql view model fct_steps.fct_steps ................................ [RUN]
[0m14:53:37.074132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_steps, now model.caspar_health_technical_challenge.fct_steps)
[0m14:53:37.074599 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_steps
[0m14:53:37.082552 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_steps"
[0m14:53:37.083819 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_steps
[0m14:53:37.093809 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:53:37.094517 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
show parameters like 'query_tag' in session
[0m14:53:37.094968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:37.472915 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.378 seconds
[0m14:53:37.474359 [debug] [Thread-1 (]: Setting query_tag to 'fct_steps'. Will reset to '' after materialization.
[0m14:53:37.475087 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:53:37.475476 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
alter session set query_tag = 'fct_steps'
[0m14:53:37.538187 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.062 seconds
[0m14:53:37.577901 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:53:37.578471 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
select * from (
        SELECT
    id,
    external_id AS patient_id,
    steps,
    steps * 0.002 AS minutes,
    TRY_TO_TIMESTAMP_TZ(submission_time, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS submitted_at,
    TRY_TO_TIMESTAMP_TZ(updated_at, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
    ) as __dbt_sbq
    where false
    limit 0
[0m14:53:38.103352 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.524 seconds
[0m14:53:38.120430 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:53:38.121592 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as number(38, 0))
     as patient_id, 
      
    cast(null as number(38, 0))
     as steps, 
      
    cast(null as number(38, 0))
     as minutes, 
      
    cast(null as timestamp_tz)
     as submitted_at, 
      
    cast(null as timestamp_tz)
     as updated_at
    ) as __dbt_sbq
    where false
    limit 0
[0m14:53:38.460979 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.338 seconds
[0m14:53:38.467036 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_steps"
[0m14:53:38.468712 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m14:53:38.469148 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
create or replace   view CASPAR_HEALTH.fct_steps.fct_steps
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    steps,
    steps * 0.002 AS minutes,
    TRY_TO_TIMESTAMP_TZ(submission_time, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS submitted_at,
    TRY_TO_TIMESTAMP_TZ(updated_at, 'YYYY-MM-DD"T"HH24:MI:SS.FF3TZHTZM') AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
  );
[0m14:53:39.080569 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m14:53:39.116080 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: Close
[0m14:53:39.194513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7485bf15-387d-48aa-abcb-8d78ab1057db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e5ad50>]}
[0m14:53:39.195639 [info ] [Thread-1 (]: 1 of 1 OK created sql view model fct_steps.fct_steps ........................... [[32mSUCCESS 1[0m in 2.12s]
[0m14:53:39.196539 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_steps
[0m14:53:39.198317 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:39.198938 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.fct_steps' was properly closed.
[0m14:53:39.199804 [info ] [MainThread]: 
[0m14:53:39.200528 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m14:53:39.201640 [debug] [MainThread]: Command end result
[0m14:53:39.238331 [info ] [MainThread]: 
[0m14:53:39.239004 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:39.239355 [info ] [MainThread]: 
[0m14:53:39.239745 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:53:39.240678 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4528055, "process_in_blocks": "0", "process_kernel_time": 0.483609, "process_mem_max_rss": "133672960", "process_out_blocks": "0", "process_user_time": 2.951432}
[0m14:53:39.241368 [debug] [MainThread]: Command `dbt run` succeeded at 14:53:39.241239 after 6.45 seconds
[0m14:53:39.241794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e33da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11212ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133e34d0>]}
[0m14:53:39.242170 [debug] [MainThread]: Flushing usage events
[0m14:57:53.118617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b5a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b78740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b78530>]}


============================== 14:57:53.126326 | 3cbadf03-0188-4f44-8019-14a291a6a5c3 ==============================
[0m14:57:53.126326 [info ] [MainThread]: Running with dbt=1.8.9
[0m14:57:53.127239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select grouped_patients', 'send_anonymous_usage_stats': 'True'}
[0m14:57:53.825528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cbadf03-0188-4f44-8019-14a291a6a5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d7f20>]}
[0m14:57:53.882548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cbadf03-0188-4f44-8019-14a291a6a5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682e8a0>]}
[0m14:57:53.884895 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m14:57:54.049163 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m14:57:54.150138 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:57:54.150711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3cbadf03-0188-4f44-8019-14a291a6a5c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a451f0>]}
[0m14:57:55.731081 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:57:55.733552 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:57:55.740160 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:57:55.744911 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:57:55.747918 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m14:57:55.749020 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.caspar_health_technical_challenge.results_patients' (models/analysis/results_patients.sql) depends on a node named 'patients_grouped' which was not found
[0m14:57:55.749837 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.7214377, "process_in_blocks": "0", "process_kernel_time": 0.559133, "process_mem_max_rss": "122990592", "process_out_blocks": "0", "process_user_time": 3.324638}
[0m14:57:55.750538 [debug] [MainThread]: Command `dbt run` failed at 14:57:55.750379 after 2.72 seconds
[0m14:57:55.750967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b5a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf04a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10773d790>]}
[0m14:57:55.751494 [debug] [MainThread]: Flushing usage events
[0m15:00:45.361808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ef9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3c500>]}


============================== 15:00:45.369108 | 854f9846-8443-4c32-ba66-79380b98be53 ==============================
[0m15:00:45.369108 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:00:45.370059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_steps', 'send_anonymous_usage_stats': 'True'}
[0m15:00:46.165147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '854f9846-8443-4c32-ba66-79380b98be53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c7d460>]}
[0m15:00:46.250673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '854f9846-8443-4c32-ba66-79380b98be53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3e1b0>]}
[0m15:00:46.252892 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:00:46.428537 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:00:46.541418 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:00:46.542034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '854f9846-8443-4c32-ba66-79380b98be53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10407e330>]}
[0m15:00:48.291465 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:00:48.295638 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:00:48.300455 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:00:48.304558 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:00:48.307635 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:00:48.308536 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.caspar_health_technical_challenge.results_patients' (models/analysis/results_patients.sql) depends on a node named 'patients_grouped' which was not found
[0m15:00:48.309562 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.039639, "process_in_blocks": "0", "process_kernel_time": 0.628587, "process_mem_max_rss": "123359232", "process_out_blocks": "0", "process_user_time": 3.753688}
[0m15:00:48.310311 [debug] [MainThread]: Command `dbt run` failed at 15:00:48.310136 after 3.04 seconds
[0m15:00:48.310764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104862960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c058b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058281d0>]}
[0m15:00:48.311147 [debug] [MainThread]: Flushing usage events
[0m15:01:13.411743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107253a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075586b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075584a0>]}


============================== 15:01:13.418527 | a68dceb8-1aed-43e3-8d74-9a982f8e337d ==============================
[0m15:01:13.418527 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:01:13.419380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select grouped_patients', 'send_anonymous_usage_stats': 'True'}
[0m15:01:14.081619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a68dceb8-1aed-43e3-8d74-9a982f8e337d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10752c380>]}
[0m15:01:14.142086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a68dceb8-1aed-43e3-8d74-9a982f8e337d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10810b9b0>]}
[0m15:01:14.143496 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:01:14.314628 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:01:14.426947 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:01:14.427620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a68dceb8-1aed-43e3-8d74-9a982f8e337d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a9a240>]}
[0m15:01:16.071430 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:01:16.076008 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:01:16.082177 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:01:16.086832 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:01:16.090810 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:01:16.204704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a68dceb8-1aed-43e3-8d74-9a982f8e337d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108506090>]}
[0m15:01:16.323763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a68dceb8-1aed-43e3-8d74-9a982f8e337d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086841d0>]}
[0m15:01:16.324415 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m15:01:16.324901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a68dceb8-1aed-43e3-8d74-9a982f8e337d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108165a90>]}
[0m15:01:16.326923 [info ] [MainThread]: 
[0m15:01:16.328329 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:01:16.329785 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m15:01:16.347322 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m15:01:16.347936 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m15:01:16.348430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:16.980645 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.632 seconds
[0m15:01:16.982584 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m15:01:17.094149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now create_CASPAR_HEALTH_grouped_patients)
[0m15:01:17.094793 [debug] [ThreadPool]: Creating schema "database: "CASPAR_HEALTH"
schema: "grouped_patients"
"
[0m15:01:17.099999 [debug] [ThreadPool]: Using snowflake connection "create_CASPAR_HEALTH_grouped_patients"
[0m15:01:17.100513 [debug] [ThreadPool]: On create_CASPAR_HEALTH_grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "create_CASPAR_HEALTH_grouped_patients"} */
create schema if not exists CASPAR_HEALTH.grouped_patients
[0m15:01:17.100869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:17.478855 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.378 seconds
[0m15:01:17.480258 [debug] [ThreadPool]: On create_CASPAR_HEALTH_grouped_patients: Close
[0m15:01:17.573562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_CASPAR_HEALTH_grouped_patients, now list_CASPAR_HEALTH_fct_steps)
[0m15:01:17.583926 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_steps"
[0m15:01:17.584420 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_steps"} */
show objects in CASPAR_HEALTH.fct_steps limit 10000
[0m15:01:17.584787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:18.554720 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.970 seconds
[0m15:01:18.557667 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: Close
[0m15:01:18.643413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_steps, now list_CASPAR_HEALTH_grouped_patients)
[0m15:01:18.646577 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_grouped_patients"
[0m15:01:18.647196 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_grouped_patients"} */
show objects in CASPAR_HEALTH.grouped_patients limit 10000
[0m15:01:18.647678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:19.506732 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.859 seconds
[0m15:01:19.508371 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: Close
[0m15:01:20.120496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_grouped_patients, now list_CASPAR_HEALTH_results_patients)
[0m15:01:20.124040 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_results_patients"
[0m15:01:20.124721 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_results_patients"} */
show objects in CASPAR_HEALTH.results_patients limit 10000
[0m15:01:20.125515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:20.679381 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8a169-0203-b56e-0003-18c200013cc6
[0m15:01:20.679890 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:01:20.680380 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:01:20.680709 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:01:20.681067 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: Close
[0m15:01:20.814845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_results_patients, now list_CASPAR_HEALTH_fct_exercises)
[0m15:01:20.817354 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_exercises"
[0m15:01:20.817798 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_exercises"} */
show objects in CASPAR_HEALTH.fct_exercises limit 10000
[0m15:01:20.818122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:21.233926 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.416 seconds
[0m15:01:21.235648 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: Close
[0m15:01:21.346025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_exercises, now list_CASPAR_HEALTH_public)
[0m15:01:21.350032 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m15:01:21.350587 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m15:01:21.351030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:21.682074 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.331 seconds
[0m15:01:21.684070 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m15:01:21.796015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_dim_patients)
[0m15:01:21.801089 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_dim_patients"
[0m15:01:21.801667 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_dim_patients"} */
show objects in CASPAR_HEALTH.dim_patients limit 10000
[0m15:01:21.802284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:22.249885 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.448 seconds
[0m15:01:22.252193 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: Close
[0m15:01:22.502299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a68dceb8-1aed-43e3-8d74-9a982f8e337d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894ee70>]}
[0m15:01:22.502998 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:01:22.503426 [info ] [MainThread]: 
[0m15:01:22.506053 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.grouped_patients
[0m15:01:22.506696 [info ] [Thread-1 (]: 1 of 1 START sql view model grouped_patients.grouped_patients .................. [RUN]
[0m15:01:22.507242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_dim_patients, now model.caspar_health_technical_challenge.grouped_patients)
[0m15:01:22.507872 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.grouped_patients
[0m15:01:22.517013 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.grouped_patients"
[0m15:01:22.518131 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.grouped_patients
[0m15:01:22.528104 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:01:22.528766 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
show parameters like 'query_tag' in session
[0m15:01:22.529721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:23.158662 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.629 seconds
[0m15:01:23.160302 [debug] [Thread-1 (]: Setting query_tag to 'grouped_patients'. Will reset to '' after materialization.
[0m15:01:23.161215 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:01:23.161930 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
alter session set query_tag = 'grouped_patients'
[0m15:01:23.269104 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m15:01:23.309076 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:01:23.309657 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
select * from (
        SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.steps * 0.002) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.steps * 0.002) AS total_minutes
FROM  CASPAR_HEALTH.dim_patients.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.fct_exercises.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.fct_steps.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
    ) as __dbt_sbq
    where false
    limit 0
[0m15:01:24.079259 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.769 seconds
[0m15:01:24.092746 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: Close
[0m15:01:24.605454 [debug] [Thread-1 (]: Compilation Error in model grouped_patients (models/analysis/grouped_patients.sql)
  Contracted models require data_type to be defined for each column. Please ensure that the column name and data_type are defined within the YAML configuration for the ['total_minutes'] column(s).
  
  > in macro default__get_empty_schema_sql (macros/adapters/columns.sql)
  > called by macro get_empty_schema_sql (macros/adapters/columns.sql)
  > called by macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro snowflake__create_view_as_with_temp_flag (macros/relations/view/create.sql)
  > called by macro snowflake__create_view_as (macros/relations/view/create.sql)
  > called by macro create_view_as (macros/relations/view/create.sql)
  > called by macro default__get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro snowflake__create_or_replace_view (macros/relations/view/create.sql)
  > called by macro materialization_view_snowflake (macros/materializations/view.sql)
  > called by model grouped_patients (models/analysis/grouped_patients.sql)
[0m15:01:24.607091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a68dceb8-1aed-43e3-8d74-9a982f8e337d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4c080>]}
[0m15:01:24.607878 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model grouped_patients.grouped_patients ......... [[31mERROR[0m in 2.10s]
[0m15:01:24.608706 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.grouped_patients
[0m15:01:24.611442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:24.611884 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.grouped_patients' was properly closed.
[0m15:01:24.612252 [info ] [MainThread]: 
[0m15:01:24.612787 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.28 seconds (8.28s).
[0m15:01:24.613959 [debug] [MainThread]: Command end result
[0m15:01:24.654302 [info ] [MainThread]: 
[0m15:01:24.655442 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:01:24.656187 [info ] [MainThread]: 
[0m15:01:24.658338 [error] [MainThread]:   Compilation Error in model grouped_patients (models/analysis/grouped_patients.sql)
  Contracted models require data_type to be defined for each column. Please ensure that the column name and data_type are defined within the YAML configuration for the ['total_minutes'] column(s).
  
  > in macro default__get_empty_schema_sql (macros/adapters/columns.sql)
  > called by macro get_empty_schema_sql (macros/adapters/columns.sql)
  > called by macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro snowflake__create_view_as_with_temp_flag (macros/relations/view/create.sql)
  > called by macro snowflake__create_view_as (macros/relations/view/create.sql)
  > called by macro create_view_as (macros/relations/view/create.sql)
  > called by macro default__get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro snowflake__create_or_replace_view (macros/relations/view/create.sql)
  > called by macro materialization_view_snowflake (macros/materializations/view.sql)
  > called by model grouped_patients (models/analysis/grouped_patients.sql)
[0m15:01:24.659149 [info ] [MainThread]: 
[0m15:01:24.659773 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:01:24.661272 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.337292, "process_in_blocks": "0", "process_kernel_time": 0.679242, "process_mem_max_rss": "137035776", "process_out_blocks": "0", "process_user_time": 4.567429}
[0m15:01:24.662190 [debug] [MainThread]: Command `dbt run` failed at 15:01:24.662031 after 11.34 seconds
[0m15:01:24.662820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107558440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075586b0>]}
[0m15:01:24.663411 [debug] [MainThread]: Flushing usage events
[0m15:01:34.100904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc6a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c6c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c6c500>]}


============================== 15:01:34.106620 | 2b0a9423-0631-48ae-b2c2-92f04b79016f ==============================
[0m15:01:34.106620 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:01:34.107279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select grouped_patients', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:01:34.644252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b0a9423-0631-48ae-b2c2-92f04b79016f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109eff80>]}
[0m15:01:34.744029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b0a9423-0631-48ae-b2c2-92f04b79016f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111667e90>]}
[0m15:01:34.745242 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:01:34.892264 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:01:35.052437 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m15:01:35.053111 [debug] [MainThread]: Partial parsing: added file: caspar_health_technical_challenge://models/analysis/results_patients.yml
[0m15:01:35.324539 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:01:35.391732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b0a9423-0631-48ae-b2c2-92f04b79016f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e67bc0>]}
[0m15:01:35.482275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b0a9423-0631-48ae-b2c2-92f04b79016f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111affa10>]}
[0m15:01:35.482859 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m15:01:35.483282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b0a9423-0631-48ae-b2c2-92f04b79016f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b93260>]}
[0m15:01:35.485051 [info ] [MainThread]: 
[0m15:01:35.485795 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:01:35.487005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m15:01:35.502061 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m15:01:35.502554 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m15:01:35.502903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:35.996035 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.493 seconds
[0m15:01:36.000805 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m15:01:36.108060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_results_patients)
[0m15:01:36.117705 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_results_patients"
[0m15:01:36.118196 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_results_patients"} */
show objects in CASPAR_HEALTH.results_patients limit 10000
[0m15:01:36.118555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:36.516721 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8a169-0203-b42e-0003-18c200012c86
[0m15:01:36.518113 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:01:36.518925 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:01:36.519507 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:01:36.520206 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: Close
[0m15:01:36.672919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_results_patients, now list_CASPAR_HEALTH_grouped_patients)
[0m15:01:36.675545 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_grouped_patients"
[0m15:01:36.676067 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_grouped_patients"} */
show objects in CASPAR_HEALTH.grouped_patients limit 10000
[0m15:01:36.676403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:37.014827 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.338 seconds
[0m15:01:37.016492 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: Close
[0m15:01:37.104960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_grouped_patients, now list_CASPAR_HEALTH_fct_exercises)
[0m15:01:37.107502 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_exercises"
[0m15:01:37.108061 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_exercises"} */
show objects in CASPAR_HEALTH.fct_exercises limit 10000
[0m15:01:37.108458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:37.486367 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.378 seconds
[0m15:01:37.488117 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: Close
[0m15:01:37.575281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_exercises, now list_CASPAR_HEALTH_fct_steps)
[0m15:01:37.578309 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_steps"
[0m15:01:37.578755 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_steps"} */
show objects in CASPAR_HEALTH.fct_steps limit 10000
[0m15:01:37.579065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:37.934958 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.356 seconds
[0m15:01:37.937219 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: Close
[0m15:01:38.024822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_steps, now list_CASPAR_HEALTH_dim_patients)
[0m15:01:38.029622 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_dim_patients"
[0m15:01:38.030139 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_dim_patients"} */
show objects in CASPAR_HEALTH.dim_patients limit 10000
[0m15:01:38.030599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:38.504460 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.474 seconds
[0m15:01:38.506630 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: Close
[0m15:01:38.591072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_dim_patients, now list_CASPAR_HEALTH_public)
[0m15:01:38.594075 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m15:01:38.594571 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m15:01:38.594915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:38.971042 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.376 seconds
[0m15:01:38.973028 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m15:01:39.403394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b0a9423-0631-48ae-b2c2-92f04b79016f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121e2f30>]}
[0m15:01:39.404479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:01:39.404979 [info ] [MainThread]: 
[0m15:01:39.407613 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.grouped_patients
[0m15:01:39.408292 [info ] [Thread-1 (]: 1 of 1 START sql view model grouped_patients.grouped_patients .................. [RUN]
[0m15:01:39.408822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.grouped_patients)
[0m15:01:39.409273 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.grouped_patients
[0m15:01:39.418534 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.grouped_patients"
[0m15:01:39.419628 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.grouped_patients
[0m15:01:39.430372 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:01:39.431126 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
show parameters like 'query_tag' in session
[0m15:01:39.431540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:39.724254 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.293 seconds
[0m15:01:39.725716 [debug] [Thread-1 (]: Setting query_tag to 'grouped_patients'. Will reset to '' after materialization.
[0m15:01:39.726382 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:01:39.726754 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
alter session set query_tag = 'grouped_patients'
[0m15:01:39.806987 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.080 seconds
[0m15:01:39.848805 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:01:39.849589 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
select * from (
        SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.steps * 0.002) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.steps * 0.002) AS total_minutes
FROM  CASPAR_HEALTH.dim_patients.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.fct_exercises.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.fct_steps.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
    ) as __dbt_sbq
    where false
    limit 0
[0m15:01:40.713352 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.863 seconds
[0m15:01:40.725814 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: Close
[0m15:01:40.823052 [debug] [Thread-1 (]: Compilation Error in model grouped_patients (models/analysis/grouped_patients.sql)
  Contracted models require data_type to be defined for each column. Please ensure that the column name and data_type are defined within the YAML configuration for the ['total_minutes'] column(s).
  
  > in macro default__get_empty_schema_sql (macros/adapters/columns.sql)
  > called by macro get_empty_schema_sql (macros/adapters/columns.sql)
  > called by macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro snowflake__create_view_as_with_temp_flag (macros/relations/view/create.sql)
  > called by macro snowflake__create_view_as (macros/relations/view/create.sql)
  > called by macro create_view_as (macros/relations/view/create.sql)
  > called by macro default__get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro snowflake__create_or_replace_view (macros/relations/view/create.sql)
  > called by macro materialization_view_snowflake (macros/materializations/view.sql)
  > called by model grouped_patients (models/analysis/grouped_patients.sql)
[0m15:01:40.824716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b0a9423-0631-48ae-b2c2-92f04b79016f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101af590>]}
[0m15:01:40.825396 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model grouped_patients.grouped_patients ......... [[31mERROR[0m in 1.41s]
[0m15:01:40.826131 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.grouped_patients
[0m15:01:40.828570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:40.829029 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.grouped_patients' was properly closed.
[0m15:01:40.829360 [info ] [MainThread]: 
[0m15:01:40.829714 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m15:01:40.830463 [debug] [MainThread]: Command end result
[0m15:01:40.865313 [info ] [MainThread]: 
[0m15:01:40.865998 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:01:40.866383 [info ] [MainThread]: 
[0m15:01:40.867138 [error] [MainThread]:   Compilation Error in model grouped_patients (models/analysis/grouped_patients.sql)
  Contracted models require data_type to be defined for each column. Please ensure that the column name and data_type are defined within the YAML configuration for the ['total_minutes'] column(s).
  
  > in macro default__get_empty_schema_sql (macros/adapters/columns.sql)
  > called by macro get_empty_schema_sql (macros/adapters/columns.sql)
  > called by macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro snowflake__create_view_as_with_temp_flag (macros/relations/view/create.sql)
  > called by macro snowflake__create_view_as (macros/relations/view/create.sql)
  > called by macro create_view_as (macros/relations/view/create.sql)
  > called by macro default__get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro snowflake__create_or_replace_view (macros/relations/view/create.sql)
  > called by macro materialization_view_snowflake (macros/materializations/view.sql)
  > called by model grouped_patients (models/analysis/grouped_patients.sql)
[0m15:01:40.867993 [info ] [MainThread]: 
[0m15:01:40.868655 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:01:40.869676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.8455443, "process_in_blocks": "0", "process_kernel_time": 0.514724, "process_mem_max_rss": "133439488", "process_out_blocks": "0", "process_user_time": 3.059863}
[0m15:01:40.870837 [debug] [MainThread]: Command `dbt run` failed at 15:01:40.870654 after 6.85 seconds
[0m15:01:40.871436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc6a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc49730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c4380>]}
[0m15:01:40.871846 [debug] [MainThread]: Flushing usage events
[0m15:02:10.242700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b36e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bde7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be5c380>]}


============================== 15:02:10.249136 | 628029ec-0696-4e7d-b6fd-32131a03f546 ==============================
[0m15:02:10.249136 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:02:10.249779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select grouped_patients', 'send_anonymous_usage_stats': 'True'}
[0m15:02:10.785454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '628029ec-0696-4e7d-b6fd-32131a03f546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b408770>]}
[0m15:02:10.850326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '628029ec-0696-4e7d-b6fd-32131a03f546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca4f2f0>]}
[0m15:02:10.851463 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:02:11.003308 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:02:11.171874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:02:11.172657 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/grouped_patients.yml
[0m15:02:11.456418 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:02:11.526292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '628029ec-0696-4e7d-b6fd-32131a03f546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d06b830>]}
[0m15:02:11.623765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '628029ec-0696-4e7d-b6fd-32131a03f546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc9f560>]}
[0m15:02:11.624321 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m15:02:11.624705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '628029ec-0696-4e7d-b6fd-32131a03f546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0666c0>]}
[0m15:02:11.626550 [info ] [MainThread]: 
[0m15:02:11.627289 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:02:11.628204 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m15:02:11.641592 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m15:02:11.642218 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m15:02:11.642744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:12.249780 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.607 seconds
[0m15:02:12.251528 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m15:02:12.679205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m15:02:12.690850 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m15:02:12.691439 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m15:02:12.691770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:13.209805 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.518 seconds
[0m15:02:13.211813 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m15:02:13.352978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_results_patients)
[0m15:02:13.358098 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_results_patients"
[0m15:02:13.358879 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_results_patients"} */
show objects in CASPAR_HEALTH.results_patients limit 10000
[0m15:02:13.359341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:13.914429 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8a16a-0203-b706-0003-18c2000190a2
[0m15:02:13.914924 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:02:13.915432 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:02:13.915764 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:02:13.916119 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: Close
[0m15:02:14.018510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_results_patients, now list_CASPAR_HEALTH_fct_steps)
[0m15:02:14.021487 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_steps"
[0m15:02:14.022010 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_steps"} */
show objects in CASPAR_HEALTH.fct_steps limit 10000
[0m15:02:14.022332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:14.362012 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.340 seconds
[0m15:02:14.363848 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: Close
[0m15:02:14.440636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_steps, now list_CASPAR_HEALTH_dim_patients)
[0m15:02:14.444038 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_dim_patients"
[0m15:02:14.444543 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_dim_patients"} */
show objects in CASPAR_HEALTH.dim_patients limit 10000
[0m15:02:14.444879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:14.786563 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.342 seconds
[0m15:02:14.788206 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: Close
[0m15:02:14.874534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_dim_patients, now list_CASPAR_HEALTH_grouped_patients)
[0m15:02:14.878628 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_grouped_patients"
[0m15:02:14.879374 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_grouped_patients"} */
show objects in CASPAR_HEALTH.grouped_patients limit 10000
[0m15:02:14.880091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:15.523623 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.644 seconds
[0m15:02:15.525108 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: Close
[0m15:02:15.665175 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_grouped_patients, now list_CASPAR_HEALTH_fct_exercises)
[0m15:02:15.667708 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_exercises"
[0m15:02:15.668091 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_exercises"} */
show objects in CASPAR_HEALTH.fct_exercises limit 10000
[0m15:02:15.668479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:15.989550 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.321 seconds
[0m15:02:15.991455 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: Close
[0m15:02:16.076421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '628029ec-0696-4e7d-b6fd-32131a03f546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbdbc20>]}
[0m15:02:16.077258 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:02:16.077706 [info ] [MainThread]: 
[0m15:02:16.080324 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.grouped_patients
[0m15:02:16.080941 [info ] [Thread-1 (]: 1 of 1 START sql view model grouped_patients.grouped_patients .................. [RUN]
[0m15:02:16.081446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_exercises, now model.caspar_health_technical_challenge.grouped_patients)
[0m15:02:16.081828 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.grouped_patients
[0m15:02:16.091533 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:16.092862 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.grouped_patients
[0m15:02:16.103076 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:16.104084 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
show parameters like 'query_tag' in session
[0m15:02:16.104548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:16.478413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.374 seconds
[0m15:02:16.479856 [debug] [Thread-1 (]: Setting query_tag to 'grouped_patients'. Will reset to '' after materialization.
[0m15:02:16.480555 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:16.480958 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
alter session set query_tag = 'grouped_patients'
[0m15:02:16.632033 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m15:02:16.674572 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:16.675145 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
select * from (
        SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.steps * 0.002) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.steps * 0.002) AS total_minutes
FROM  CASPAR_HEALTH.dim_patients.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.fct_exercises.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.fct_steps.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
    ) as __dbt_sbq
    where false
    limit 0
[0m15:02:17.136234 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.460 seconds
[0m15:02:17.149769 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:17.150429 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country, 
      
    cast(null as number(38, 0))
     as exercises_minutes, 
      
    cast(null as number(38, 0))
     as steps_minutes, 
      
    cast(null as number(38, 0))
     as total_minutes
    ) as __dbt_sbq
    where false
    limit 0
[0m15:02:17.221100 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.070 seconds
[0m15:02:17.226760 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:17.228441 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:17.228924 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
create or replace   view CASPAR_HEALTH.grouped_patients.grouped_patients
  
   as (
    SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.steps * 0.002) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.steps * 0.002) AS total_minutes
FROM  CASPAR_HEALTH.dim_patients.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.fct_exercises.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.fct_steps.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
  );
[0m15:02:17.736212 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m15:02:17.759057 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: Close
[0m15:02:17.854172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '628029ec-0696-4e7d-b6fd-32131a03f546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c87aea0>]}
[0m15:02:17.854998 [info ] [Thread-1 (]: 1 of 1 OK created sql view model grouped_patients.grouped_patients ............. [[32mSUCCESS 1[0m in 1.77s]
[0m15:02:17.855834 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.grouped_patients
[0m15:02:17.857242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:17.857705 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.grouped_patients' was properly closed.
[0m15:02:17.858147 [info ] [MainThread]: 
[0m15:02:17.858561 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.23 seconds (6.23s).
[0m15:02:17.859270 [debug] [MainThread]: Command end result
[0m15:02:17.889831 [info ] [MainThread]: 
[0m15:02:17.890462 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:17.890868 [info ] [MainThread]: 
[0m15:02:17.891263 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:02:17.892613 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.7335625, "process_in_blocks": "0", "process_kernel_time": 0.509072, "process_mem_max_rss": "132849664", "process_out_blocks": "0", "process_user_time": 3.04196}
[0m15:02:17.893444 [debug] [MainThread]: Command `dbt run` succeeded at 15:02:17.893294 after 7.73 seconds
[0m15:02:17.894076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b36e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108820f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7addc0>]}
[0m15:02:17.894777 [debug] [MainThread]: Flushing usage events
[0m15:02:21.081136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f38680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f38410>]}


============================== 15:02:21.087163 | d882a108-328a-4a36-93b7-eb09cbd40ab7 ==============================
[0m15:02:21.087163 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:02:21.087849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select grouped_patients', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:02:21.588998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd882a108-328a-4a36-93b7-eb09cbd40ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109660ef0>]}
[0m15:02:21.655286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd882a108-328a-4a36-93b7-eb09cbd40ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f3a2d0>]}
[0m15:02:21.656443 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:02:21.808347 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:02:21.967354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:02:21.968146 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/grouped_patients.yml
[0m15:02:22.255408 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:02:22.324300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd882a108-328a-4a36-93b7-eb09cbd40ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a040e90>]}
[0m15:02:22.433204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd882a108-328a-4a36-93b7-eb09cbd40ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d069f0>]}
[0m15:02:22.434052 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m15:02:22.434726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd882a108-328a-4a36-93b7-eb09cbd40ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d536e0>]}
[0m15:02:22.436554 [info ] [MainThread]: 
[0m15:02:22.437226 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:02:22.438277 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m15:02:22.455589 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m15:02:22.456104 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m15:02:22.456436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:22.880510 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.424 seconds
[0m15:02:22.882361 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m15:02:23.042600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_grouped_patients)
[0m15:02:23.052863 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_grouped_patients"
[0m15:02:23.053348 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_grouped_patients"} */
show objects in CASPAR_HEALTH.grouped_patients limit 10000
[0m15:02:23.053761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:23.675505 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.622 seconds
[0m15:02:23.677324 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: Close
[0m15:02:23.751286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_grouped_patients, now list_CASPAR_HEALTH_public)
[0m15:02:23.754182 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m15:02:23.754708 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m15:02:23.755112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:24.436484 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.681 seconds
[0m15:02:24.438288 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m15:02:24.517952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_fct_steps)
[0m15:02:24.521323 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_steps"
[0m15:02:24.521781 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_steps"} */
show objects in CASPAR_HEALTH.fct_steps limit 10000
[0m15:02:24.522097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:25.028935 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.507 seconds
[0m15:02:25.030997 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: Close
[0m15:02:25.142071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_steps, now list_CASPAR_HEALTH_fct_exercises)
[0m15:02:25.144719 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_exercises"
[0m15:02:25.145159 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_exercises"} */
show objects in CASPAR_HEALTH.fct_exercises limit 10000
[0m15:02:25.145475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:25.502468 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.357 seconds
[0m15:02:25.504220 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: Close
[0m15:02:25.592993 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_exercises, now list_CASPAR_HEALTH_results_patients)
[0m15:02:25.597012 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_results_patients"
[0m15:02:25.597473 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_results_patients"} */
show objects in CASPAR_HEALTH.results_patients limit 10000
[0m15:02:25.597816 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:25.936762 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8a16a-0203-b56e-0003-18c200013cd6
[0m15:02:25.937235 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:02:25.937718 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:02:25.938058 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:02:25.938425 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: Close
[0m15:02:26.022777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_results_patients, now list_CASPAR_HEALTH_dim_patients)
[0m15:02:26.025306 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_dim_patients"
[0m15:02:26.025781 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_dim_patients"} */
show objects in CASPAR_HEALTH.dim_patients limit 10000
[0m15:02:26.026154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:26.401104 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.375 seconds
[0m15:02:26.402818 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: Close
[0m15:02:26.535354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd882a108-328a-4a36-93b7-eb09cbd40ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d04290>]}
[0m15:02:26.536003 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:02:26.536471 [info ] [MainThread]: 
[0m15:02:26.538581 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.grouped_patients
[0m15:02:26.539244 [info ] [Thread-1 (]: 1 of 1 START sql view model grouped_patients.grouped_patients .................. [RUN]
[0m15:02:26.539807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_dim_patients, now model.caspar_health_technical_challenge.grouped_patients)
[0m15:02:26.540220 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.grouped_patients
[0m15:02:26.549225 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:26.550414 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.grouped_patients
[0m15:02:26.560596 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:26.561225 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
show parameters like 'query_tag' in session
[0m15:02:26.561633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:26.941468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.380 seconds
[0m15:02:26.943371 [debug] [Thread-1 (]: Setting query_tag to 'grouped_patients'. Will reset to '' after materialization.
[0m15:02:26.944210 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:26.944711 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
alter session set query_tag = 'grouped_patients'
[0m15:02:27.019958 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m15:02:27.060103 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:27.060680 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
select * from (
        SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.steps * 0.002) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.steps * 0.002) AS total_minutes
FROM  CASPAR_HEALTH.dim_patients.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.fct_exercises.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.fct_steps.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
    ) as __dbt_sbq
    where false
    limit 0
[0m15:02:27.162505 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.101 seconds
[0m15:02:27.177444 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:27.178128 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country, 
      
    cast(null as number(38, 0))
     as exercises_minutes, 
      
    cast(null as number(38, 3))
     as steps_minutes, 
      
    cast(null as number(38, 3))
     as total_minutes
    ) as __dbt_sbq
    where false
    limit 0
[0m15:02:27.425291 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.246 seconds
[0m15:02:27.431666 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:27.433473 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:27.434024 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
create or replace   view CASPAR_HEALTH.grouped_patients.grouped_patients
  
   as (
    SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.steps * 0.002) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.steps * 0.002) AS total_minutes
FROM  CASPAR_HEALTH.dim_patients.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.fct_exercises.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.fct_steps.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
  );
[0m15:02:28.122270 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m15:02:28.151116 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: Close
[0m15:02:28.489508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd882a108-328a-4a36-93b7-eb09cbd40ab7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10995af60>]}
[0m15:02:28.490397 [info ] [Thread-1 (]: 1 of 1 OK created sql view model grouped_patients.grouped_patients ............. [[32mSUCCESS 1[0m in 1.95s]
[0m15:02:28.491386 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.grouped_patients
[0m15:02:28.511900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:28.512605 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.grouped_patients' was properly closed.
[0m15:02:28.513377 [info ] [MainThread]: 
[0m15:02:28.514097 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.08 seconds (6.08s).
[0m15:02:28.515316 [debug] [MainThread]: Command end result
[0m15:02:28.560999 [info ] [MainThread]: 
[0m15:02:28.562000 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:28.562668 [info ] [MainThread]: 
[0m15:02:28.563386 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:02:28.564475 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.5610814, "process_in_blocks": "0", "process_kernel_time": 0.507372, "process_mem_max_rss": "133189632", "process_out_blocks": "0", "process_user_time": 3.110859}
[0m15:02:28.565300 [debug] [MainThread]: Command `dbt run` succeeded at 15:02:28.565149 after 7.56 seconds
[0m15:02:28.566147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec7b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896d850>]}
[0m15:02:28.566824 [debug] [MainThread]: Flushing usage events
[0m15:02:33.342212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d71b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e238560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e238350>]}


============================== 15:02:33.351835 | ef877921-a3e8-4c9e-9504-c98479d797e0 ==============================
[0m15:02:33.351835 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:02:33.353402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:02:34.416269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef877921-a3e8-4c9e-9504-c98479d797e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb3e1b0>]}
[0m15:02:34.480846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef877921-a3e8-4c9e-9504-c98479d797e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edb7110>]}
[0m15:02:34.482417 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:02:34.693501 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:02:34.936590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:02:34.960773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:02:34.998800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef877921-a3e8-4c9e-9504-c98479d797e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e239b20>]}
[0m15:02:35.106079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef877921-a3e8-4c9e-9504-c98479d797e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f007230>]}
[0m15:02:35.106678 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m15:02:35.107133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef877921-a3e8-4c9e-9504-c98479d797e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1e4170>]}
[0m15:02:35.109237 [info ] [MainThread]: 
[0m15:02:35.109937 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:02:35.114465 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m15:02:35.133154 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m15:02:35.133639 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m15:02:35.134018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:36.170349 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.036 seconds
[0m15:02:36.172271 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m15:02:36.260350 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m15:02:36.260862 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m15:02:36.261194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:36.588417 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.327 seconds
[0m15:02:36.590081 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m15:02:36.742015 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m15:02:36.742530 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m15:02:36.742871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:37.292932 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.550 seconds
[0m15:02:37.294561 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m15:02:37.453184 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m15:02:37.453634 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m15:02:37.454042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:37.928629 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.475 seconds
[0m15:02:37.930319 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m15:02:38.015615 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m15:02:38.016078 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m15:02:38.016419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:38.408527 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.392 seconds
[0m15:02:38.410562 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m15:02:38.485717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now create_CASPAR_HEALTH_results_patients)
[0m15:02:38.486393 [debug] [ThreadPool]: Creating schema "database: "CASPAR_HEALTH"
schema: "results_patients"
"
[0m15:02:38.491403 [debug] [ThreadPool]: Using snowflake connection "create_CASPAR_HEALTH_results_patients"
[0m15:02:38.491974 [debug] [ThreadPool]: On create_CASPAR_HEALTH_results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "create_CASPAR_HEALTH_results_patients"} */
create schema if not exists CASPAR_HEALTH.results_patients
[0m15:02:38.492349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:38.831910 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.340 seconds
[0m15:02:38.833459 [debug] [ThreadPool]: On create_CASPAR_HEALTH_results_patients: Close
[0m15:02:38.920383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_CASPAR_HEALTH_results_patients, now list_CASPAR_HEALTH_results_patients)
[0m15:02:38.929984 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_results_patients"
[0m15:02:38.930445 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_results_patients"} */
show objects in CASPAR_HEALTH.results_patients limit 10000
[0m15:02:38.930770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:39.252670 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.322 seconds
[0m15:02:39.254439 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: Close
[0m15:02:39.504682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_results_patients, now list_CASPAR_HEALTH_grouped_patients)
[0m15:02:39.508933 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_grouped_patients"
[0m15:02:39.509970 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_grouped_patients"} */
show objects in CASPAR_HEALTH.grouped_patients limit 10000
[0m15:02:39.510764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:39.946991 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.436 seconds
[0m15:02:39.948658 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: Close
[0m15:02:40.171570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_grouped_patients, now list_CASPAR_HEALTH_dim_patients)
[0m15:02:40.174150 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_dim_patients"
[0m15:02:40.174592 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_dim_patients"} */
show objects in CASPAR_HEALTH.dim_patients limit 10000
[0m15:02:40.174926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:40.493288 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.318 seconds
[0m15:02:40.495073 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: Close
[0m15:02:40.611902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_dim_patients, now list_CASPAR_HEALTH_fct_steps)
[0m15:02:40.615344 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_steps"
[0m15:02:40.615971 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_steps"} */
show objects in CASPAR_HEALTH.fct_steps limit 10000
[0m15:02:40.616365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:41.084088 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.468 seconds
[0m15:02:41.085962 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: Close
[0m15:02:41.211625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_steps, now list_CASPAR_HEALTH_fct_exercises)
[0m15:02:41.214323 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_exercises"
[0m15:02:41.214774 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_exercises"} */
show objects in CASPAR_HEALTH.fct_exercises limit 10000
[0m15:02:41.215106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:41.743040 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.528 seconds
[0m15:02:41.745577 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: Close
[0m15:02:41.833297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_exercises, now list_CASPAR_HEALTH_public)
[0m15:02:41.836011 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m15:02:41.836549 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m15:02:41.836901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:42.153724 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.317 seconds
[0m15:02:42.156453 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m15:02:42.559149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef877921-a3e8-4c9e-9504-c98479d797e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f45be60>]}
[0m15:02:42.559948 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:02:42.560488 [info ] [MainThread]: 
[0m15:02:42.563374 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.dim_patients
[0m15:02:42.564015 [info ] [Thread-1 (]: 1 of 5 START sql view model dim_patients.dim_patients .......................... [RUN]
[0m15:02:42.564609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now model.caspar_health_technical_challenge.dim_patients)
[0m15:02:42.565073 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.dim_patients
[0m15:02:42.573467 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.dim_patients"
[0m15:02:42.574623 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.dim_patients
[0m15:02:42.588121 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m15:02:42.588748 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
show parameters like 'query_tag' in session
[0m15:02:42.589179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:42.983908 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.395 seconds
[0m15:02:42.985777 [debug] [Thread-1 (]: Setting query_tag to 'dim_patients'. Will reset to '' after materialization.
[0m15:02:42.986597 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m15:02:42.987135 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
alter session set query_tag = 'dim_patients'
[0m15:02:43.074656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m15:02:43.126536 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m15:02:43.127272 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
    ) as __dbt_sbq
    where false
    limit 0
[0m15:02:43.194046 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.066 seconds
[0m15:02:43.208536 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m15:02:43.209095 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country
    ) as __dbt_sbq
    where false
    limit 0
[0m15:02:43.294355 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.085 seconds
[0m15:02:43.303694 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.dim_patients"
[0m15:02:43.305441 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m15:02:43.306061 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
create or replace   view CASPAR_HEALTH.dim_patients.dim_patients
  
   as (
    SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
  );
[0m15:02:43.469496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.163 seconds
[0m15:02:43.496133 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: Close
[0m15:02:43.584597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef877921-a3e8-4c9e-9504-c98479d797e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d77b590>]}
[0m15:02:43.585420 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dim_patients.dim_patients ..................... [[32mSUCCESS 1[0m in 1.02s]
[0m15:02:43.586229 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.dim_patients
[0m15:02:43.586712 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_exercises
[0m15:02:43.587260 [info ] [Thread-1 (]: 2 of 5 START sql view model fct_exercises.fct_exercises ........................ [RUN]
[0m15:02:43.587741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.dim_patients, now model.caspar_health_technical_challenge.fct_exercises)
[0m15:02:43.588119 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_exercises
[0m15:02:43.591386 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_exercises"
[0m15:02:43.592417 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_exercises
[0m15:02:43.594944 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m15:02:43.595465 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
show parameters like 'query_tag' in session
[0m15:02:43.595846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:44.004848 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.409 seconds
[0m15:02:44.006649 [debug] [Thread-1 (]: Setting query_tag to 'fct_exercises'. Will reset to '' after materialization.
[0m15:02:44.007720 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m15:02:44.008300 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
alter session set query_tag = 'fct_exercises'
[0m15:02:44.094510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m15:02:44.097216 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m15:02:44.097902 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
select * from (
        SELECT
    id,
    external_id AS patient_id,
    minutes,
    completed_at::TIMESTAMP_TZ AS completed_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_exercises
    ) as __dbt_sbq
    where false
    limit 0
[0m15:02:44.189646 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.091 seconds
[0m15:02:44.193462 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m15:02:44.194022 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as number(38, 0))
     as patient_id, 
      
    cast(null as number(38, 0))
     as minutes, 
      
    cast(null as timestamp_tz)
     as completed_at, 
      
    cast(null as timestamp_tz)
     as updated_at
    ) as __dbt_sbq
    where false
    limit 0
[0m15:02:44.448007 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.253 seconds
[0m15:02:44.449650 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_exercises"
[0m15:02:44.451289 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m15:02:44.451813 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
create or replace   view CASPAR_HEALTH.fct_exercises.fct_exercises
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    minutes,
    completed_at::TIMESTAMP_TZ AS completed_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_exercises
  );
[0m15:02:44.734762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.282 seconds
[0m15:02:44.749046 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: Close
[0m15:02:44.975506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef877921-a3e8-4c9e-9504-c98479d797e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed44d70>]}
[0m15:02:44.976428 [info ] [Thread-1 (]: 2 of 5 OK created sql view model fct_exercises.fct_exercises ................... [[32mSUCCESS 1[0m in 1.39s]
[0m15:02:44.977261 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_exercises
[0m15:02:44.977769 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_steps
[0m15:02:44.978447 [info ] [Thread-1 (]: 3 of 5 START sql view model fct_steps.fct_steps ................................ [RUN]
[0m15:02:44.979446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.fct_exercises, now model.caspar_health_technical_challenge.fct_steps)
[0m15:02:44.980078 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_steps
[0m15:02:44.984049 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_steps"
[0m15:02:44.985134 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_steps
[0m15:02:44.987732 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:02:44.988338 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
show parameters like 'query_tag' in session
[0m15:02:44.988794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:45.321290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.332 seconds
[0m15:02:45.322976 [debug] [Thread-1 (]: Setting query_tag to 'fct_steps'. Will reset to '' after materialization.
[0m15:02:45.323770 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:02:45.324287 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
alter session set query_tag = 'fct_steps'
[0m15:02:45.438340 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m15:02:45.441554 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:02:45.442135 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
select * from (
        SELECT
    id,
    external_id AS patient_id,
    steps,
    steps * 0.002 AS minutes,
    submission_time::TIMESTAMP_TZ AS submitted_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
    ) as __dbt_sbq
    where false
    limit 0
[0m15:02:45.667723 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.225 seconds
[0m15:02:45.673367 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:02:45.674081 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as number(38, 0))
     as patient_id, 
      
    cast(null as number(38, 0))
     as steps, 
      
    cast(null as number(38, 3))
     as minutes, 
      
    cast(null as timestamp_tz)
     as submitted_at, 
      
    cast(null as timestamp_tz)
     as updated_at
    ) as __dbt_sbq
    where false
    limit 0
[0m15:02:45.765779 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.091 seconds
[0m15:02:45.767749 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_steps"
[0m15:02:45.769628 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:02:45.770380 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
create or replace   view CASPAR_HEALTH.fct_steps.fct_steps
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    steps,
    steps * 0.002 AS minutes,
    submission_time::TIMESTAMP_TZ AS submitted_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
  );
[0m15:02:46.044229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.273 seconds
[0m15:02:46.046757 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: Close
[0m15:02:46.131018 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef877921-a3e8-4c9e-9504-c98479d797e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4a3320>]}
[0m15:02:46.131806 [info ] [Thread-1 (]: 3 of 5 OK created sql view model fct_steps.fct_steps ........................... [[32mSUCCESS 1[0m in 1.15s]
[0m15:02:46.132693 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_steps
[0m15:02:46.133823 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.grouped_patients
[0m15:02:46.134713 [info ] [Thread-1 (]: 4 of 5 START sql view model grouped_patients.grouped_patients .................. [RUN]
[0m15:02:46.135335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.fct_steps, now model.caspar_health_technical_challenge.grouped_patients)
[0m15:02:46.135976 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.grouped_patients
[0m15:02:46.139972 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:46.141590 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.grouped_patients
[0m15:02:46.147905 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:46.150104 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
show parameters like 'query_tag' in session
[0m15:02:46.150658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:46.539609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m15:02:46.545372 [debug] [Thread-1 (]: Setting query_tag to 'grouped_patients'. Will reset to '' after materialization.
[0m15:02:46.546425 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:46.546962 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
alter session set query_tag = 'grouped_patients'
[0m15:02:46.621306 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m15:02:46.626131 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:46.626704 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
select * from (
        SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.steps * 0.002) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.steps * 0.002) AS total_minutes
FROM  CASPAR_HEALTH.dim_patients.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.fct_exercises.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.fct_steps.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
    ) as __dbt_sbq
    where false
    limit 0
[0m15:02:46.974077 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.347 seconds
[0m15:02:46.976793 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:46.977317 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country, 
      
    cast(null as number(38, 0))
     as exercises_minutes, 
      
    cast(null as number(38, 3))
     as steps_minutes, 
      
    cast(null as number(38, 3))
     as total_minutes
    ) as __dbt_sbq
    where false
    limit 0
[0m15:02:47.070097 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.092 seconds
[0m15:02:47.071938 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:47.073720 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:02:47.074226 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
create or replace   view CASPAR_HEALTH.grouped_patients.grouped_patients
  
   as (
    SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.steps * 0.002) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.steps * 0.002) AS total_minutes
FROM  CASPAR_HEALTH.dim_patients.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.fct_exercises.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.fct_steps.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
  );
[0m15:02:48.048239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.973 seconds
[0m15:02:48.050639 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: Close
[0m15:02:48.158224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef877921-a3e8-4c9e-9504-c98479d797e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5aa420>]}
[0m15:02:48.159239 [info ] [Thread-1 (]: 4 of 5 OK created sql view model grouped_patients.grouped_patients ............. [[32mSUCCESS 1[0m in 2.02s]
[0m15:02:48.160194 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.grouped_patients
[0m15:02:48.161333 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.results_patients
[0m15:02:48.162277 [info ] [Thread-1 (]: 5 of 5 START sql view model results_patients.results_patients .................. [RUN]
[0m15:02:48.163181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.grouped_patients, now model.caspar_health_technical_challenge.results_patients)
[0m15:02:48.163893 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.results_patients
[0m15:02:48.168443 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.results_patients"
[0m15:02:48.169717 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.results_patients
[0m15:02:48.173373 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m15:02:48.174054 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
show parameters like 'query_tag' in session
[0m15:02:48.174593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:48.907982 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.733 seconds
[0m15:02:48.909480 [debug] [Thread-1 (]: Setting query_tag to 'results_patients'. Will reset to '' after materialization.
[0m15:02:48.910319 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m15:02:48.910861 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
alter session set query_tag = 'results_patients'
[0m15:02:48.974856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.063 seconds
[0m15:02:48.977691 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m15:02:48.978272 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
select * from (
        WITH top_minutes_patient AS (
SELECT
  MAX_BY(patients_grouped.id, patients_grouped.total_minutes) AS id
FROM CASPAR_HEALTH.grouped_patients.grouped_patients
  AS patients_grouped
)

SELECT
  top_minutes_patient.id,
  dim_patients.first_name,
  dim_patients.last_name,
  dim_patients.country
FROM top_minutes_patient
LEFT JOIN CASPAR_HEALTH.dim_patients.dim_patients
  AS dim_patients
  ON dim_patients.id =   top_minutes_patient.id
    ) as __dbt_sbq
    where false
    limit 0
[0m15:02:49.135768 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.157 seconds
[0m15:02:49.137471 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m15:02:49.138111 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country
    ) as __dbt_sbq
    where false
    limit 0
[0m15:02:49.192637 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.054 seconds
[0m15:02:49.194011 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.results_patients"
[0m15:02:49.195441 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m15:02:49.195882 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
create or replace   view CASPAR_HEALTH.results_patients.results_patients
  
   as (
    WITH top_minutes_patient AS (
SELECT
  MAX_BY(patients_grouped.id, patients_grouped.total_minutes) AS id
FROM CASPAR_HEALTH.grouped_patients.grouped_patients
  AS patients_grouped
)

SELECT
  top_minutes_patient.id,
  dim_patients.first_name,
  dim_patients.last_name,
  dim_patients.country
FROM top_minutes_patient
LEFT JOIN CASPAR_HEALTH.dim_patients.dim_patients
  AS dim_patients
  ON dim_patients.id =   top_minutes_patient.id
  );
[0m15:02:49.626575 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m15:02:49.628633 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: Close
[0m15:02:49.727451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef877921-a3e8-4c9e-9504-c98479d797e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efab9e0>]}
[0m15:02:49.728183 [info ] [Thread-1 (]: 5 of 5 OK created sql view model results_patients.results_patients ............. [[32mSUCCESS 1[0m in 1.56s]
[0m15:02:49.728814 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.results_patients
[0m15:02:49.730213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:49.730728 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.results_patients' was properly closed.
[0m15:02:49.731316 [info ] [MainThread]: 
[0m15:02:49.731909 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 14.62 seconds (14.62s).
[0m15:02:49.733189 [debug] [MainThread]: Command end result
[0m15:02:49.768778 [info ] [MainThread]: 
[0m15:02:49.769423 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:49.769844 [info ] [MainThread]: 
[0m15:02:49.770347 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:02:49.771401 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.530647, "process_in_blocks": "0", "process_kernel_time": 0.808062, "process_mem_max_rss": "127143936", "process_out_blocks": "0", "process_user_time": 3.852596}
[0m15:02:49.772139 [debug] [MainThread]: Command `dbt run` succeeded at 15:02:49.771955 after 16.53 seconds
[0m15:02:49.772643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2d9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed47c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed46030>]}
[0m15:02:49.773199 [debug] [MainThread]: Flushing usage events
[0m15:05:31.371709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fe4ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111038500>]}


============================== 15:05:31.377897 | 4aca293e-781e-490e-a7b2-84a0d69fcff5 ==============================
[0m15:05:31.377897 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:05:31.378557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_steps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:05:32.092062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4aca293e-781e-490e-a7b2-84a0d69fcff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b13e60>]}
[0m15:05:32.163397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4aca293e-781e-490e-a7b2-84a0d69fcff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111696780>]}
[0m15:05:32.165333 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:05:32.319125 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:05:32.555164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:05:32.555894 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/results_patients.yml
[0m15:05:32.556457 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/grouped_patients.yml
[0m15:05:32.557498 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/grouped_patients.sql
[0m15:05:32.827531 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:05:32.899660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4aca293e-781e-490e-a7b2-84a0d69fcff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120d4b00>]}
[0m15:05:33.012427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4aca293e-781e-490e-a7b2-84a0d69fcff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e05cd0>]}
[0m15:05:33.012997 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m15:05:33.013379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4aca293e-781e-490e-a7b2-84a0d69fcff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120e3170>]}
[0m15:05:33.015086 [info ] [MainThread]: 
[0m15:05:33.015745 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:05:33.016671 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m15:05:33.030151 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m15:05:33.030614 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m15:05:33.030950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:05:33.721848 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.691 seconds
[0m15:05:33.723867 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m15:05:33.820293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m15:05:33.830335 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m15:05:33.830845 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m15:05:33.831220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:34.204764 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.373 seconds
[0m15:05:34.206834 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m15:05:34.297433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_grouped_patients)
[0m15:05:34.301595 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_grouped_patients"
[0m15:05:34.302383 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_grouped_patients"} */
show objects in CASPAR_HEALTH.grouped_patients limit 10000
[0m15:05:34.303105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:34.695071 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.392 seconds
[0m15:05:34.697226 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: Close
[0m15:05:34.774292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_grouped_patients, now list_CASPAR_HEALTH_results_patients)
[0m15:05:34.777154 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_results_patients"
[0m15:05:34.777618 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_results_patients"} */
show objects in CASPAR_HEALTH.results_patients limit 10000
[0m15:05:34.777933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:35.117220 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.339 seconds
[0m15:05:35.119320 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: Close
[0m15:05:35.200415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_results_patients, now list_CASPAR_HEALTH_fct_steps)
[0m15:05:35.203318 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_steps"
[0m15:05:35.203780 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_steps"} */
show objects in CASPAR_HEALTH.fct_steps limit 10000
[0m15:05:35.204084 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:35.533401 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.329 seconds
[0m15:05:35.535124 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: Close
[0m15:05:35.813490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_steps, now list_CASPAR_HEALTH_dim_patients)
[0m15:05:35.817830 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_dim_patients"
[0m15:05:35.818408 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_dim_patients"} */
show objects in CASPAR_HEALTH.dim_patients limit 10000
[0m15:05:35.818836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:36.202091 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.383 seconds
[0m15:05:36.203754 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: Close
[0m15:05:36.287934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_dim_patients, now list_CASPAR_HEALTH_fct_exercises)
[0m15:05:36.290463 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_exercises"
[0m15:05:36.290844 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_exercises"} */
show objects in CASPAR_HEALTH.fct_exercises limit 10000
[0m15:05:36.291166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:05:36.698604 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.407 seconds
[0m15:05:36.700330 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: Close
[0m15:05:36.792004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4aca293e-781e-490e-a7b2-84a0d69fcff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e57d5b0>]}
[0m15:05:36.792854 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:05:36.793319 [info ] [MainThread]: 
[0m15:05:36.795868 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_steps
[0m15:05:36.796647 [info ] [Thread-1 (]: 1 of 1 START sql view model fct_steps.fct_steps ................................ [RUN]
[0m15:05:36.797286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_exercises, now model.caspar_health_technical_challenge.fct_steps)
[0m15:05:36.797826 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_steps
[0m15:05:36.805599 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_steps"
[0m15:05:36.807369 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_steps
[0m15:05:36.817849 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:05:36.818380 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
show parameters like 'query_tag' in session
[0m15:05:36.818741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:05:37.162985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.344 seconds
[0m15:05:37.164431 [debug] [Thread-1 (]: Setting query_tag to 'fct_steps'. Will reset to '' after materialization.
[0m15:05:37.165470 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:05:37.165905 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
alter session set query_tag = 'fct_steps'
[0m15:05:37.237364 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m15:05:37.276432 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:05:37.276943 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
select * from (
        SELECT
    id,
    external_id AS patient_id,
    steps,
    steps * 0.002 AS minutes,
    submission_time::TIMESTAMP_TZ AS submitted_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
    ) as __dbt_sbq
    where false
    limit 0
[0m15:05:37.365392 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.088 seconds
[0m15:05:37.379248 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:05:37.379770 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as number(38, 0))
     as patient_id, 
      
    cast(null as number(38, 0))
     as steps, 
      
    cast(null as number(38, 3))
     as minutes, 
      
    cast(null as timestamp_tz)
     as submitted_at, 
      
    cast(null as timestamp_tz)
     as updated_at
    ) as __dbt_sbq
    where false
    limit 0
[0m15:05:37.523581 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.143 seconds
[0m15:05:37.530146 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_steps"
[0m15:05:37.531484 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:05:37.531941 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
create or replace   view CASPAR_HEALTH.fct_steps.fct_steps
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    steps,
    steps * 0.002 AS minutes,
    submission_time::TIMESTAMP_TZ AS submitted_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
  );
[0m15:05:40.764188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.232 seconds
[0m15:05:40.790316 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: Close
[0m15:05:40.870411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4aca293e-781e-490e-a7b2-84a0d69fcff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a5ae40>]}
[0m15:05:40.871163 [info ] [Thread-1 (]: 1 of 1 OK created sql view model fct_steps.fct_steps ........................... [[32mSUCCESS 1[0m in 4.07s]
[0m15:05:40.871825 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_steps
[0m15:05:40.873134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:05:40.873529 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.fct_steps' was properly closed.
[0m15:05:40.873875 [info ] [MainThread]: 
[0m15:05:40.874241 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.86 seconds (7.86s).
[0m15:05:40.874953 [debug] [MainThread]: Command end result
[0m15:05:40.909545 [info ] [MainThread]: 
[0m15:05:40.910121 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:05:40.910553 [info ] [MainThread]: 
[0m15:05:40.911014 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:05:40.911848 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.618595, "process_in_blocks": "0", "process_kernel_time": 0.61247, "process_mem_max_rss": "133992448", "process_out_blocks": "0", "process_user_time": 3.066558}
[0m15:05:40.912367 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:40.912270 after 9.62 seconds
[0m15:05:40.912742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119113a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119ff230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc7b90>]}
[0m15:05:40.913130 [debug] [MainThread]: Flushing usage events
[0m15:12:18.709607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106e8a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11073c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11073c590>]}


============================== 15:12:18.719365 | e64dde0f-bf2d-4125-9b86-71ff662e6431 ==============================
[0m15:12:18.719365 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:12:18.720084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_steps --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m15:12:19.493454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e64dde0f-bf2d-4125-9b86-71ff662e6431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11123e570>]}
[0m15:12:19.555763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e64dde0f-bf2d-4125-9b86-71ff662e6431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110486840>]}
[0m15:12:19.557566 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:12:19.735080 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:12:19.997295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:12:19.997763 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:12:20.037989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e64dde0f-bf2d-4125-9b86-71ff662e6431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11130dfa0>]}
[0m15:12:20.160715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e64dde0f-bf2d-4125-9b86-71ff662e6431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11148e5a0>]}
[0m15:12:20.161263 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m15:12:20.161657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e64dde0f-bf2d-4125-9b86-71ff662e6431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f1f4a0>]}
[0m15:12:20.163607 [info ] [MainThread]: 
[0m15:12:20.164325 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:12:20.165246 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m15:12:20.182520 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m15:12:20.182973 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m15:12:20.183347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:20.811360 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.628 seconds
[0m15:12:20.813426 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m15:12:20.910931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now create_CASPAR_HEALTH_fct_steps)
[0m15:12:20.924921 [debug] [ThreadPool]: Creating schema "database: "CASPAR_HEALTH"
schema: "fct_steps"
"
[0m15:12:20.930059 [debug] [ThreadPool]: Using snowflake connection "create_CASPAR_HEALTH_fct_steps"
[0m15:12:20.930522 [debug] [ThreadPool]: On create_CASPAR_HEALTH_fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "create_CASPAR_HEALTH_fct_steps"} */
create schema if not exists CASPAR_HEALTH.fct_steps
[0m15:12:20.930849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:21.298025 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.367 seconds
[0m15:12:21.299136 [debug] [ThreadPool]: On create_CASPAR_HEALTH_fct_steps: Close
[0m15:12:21.383621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_CASPAR_HEALTH_fct_steps, now list_CASPAR_HEALTH_results_patients)
[0m15:12:21.393351 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_results_patients"
[0m15:12:21.393868 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_results_patients"} */
show objects in CASPAR_HEALTH.results_patients limit 10000
[0m15:12:21.394244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:21.756833 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8a174-0203-b55c-0003-18c20001533a
[0m15:12:21.757293 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:12:21.757774 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:12:21.758246 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:12:21.758805 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: Close
[0m15:12:21.842956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_results_patients, now list_CASPAR_HEALTH_grouped_patients)
[0m15:12:21.845411 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_grouped_patients"
[0m15:12:21.845839 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_grouped_patients"} */
show objects in CASPAR_HEALTH.grouped_patients limit 10000
[0m15:12:21.846157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:22.200346 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8a174-0203-b706-0003-18c2000191de
[0m15:12:22.200849 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:12:22.201365 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:12:22.201745 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:12:22.202110 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: Close
[0m15:12:22.296809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_grouped_patients, now list_CASPAR_HEALTH_public)
[0m15:12:22.299170 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m15:12:22.299606 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m15:12:22.299911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:22.708782 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.409 seconds
[0m15:12:22.710717 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m15:12:22.787940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_fct_exercises)
[0m15:12:22.791305 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_exercises"
[0m15:12:22.791824 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_exercises"} */
show objects in CASPAR_HEALTH.fct_exercises limit 10000
[0m15:12:22.792197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:23.292171 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8a174-0203-b580-0003-18c20001736e
[0m15:12:23.292753 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:12:23.293270 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:12:23.293600 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:12:23.293952 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: Close
[0m15:12:23.384212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_exercises, now list_CASPAR_HEALTH_fct_steps)
[0m15:12:23.387153 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_steps"
[0m15:12:23.387648 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_steps"} */
show objects in CASPAR_HEALTH.fct_steps limit 10000
[0m15:12:23.388022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:23.797099 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.409 seconds
[0m15:12:23.807328 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: Close
[0m15:12:23.920802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_steps, now list_CASPAR_HEALTH_dim_patients)
[0m15:12:23.932829 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_dim_patients"
[0m15:12:23.948812 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_dim_patients"} */
show objects in CASPAR_HEALTH.dim_patients limit 10000
[0m15:12:23.949353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:24.275459 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8a174-0203-b6af-0003-18c20001438a
[0m15:12:24.276075 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:12:24.276873 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:12:24.277607 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:12:24.278210 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: Close
[0m15:12:24.402153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e64dde0f-bf2d-4125-9b86-71ff662e6431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111256990>]}
[0m15:12:24.402939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:12:24.403517 [info ] [MainThread]: 
[0m15:12:24.407315 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_steps
[0m15:12:24.408317 [info ] [Thread-1 (]: 1 of 1 START sql view model fct_steps.fct_steps ................................ [RUN]
[0m15:12:24.409292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_dim_patients, now model.caspar_health_technical_challenge.fct_steps)
[0m15:12:24.410065 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_steps
[0m15:12:24.425169 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_steps"
[0m15:12:24.428755 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_steps
[0m15:12:24.441658 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:12:24.442582 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
show parameters like 'query_tag' in session
[0m15:12:24.443084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:24.763478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.320 seconds
[0m15:12:24.764903 [debug] [Thread-1 (]: Setting query_tag to 'fct_steps'. Will reset to '' after materialization.
[0m15:12:24.766294 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:12:24.766739 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
alter session set query_tag = 'fct_steps'
[0m15:12:24.832207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.065 seconds
[0m15:12:24.876966 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:12:24.877769 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
select * from (
        SELECT
    id,
    external_id AS patient_id,
    steps,
    steps * 0.002 AS minutes,
    submission_time::TIMESTAMP_TZ AS submitted_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
    ) as __dbt_sbq
    where false
    limit 0
[0m15:12:24.949284 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.071 seconds
[0m15:12:24.962132 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:12:24.962741 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as number(38, 0))
     as patient_id, 
      
    cast(null as number(38, 0))
     as steps, 
      
    cast(null as number(38, 3))
     as minutes, 
      
    cast(null as timestamp_tz)
     as submitted_at, 
      
    cast(null as timestamp_tz)
     as updated_at
    ) as __dbt_sbq
    where false
    limit 0
[0m15:12:25.449840 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.487 seconds
[0m15:12:25.455758 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_steps"
[0m15:12:25.457715 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:12:25.458286 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
create or replace   view CASPAR_HEALTH.fct_steps.fct_steps
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    steps,
    steps * 0.002 AS minutes,
    submission_time::TIMESTAMP_TZ AS submitted_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
  );
[0m15:12:25.648117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.189 seconds
[0m15:12:25.672445 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: Close
[0m15:12:25.776134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e64dde0f-bf2d-4125-9b86-71ff662e6431', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11115ef60>]}
[0m15:12:25.776943 [info ] [Thread-1 (]: 1 of 1 OK created sql view model fct_steps.fct_steps ........................... [[32mSUCCESS 1[0m in 1.37s]
[0m15:12:25.777666 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_steps
[0m15:12:25.779170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:25.779587 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.fct_steps' was properly closed.
[0m15:12:25.779951 [info ] [MainThread]: 
[0m15:12:25.780358 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m15:12:25.781189 [debug] [MainThread]: Command end result
[0m15:12:25.876736 [info ] [MainThread]: 
[0m15:12:25.877390 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:12:25.877745 [info ] [MainThread]: 
[0m15:12:25.878142 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:12:25.878760 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2640705, "process_in_blocks": "0", "process_kernel_time": 0.61902, "process_mem_max_rss": "131985408", "process_out_blocks": "0", "process_user_time": 2.9249}
[0m15:12:25.879344 [debug] [MainThread]: Command `dbt run` succeeded at 15:12:25.879202 after 7.26 seconds
[0m15:12:25.879759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100b5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d317200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aa7f50>]}
[0m15:12:25.880133 [debug] [MainThread]: Flushing usage events
[0m15:13:41.746536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104bc710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d0bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110924560>]}


============================== 15:13:41.753320 | b95bb579-53ef-4b2c-87af-f2fc2bfc70d1 ==============================
[0m15:13:41.753320 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:13:41.754071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_steps', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:13:42.640986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b95bb579-53ef-4b2c-87af-f2fc2bfc70d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114a3b90>]}
[0m15:13:42.745578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b95bb579-53ef-4b2c-87af-f2fc2bfc70d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111227b00>]}
[0m15:13:42.747635 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:13:42.959197 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:13:43.073439 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:13:43.074248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b95bb579-53ef-4b2c-87af-f2fc2bfc70d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117ecf80>]}
[0m15:13:44.709307 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:13:44.714453 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:13:44.720307 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:13:44.724074 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:13:44.726430 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:13:44.823426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b95bb579-53ef-4b2c-87af-f2fc2bfc70d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114c30b0>]}
[0m15:13:44.931188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b95bb579-53ef-4b2c-87af-f2fc2bfc70d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118b2b70>]}
[0m15:13:44.931779 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m15:13:44.932189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b95bb579-53ef-4b2c-87af-f2fc2bfc70d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11145f0e0>]}
[0m15:13:44.933839 [info ] [MainThread]: 
[0m15:13:44.934506 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:13:44.935433 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m15:13:44.948267 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m15:13:44.960195 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m15:13:44.961001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:45.533893 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.573 seconds
[0m15:13:45.535994 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m15:13:45.646331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now create_CASPAR_HEALTH_fct_steps)
[0m15:13:45.647056 [debug] [ThreadPool]: Creating schema "database: "CASPAR_HEALTH"
schema: "fct_steps"
"
[0m15:13:45.652311 [debug] [ThreadPool]: Using snowflake connection "create_CASPAR_HEALTH_fct_steps"
[0m15:13:45.652845 [debug] [ThreadPool]: On create_CASPAR_HEALTH_fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "create_CASPAR_HEALTH_fct_steps"} */
create schema if not exists CASPAR_HEALTH.fct_steps
[0m15:13:45.653157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:46.042585 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.389 seconds
[0m15:13:46.044074 [debug] [ThreadPool]: On create_CASPAR_HEALTH_fct_steps: Close
[0m15:13:46.169516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_CASPAR_HEALTH_fct_steps, now list_CASPAR_HEALTH_fct_exercises)
[0m15:13:46.179994 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_exercises"
[0m15:13:46.180483 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_exercises"} */
show objects in CASPAR_HEALTH.fct_exercises limit 10000
[0m15:13:46.180844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:46.870368 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8a175-0203-b56e-0003-18c200013dde
[0m15:13:46.870857 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:13:46.871327 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:13:46.871646 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:13:46.871989 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_exercises: Close
[0m15:13:46.957250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_exercises, now list_CASPAR_HEALTH_public)
[0m15:13:46.960003 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m15:13:46.960456 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m15:13:46.960852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:47.348408 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.388 seconds
[0m15:13:47.350524 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m15:13:47.559308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_dim_patients)
[0m15:13:47.562937 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_dim_patients"
[0m15:13:47.563384 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_dim_patients"} */
show objects in CASPAR_HEALTH.dim_patients limit 10000
[0m15:13:47.563692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:48.121952 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8a175-0203-b55c-0003-18c20001534e
[0m15:13:48.122486 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:13:48.122980 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:13:48.123337 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:13:48.123695 [debug] [ThreadPool]: On list_CASPAR_HEALTH_dim_patients: Close
[0m15:13:48.202190 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_dim_patients, now list_CASPAR_HEALTH_fct_steps)
[0m15:13:48.204753 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_fct_steps"
[0m15:13:48.205210 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_fct_steps"} */
show objects in CASPAR_HEALTH.fct_steps limit 10000
[0m15:13:48.205552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:48.575933 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.370 seconds
[0m15:13:48.577562 [debug] [ThreadPool]: On list_CASPAR_HEALTH_fct_steps: Close
[0m15:13:48.658329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_fct_steps, now list_CASPAR_HEALTH_results_patients)
[0m15:13:48.661025 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_results_patients"
[0m15:13:48.661511 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_results_patients"} */
show objects in CASPAR_HEALTH.results_patients limit 10000
[0m15:13:48.661888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:48.975495 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8a175-0203-b42e-0003-18c200012db6
[0m15:13:48.975971 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:13:48.976501 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:13:48.976910 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:13:48.977278 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: Close
[0m15:13:49.057827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_results_patients, now list_CASPAR_HEALTH_grouped_patients)
[0m15:13:49.060410 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_grouped_patients"
[0m15:13:49.061069 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_grouped_patients"} */
show objects in CASPAR_HEALTH.grouped_patients limit 10000
[0m15:13:49.061619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:13:49.427234 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8a175-0203-b580-0003-18c200017396
[0m15:13:49.427748 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:13:49.428260 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:13:49.428595 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:13:49.428983 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: Close
[0m15:13:49.527419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b95bb579-53ef-4b2c-87af-f2fc2bfc70d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ff3b0>]}
[0m15:13:49.528162 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:13:49.528657 [info ] [MainThread]: 
[0m15:13:49.532223 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_steps
[0m15:13:49.532862 [info ] [Thread-1 (]: 1 of 1 START sql view model fct_steps.fct_steps ................................ [RUN]
[0m15:13:49.533381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_grouped_patients, now model.caspar_health_technical_challenge.fct_steps)
[0m15:13:49.533786 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_steps
[0m15:13:49.542057 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_steps"
[0m15:13:49.543410 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_steps
[0m15:13:49.553085 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:13:49.553871 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
show parameters like 'query_tag' in session
[0m15:13:49.554281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:49.869518 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.315 seconds
[0m15:13:49.871045 [debug] [Thread-1 (]: Setting query_tag to 'fct_steps'. Will reset to '' after materialization.
[0m15:13:49.872428 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:13:49.872906 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
alter session set query_tag = 'fct_steps'
[0m15:13:49.935697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.062 seconds
[0m15:13:49.973296 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:13:49.973899 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
select * from (
        SELECT
    id,
    external_id AS patient_id,
    steps,
    steps * 0.002 AS minutes,
    submission_time::TIMESTAMP_TZ AS submitted_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
    ) as __dbt_sbq
    where false
    limit 0
[0m15:13:50.043040 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.069 seconds
[0m15:13:50.056218 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:13:50.056785 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as number(38, 0))
     as patient_id, 
      
    cast(null as number(38, 0))
     as steps, 
      
    cast(null as number(38, 3))
     as minutes, 
      
    cast(null as timestamp_tz)
     as submitted_at, 
      
    cast(null as timestamp_tz)
     as updated_at
    ) as __dbt_sbq
    where false
    limit 0
[0m15:13:50.291472 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.234 seconds
[0m15:13:50.298021 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_steps"
[0m15:13:50.299614 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:13:50.300035 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
create or replace   view CASPAR_HEALTH.fct_steps.fct_steps
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    steps,
    steps * 0.002 AS minutes,
    submission_time::TIMESTAMP_TZ AS submitted_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
  );
[0m15:13:50.482679 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m15:13:50.504942 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: Close
[0m15:13:50.595377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b95bb579-53ef-4b2c-87af-f2fc2bfc70d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111347020>]}
[0m15:13:50.596150 [info ] [Thread-1 (]: 1 of 1 OK created sql view model fct_steps.fct_steps ........................... [[32mSUCCESS 1[0m in 1.06s]
[0m15:13:50.596878 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_steps
[0m15:13:50.598712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:50.599142 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.fct_steps' was properly closed.
[0m15:13:50.599475 [info ] [MainThread]: 
[0m15:13:50.599845 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.67 seconds (5.67s).
[0m15:13:50.600763 [debug] [MainThread]: Command end result
[0m15:13:50.636267 [info ] [MainThread]: 
[0m15:13:50.636839 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:50.637259 [info ] [MainThread]: 
[0m15:13:50.638074 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:13:50.639125 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.977304, "process_in_blocks": "0", "process_kernel_time": 0.742528, "process_mem_max_rss": "137359360", "process_out_blocks": "0", "process_user_time": 4.600153}
[0m15:13:50.639625 [debug] [MainThread]: Command `dbt run` succeeded at 15:13:50.639522 after 8.98 seconds
[0m15:13:50.640074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109245c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9ab4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c11820>]}
[0m15:13:50.640439 [debug] [MainThread]: Flushing usage events
[0m15:14:41.183747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691a5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099385c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109938380>]}


============================== 15:14:41.206394 | 485d8cfb-9742-4b29-aa7c-6b935d37f49e ==============================
[0m15:14:41.206394 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:14:41.207230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_steps', 'send_anonymous_usage_stats': 'True'}
[0m15:14:41.920438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '485d8cfb-9742-4b29-aa7c-6b935d37f49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109938410>]}
[0m15:14:41.980765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '485d8cfb-9742-4b29-aa7c-6b935d37f49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10990c320>]}
[0m15:14:41.982319 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:14:42.139771 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:14:42.241900 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:14:42.242452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '485d8cfb-9742-4b29-aa7c-6b935d37f49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e7e1b0>]}
[0m15:14:43.799472 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:14:43.804281 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:14:43.810246 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:14:43.815535 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:14:43.818856 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:14:43.922865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '485d8cfb-9742-4b29-aa7c-6b935d37f49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9eb170>]}
[0m15:14:44.035753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '485d8cfb-9742-4b29-aa7c-6b935d37f49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a928320>]}
[0m15:14:44.036416 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m15:14:44.036811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '485d8cfb-9742-4b29-aa7c-6b935d37f49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9c7110>]}
[0m15:14:44.038468 [info ] [MainThread]: 
[0m15:14:44.039187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:14:44.040088 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m15:14:44.055181 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m15:14:44.055754 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m15:14:44.056118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:44.619501 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.563 seconds
[0m15:14:44.621261 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m15:14:44.705028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m15:14:44.714940 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m15:14:44.715483 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m15:14:44.715974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:45.040286 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.324 seconds
[0m15:14:45.042263 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m15:14:45.117908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_results_patients)
[0m15:14:45.122617 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_results_patients"
[0m15:14:45.123237 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_results_patients"} */
show objects in CASPAR_HEALTH.results_patients limit 10000
[0m15:14:45.123577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:45.480558 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8a176-0203-b42e-0003-18c200012dde
[0m15:14:45.481033 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:14:45.481498 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:14:45.481817 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:14:45.482227 [debug] [ThreadPool]: On list_CASPAR_HEALTH_results_patients: Close
[0m15:14:45.557791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_results_patients, now list_CASPAR_HEALTH_public)
[0m15:14:45.560303 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m15:14:45.560796 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m15:14:45.561213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:45.859425 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.298 seconds
[0m15:14:45.861327 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m15:14:45.937549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_grouped_patients)
[0m15:14:45.941166 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_grouped_patients"
[0m15:14:45.941732 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_grouped_patients"} */
show objects in CASPAR_HEALTH.grouped_patients limit 10000
[0m15:14:45.942077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:46.230931 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b8a176-0203-b706-0003-18c20001921a
[0m15:14:46.231389 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m15:14:46.231863 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m15:14:46.232219 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:14:46.232566 [debug] [ThreadPool]: On list_CASPAR_HEALTH_grouped_patients: Close
[0m15:14:46.311346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '485d8cfb-9742-4b29-aa7c-6b935d37f49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a71f380>]}
[0m15:14:46.312377 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:46.313055 [info ] [MainThread]: 
[0m15:14:46.316600 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_steps
[0m15:14:46.317529 [info ] [Thread-1 (]: 1 of 1 START sql view model transform.fct_steps ................................ [RUN]
[0m15:14:46.318463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_grouped_patients, now model.caspar_health_technical_challenge.fct_steps)
[0m15:14:46.319288 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_steps
[0m15:14:46.327837 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_steps"
[0m15:14:46.330017 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_steps
[0m15:14:46.345517 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:14:46.346119 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
show parameters like 'query_tag' in session
[0m15:14:46.346860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:46.704646 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.358 seconds
[0m15:14:46.706405 [debug] [Thread-1 (]: Setting query_tag to 'fct_steps'. Will reset to '' after materialization.
[0m15:14:46.707686 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:14:46.708168 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
alter session set query_tag = 'fct_steps'
[0m15:14:46.775601 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.067 seconds
[0m15:14:46.812832 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:14:46.813372 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
select * from (
        SELECT
    id,
    external_id AS patient_id,
    steps,
    steps * 0.002 AS minutes,
    submission_time::TIMESTAMP_TZ AS submitted_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
    ) as __dbt_sbq
    where false
    limit 0
[0m15:14:46.889561 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.076 seconds
[0m15:14:46.902863 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:14:46.903486 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as number(38, 0))
     as patient_id, 
      
    cast(null as number(38, 0))
     as steps, 
      
    cast(null as number(38, 3))
     as minutes, 
      
    cast(null as timestamp_tz)
     as submitted_at, 
      
    cast(null as timestamp_tz)
     as updated_at
    ) as __dbt_sbq
    where false
    limit 0
[0m15:14:47.094692 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.191 seconds
[0m15:14:47.102285 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_steps"
[0m15:14:47.103947 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:14:47.104513 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
create or replace   view CASPAR_HEALTH.transform.fct_steps
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    steps,
    steps * 0.002 AS minutes,
    submission_time::TIMESTAMP_TZ AS submitted_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
  );
[0m15:14:47.376071 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.271 seconds
[0m15:14:47.402363 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: Close
[0m15:14:47.481030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485d8cfb-9742-4b29-aa7c-6b935d37f49e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a35ee10>]}
[0m15:14:47.481885 [info ] [Thread-1 (]: 1 of 1 OK created sql view model transform.fct_steps ........................... [[32mSUCCESS 1[0m in 1.16s]
[0m15:14:47.482732 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_steps
[0m15:14:47.484179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:47.484582 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.fct_steps' was properly closed.
[0m15:14:47.484931 [info ] [MainThread]: 
[0m15:14:47.485276 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m15:14:47.485952 [debug] [MainThread]: Command end result
[0m15:14:47.521314 [info ] [MainThread]: 
[0m15:14:47.522333 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:47.522988 [info ] [MainThread]: 
[0m15:14:47.523522 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:14:47.524255 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.428261, "process_in_blocks": "0", "process_kernel_time": 0.625, "process_mem_max_rss": "137228288", "process_out_blocks": "0", "process_user_time": 4.18019}
[0m15:14:47.524943 [debug] [MainThread]: Command `dbt run` succeeded at 15:14:47.524809 after 6.43 seconds
[0m15:14:47.525616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109477aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10990ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691a5a0>]}
[0m15:14:47.526994 [debug] [MainThread]: Flushing usage events
[0m15:17:08.271001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dcfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e48770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e48530>]}


============================== 15:17:08.278539 | a4000d2d-54ba-400a-99e1-efc00c9a23e7 ==============================
[0m15:17:08.278539 [info ] [MainThread]: Running with dbt=1.8.9
[0m15:17:08.279287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:17:08.948928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4000d2d-54ba-400a-99e1-efc00c9a23e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a8a40>]}
[0m15:17:09.009256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4000d2d-54ba-400a-99e1-efc00c9a23e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf2510>]}
[0m15:17:09.011189 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:17:09.171762 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m15:17:09.271085 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:17:09.271677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a4000d2d-54ba-400a-99e1-efc00c9a23e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d88fb0>]}
[0m15:17:10.849121 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:17:10.854090 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:17:10.860153 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:17:10.864164 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:17:10.868408 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m15:17:10.966896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4000d2d-54ba-400a-99e1-efc00c9a23e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f7f500>]}
[0m15:17:11.073137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4000d2d-54ba-400a-99e1-efc00c9a23e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1ecc0>]}
[0m15:17:11.073681 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m15:17:11.074047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4000d2d-54ba-400a-99e1-efc00c9a23e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa27e0>]}
[0m15:17:11.075945 [info ] [MainThread]: 
[0m15:17:11.076639 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:17:11.081595 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m15:17:11.095542 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m15:17:11.096017 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m15:17:11.096357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:11.633833 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.537 seconds
[0m15:17:11.635981 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m15:17:11.754316 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m15:17:11.755031 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m15:17:11.755376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:12.048742 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.293 seconds
[0m15:17:12.050414 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m15:17:12.136648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m15:17:12.148317 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m15:17:12.148754 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m15:17:12.149153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:12.678085 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.529 seconds
[0m15:17:12.680168 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m15:17:12.811389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m15:17:12.814906 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m15:17:12.815325 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m15:17:12.815837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:13.192283 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.376 seconds
[0m15:17:13.194126 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m15:17:13.311605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_analysis)
[0m15:17:13.314989 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m15:17:13.315516 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m15:17:13.316077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:13.708060 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.392 seconds
[0m15:17:13.709791 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m15:17:13.813310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4000d2d-54ba-400a-99e1-efc00c9a23e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9c290>]}
[0m15:17:13.813964 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:13.814355 [info ] [MainThread]: 
[0m15:17:13.817307 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.dim_patients
[0m15:17:13.817918 [info ] [Thread-1 (]: 1 of 5 START sql view model transform.dim_patients ............................. [RUN]
[0m15:17:13.818424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now model.caspar_health_technical_challenge.dim_patients)
[0m15:17:13.818795 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.dim_patients
[0m15:17:13.826139 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.dim_patients"
[0m15:17:13.828523 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.dim_patients
[0m15:17:13.838254 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m15:17:13.838754 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
show parameters like 'query_tag' in session
[0m15:17:13.839145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:14.130342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.291 seconds
[0m15:17:14.131731 [debug] [Thread-1 (]: Setting query_tag to 'dim_patients'. Will reset to '' after materialization.
[0m15:17:14.132403 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m15:17:14.132791 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
alter session set query_tag = 'dim_patients'
[0m15:17:14.233044 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m15:17:14.271209 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m15:17:14.271878 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
    ) as __dbt_sbq
    where false
    limit 0
[0m15:17:14.366969 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.095 seconds
[0m15:17:14.381782 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m15:17:14.382367 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country
    ) as __dbt_sbq
    where false
    limit 0
[0m15:17:14.445304 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.062 seconds
[0m15:17:14.452481 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.dim_patients"
[0m15:17:14.454699 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.dim_patients"
[0m15:17:14.455241 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.dim_patients"} */
create or replace   view CASPAR_HEALTH.transform.dim_patients
  
   as (
    SELECT
    patient_id AS id,
    first_name,
    last_name,
    country
FROM CASPAR_HEALTH.public.stg_patients
  );
[0m15:17:14.692469 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.237 seconds
[0m15:17:14.717799 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.dim_patients: Close
[0m15:17:14.802410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4000d2d-54ba-400a-99e1-efc00c9a23e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106387470>]}
[0m15:17:14.803285 [info ] [Thread-1 (]: 1 of 5 OK created sql view model transform.dim_patients ........................ [[32mSUCCESS 1[0m in 0.98s]
[0m15:17:14.804088 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.dim_patients
[0m15:17:14.804712 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_exercises
[0m15:17:14.805334 [info ] [Thread-1 (]: 2 of 5 START sql view model transform.fct_exercises ............................ [RUN]
[0m15:17:14.806122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.dim_patients, now model.caspar_health_technical_challenge.fct_exercises)
[0m15:17:14.806687 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_exercises
[0m15:17:14.810013 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_exercises"
[0m15:17:14.813320 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_exercises
[0m15:17:14.816220 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m15:17:14.816828 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
show parameters like 'query_tag' in session
[0m15:17:14.817253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:15.188303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.371 seconds
[0m15:17:15.189715 [debug] [Thread-1 (]: Setting query_tag to 'fct_exercises'. Will reset to '' after materialization.
[0m15:17:15.190370 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m15:17:15.190753 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
alter session set query_tag = 'fct_exercises'
[0m15:17:15.254691 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.064 seconds
[0m15:17:15.257614 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m15:17:15.258195 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
select * from (
        SELECT
    id,
    external_id AS patient_id,
    minutes,
    completed_at::TIMESTAMP_TZ AS completed_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_exercises
    ) as __dbt_sbq
    where false
    limit 0
[0m15:17:15.327549 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.069 seconds
[0m15:17:15.329559 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m15:17:15.330074 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as number(38, 0))
     as patient_id, 
      
    cast(null as number(38, 0))
     as minutes, 
      
    cast(null as timestamp_tz)
     as completed_at, 
      
    cast(null as timestamp_tz)
     as updated_at
    ) as __dbt_sbq
    where false
    limit 0
[0m15:17:15.566982 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.236 seconds
[0m15:17:15.568938 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_exercises"
[0m15:17:15.571526 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_exercises"
[0m15:17:15.572081 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_exercises"} */
create or replace   view CASPAR_HEALTH.transform.fct_exercises
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    minutes,
    completed_at::TIMESTAMP_TZ AS completed_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_exercises
  );
[0m15:17:15.796378 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.224 seconds
[0m15:17:15.798687 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_exercises: Close
[0m15:17:15.882814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4000d2d-54ba-400a-99e1-efc00c9a23e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844cf80>]}
[0m15:17:15.883534 [info ] [Thread-1 (]: 2 of 5 OK created sql view model transform.fct_exercises ....................... [[32mSUCCESS 1[0m in 1.08s]
[0m15:17:15.884361 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_exercises
[0m15:17:15.884861 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.fct_steps
[0m15:17:15.885468 [info ] [Thread-1 (]: 3 of 5 START sql view model transform.fct_steps ................................ [RUN]
[0m15:17:15.885995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.fct_exercises, now model.caspar_health_technical_challenge.fct_steps)
[0m15:17:15.886392 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.fct_steps
[0m15:17:15.889701 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.fct_steps"
[0m15:17:15.891483 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.fct_steps
[0m15:17:15.893890 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:17:15.894354 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
show parameters like 'query_tag' in session
[0m15:17:15.894703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:16.195297 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.301 seconds
[0m15:17:16.196879 [debug] [Thread-1 (]: Setting query_tag to 'fct_steps'. Will reset to '' after materialization.
[0m15:17:16.197654 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:17:16.198423 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
alter session set query_tag = 'fct_steps'
[0m15:17:16.366058 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.167 seconds
[0m15:17:16.368408 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:17:16.368876 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
select * from (
        SELECT
    id,
    external_id AS patient_id,
    steps,
    steps * 0.002 AS minutes,
    submission_time::TIMESTAMP_TZ AS submitted_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
    ) as __dbt_sbq
    where false
    limit 0
[0m15:17:16.455801 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.086 seconds
[0m15:17:16.457700 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:17:16.458147 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as number(38, 0))
     as patient_id, 
      
    cast(null as number(38, 0))
     as steps, 
      
    cast(null as number(38, 3))
     as minutes, 
      
    cast(null as timestamp_tz)
     as submitted_at, 
      
    cast(null as timestamp_tz)
     as updated_at
    ) as __dbt_sbq
    where false
    limit 0
[0m15:17:16.550733 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.092 seconds
[0m15:17:16.552225 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.fct_steps"
[0m15:17:16.554140 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.fct_steps"
[0m15:17:16.554655 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.fct_steps"} */
create or replace   view CASPAR_HEALTH.transform.fct_steps
  
   as (
    SELECT
    id,
    external_id AS patient_id,
    steps,
    steps * 0.002 AS minutes,
    submission_time::TIMESTAMP_TZ AS submitted_at,
    updated_at::TIMESTAMP_TZ AS updated_at
FROM CASPAR_HEALTH.public.stg_steps
  );
[0m15:17:16.785981 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.231 seconds
[0m15:17:16.788027 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.fct_steps: Close
[0m15:17:16.880142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4000d2d-54ba-400a-99e1-efc00c9a23e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108361d90>]}
[0m15:17:16.880853 [info ] [Thread-1 (]: 3 of 5 OK created sql view model transform.fct_steps ........................... [[32mSUCCESS 1[0m in 0.99s]
[0m15:17:16.881489 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.fct_steps
[0m15:17:16.882361 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.grouped_patients
[0m15:17:16.883286 [info ] [Thread-1 (]: 4 of 5 START sql view model analysis.grouped_patients .......................... [RUN]
[0m15:17:16.884067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.fct_steps, now model.caspar_health_technical_challenge.grouped_patients)
[0m15:17:16.884520 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.grouped_patients
[0m15:17:16.888338 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.grouped_patients"
[0m15:17:16.890775 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.grouped_patients
[0m15:17:16.893989 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:17:16.894595 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
show parameters like 'query_tag' in session
[0m15:17:16.895149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:17.451838 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.557 seconds
[0m15:17:17.453339 [debug] [Thread-1 (]: Setting query_tag to 'grouped_patients'. Will reset to '' after materialization.
[0m15:17:17.454239 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:17:17.454674 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
alter session set query_tag = 'grouped_patients'
[0m15:17:17.852539 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m15:17:17.856781 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:17:17.857686 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
select * from (
        SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.minutes) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.minutes) AS total_minutes
FROM  CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.transform.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.transform.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
    ) as __dbt_sbq
    where false
    limit 0
[0m15:17:18.311952 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.454 seconds
[0m15:17:18.314252 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:17:18.314851 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country, 
      
    cast(null as number(38, 0))
     as exercises_minutes, 
      
    cast(null as number(38, 3))
     as steps_minutes, 
      
    cast(null as number(38, 3))
     as total_minutes
    ) as __dbt_sbq
    where false
    limit 0
[0m15:17:18.454293 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.139 seconds
[0m15:17:18.455947 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.grouped_patients"
[0m15:17:18.458483 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m15:17:18.459156 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
create or replace   view CASPAR_HEALTH.analysis.grouped_patients
  
   as (
    SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.minutes) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.minutes) AS total_minutes
FROM  CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.transform.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.transform.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
  );
[0m15:17:19.541761 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.082 seconds
[0m15:17:19.543692 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: Close
[0m15:17:19.621233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4000d2d-54ba-400a-99e1-efc00c9a23e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e83f80>]}
[0m15:17:19.621990 [info ] [Thread-1 (]: 4 of 5 OK created sql view model analysis.grouped_patients ..................... [[32mSUCCESS 1[0m in 2.74s]
[0m15:17:19.622661 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.grouped_patients
[0m15:17:19.623351 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.results_patients
[0m15:17:19.624015 [info ] [Thread-1 (]: 5 of 5 START sql view model analysis.results_patients .......................... [RUN]
[0m15:17:19.624541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.caspar_health_technical_challenge.grouped_patients, now model.caspar_health_technical_challenge.results_patients)
[0m15:17:19.624931 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.results_patients
[0m15:17:19.628321 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.results_patients"
[0m15:17:19.629438 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.results_patients
[0m15:17:19.631735 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m15:17:19.632378 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
show parameters like 'query_tag' in session
[0m15:17:19.632848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:19.956619 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.324 seconds
[0m15:17:19.958043 [debug] [Thread-1 (]: Setting query_tag to 'results_patients'. Will reset to '' after materialization.
[0m15:17:19.958692 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m15:17:19.959227 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
alter session set query_tag = 'results_patients'
[0m15:17:20.019670 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.060 seconds
[0m15:17:20.022218 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m15:17:20.022815 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
select * from (
        WITH top_minutes_patient AS (
SELECT
  MAX_BY(patients_grouped.id, patients_grouped.total_minutes) AS id
FROM CASPAR_HEALTH.analysis.grouped_patients
  AS patients_grouped
)

SELECT
  top_minutes_patient.id,
  dim_patients.first_name,
  dim_patients.last_name,
  dim_patients.country
FROM top_minutes_patient
LEFT JOIN CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
  ON dim_patients.id =   top_minutes_patient.id
    ) as __dbt_sbq
    where false
    limit 0
[0m15:17:20.241198 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.218 seconds
[0m15:17:20.242917 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m15:17:20.243363 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country
    ) as __dbt_sbq
    where false
    limit 0
[0m15:17:20.296425 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.053 seconds
[0m15:17:20.297692 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.results_patients"
[0m15:17:20.299702 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m15:17:20.300142 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
create or replace   view CASPAR_HEALTH.analysis.results_patients
  
   as (
    WITH top_minutes_patient AS (
SELECT
  MAX_BY(patients_grouped.id, patients_grouped.total_minutes) AS id
FROM CASPAR_HEALTH.analysis.grouped_patients
  AS patients_grouped
)

SELECT
  top_minutes_patient.id,
  dim_patients.first_name,
  dim_patients.last_name,
  dim_patients.country
FROM top_minutes_patient
LEFT JOIN CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
  ON dim_patients.id =   top_minutes_patient.id
  );
[0m15:17:20.703882 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.403 seconds
[0m15:17:20.706671 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: Close
[0m15:17:20.802444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4000d2d-54ba-400a-99e1-efc00c9a23e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0c2f0>]}
[0m15:17:20.803338 [info ] [Thread-1 (]: 5 of 5 OK created sql view model analysis.results_patients ..................... [[32mSUCCESS 1[0m in 1.18s]
[0m15:17:20.804643 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.results_patients
[0m15:17:20.808194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:20.809160 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.results_patients' was properly closed.
[0m15:17:20.809902 [info ] [MainThread]: 
[0m15:17:20.810495 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 9.73 seconds (9.73s).
[0m15:17:20.811950 [debug] [MainThread]: Command end result
[0m15:17:20.945947 [info ] [MainThread]: 
[0m15:17:20.946526 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:20.946914 [info ] [MainThread]: 
[0m15:17:20.947279 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:17:20.947926 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.760839, "process_in_blocks": "0", "process_kernel_time": 0.650053, "process_mem_max_rss": "136138752", "process_out_blocks": "0", "process_user_time": 4.531086}
[0m15:17:20.948534 [debug] [MainThread]: Command `dbt run` succeeded at 15:17:20.948366 after 12.76 seconds
[0m15:17:20.949101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067bc230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106202b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dcfc50>]}
[0m15:17:20.949563 [debug] [MainThread]: Flushing usage events
[0m16:06:00.793125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8814c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110028560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110028230>]}


============================== 16:06:00.800281 | ac59c637-5057-4f5c-b53d-95d6a464162d ==============================
[0m16:06:00.800281 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:06:00.800931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'version_check': 'True', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select grouped_patients', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:06:01.556722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac59c637-5057-4f5c-b53d-95d6a464162d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107d2e70>]}
[0m16:06:01.615412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac59c637-5057-4f5c-b53d-95d6a464162d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110afd460>]}
[0m16:06:01.618261 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:06:01.783358 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:06:02.030920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m16:06:02.031949 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/fct_steps.yml
[0m16:06:02.032625 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/dim_patients.yml
[0m16:06:02.033161 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/transform/fct_exercises.yml
[0m16:06:02.033690 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/grouped_patients.sql
[0m16:06:02.315822 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m16:06:02.320424 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m16:06:02.325635 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m16:06:02.329907 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m16:06:02.403744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac59c637-5057-4f5c-b53d-95d6a464162d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110f1b50>]}
[0m16:06:02.526288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac59c637-5057-4f5c-b53d-95d6a464162d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d8f680>]}
[0m16:06:02.526851 [info ] [MainThread]: Found 5 models, 3 seeds, 577 macros
[0m16:06:02.527251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac59c637-5057-4f5c-b53d-95d6a464162d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111eac00>]}
[0m16:06:02.528939 [info ] [MainThread]: 
[0m16:06:02.529571 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:06:02.530521 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m16:06:02.546480 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m16:06:02.546987 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m16:06:02.547526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:03.653231 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.105 seconds
[0m16:06:03.655090 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m16:06:03.899584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_transform)
[0m16:06:03.910019 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m16:06:03.910578 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m16:06:03.910884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:04.353066 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.442 seconds
[0m16:06:04.355179 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m16:06:04.448561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_public)
[0m16:06:04.451682 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m16:06:04.452190 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m16:06:04.452626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:04.795651 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.343 seconds
[0m16:06:04.845830 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m16:06:05.029849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_analysis)
[0m16:06:05.034583 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m16:06:05.035121 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m16:06:05.035472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:05.719986 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.684 seconds
[0m16:06:05.721810 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m16:06:05.932693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac59c637-5057-4f5c-b53d-95d6a464162d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e3da60>]}
[0m16:06:05.933468 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:06:05.933955 [info ] [MainThread]: 
[0m16:06:05.938434 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.grouped_patients
[0m16:06:05.939408 [info ] [Thread-1 (]: 1 of 1 START sql view model analysis.grouped_patients .......................... [RUN]
[0m16:06:05.940253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now model.caspar_health_technical_challenge.grouped_patients)
[0m16:06:05.940815 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.grouped_patients
[0m16:06:05.951535 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.grouped_patients"
[0m16:06:05.954310 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.grouped_patients
[0m16:06:05.965260 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m16:06:05.979662 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
show parameters like 'query_tag' in session
[0m16:06:05.980788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:06:06.457616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m16:06:06.459124 [debug] [Thread-1 (]: Setting query_tag to 'grouped_patients'. Will reset to '' after materialization.
[0m16:06:06.460339 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m16:06:06.460821 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
alter session set query_tag = 'grouped_patients'
[0m16:06:06.549223 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m16:06:06.600396 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m16:06:06.601064 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
select * from (
        SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.minutes) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.minutes) AS total_minutes,
    RANK() OVER (ORDER BY (SUM(fct_exercises.minutes) + SUM(fct_steps.minutes)) desc) AS row_number
FROM  CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.transform.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.transform.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
    ) as __dbt_sbq
    where false
    limit 0
[0m16:06:06.869550 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.268 seconds
[0m16:06:06.890442 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m16:06:06.891091 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country, 
      
    cast(null as number(38, 0))
     as exercises_minutes, 
      
    cast(null as number(38, 3))
     as steps_minutes, 
      
    cast(null as number(38, 3))
     as total_minutes
    ) as __dbt_sbq
    where false
    limit 0
[0m16:06:07.226469 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.335 seconds
[0m16:06:07.238420 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: Close
[0m16:06:07.385620 [debug] [Thread-1 (]: Compilation Error in model grouped_patients (models/analysis/grouped_patients.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason     |
  | ----------- | --------------- | ------------- | ------------------- |
  | ROW_NUMBER  | FIXED           |               | missing in contract |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro snowflake__create_view_as_with_temp_flag (macros/relations/view/create.sql)
  > called by macro snowflake__create_view_as (macros/relations/view/create.sql)
  > called by macro create_view_as (macros/relations/view/create.sql)
  > called by macro default__get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro snowflake__create_or_replace_view (macros/relations/view/create.sql)
  > called by macro materialization_view_snowflake (macros/materializations/view.sql)
  > called by model grouped_patients (models/analysis/grouped_patients.sql)
[0m16:06:07.388742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac59c637-5057-4f5c-b53d-95d6a464162d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110762b70>]}
[0m16:06:07.390056 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analysis.grouped_patients ................. [[31mERROR[0m in 1.45s]
[0m16:06:07.391283 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.grouped_patients
[0m16:06:07.393867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:07.394339 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.grouped_patients' was properly closed.
[0m16:06:07.394755 [info ] [MainThread]: 
[0m16:06:07.395225 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.87 seconds (4.87s).
[0m16:06:07.396066 [debug] [MainThread]: Command end result
[0m16:06:07.437068 [info ] [MainThread]: 
[0m16:06:07.437707 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:06:07.438207 [info ] [MainThread]: 
[0m16:06:07.439295 [error] [MainThread]:   Compilation Error in model grouped_patients (models/analysis/grouped_patients.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name | definition_type | contract_type | mismatch_reason     |
  | ----------- | --------------- | ------------- | ------------------- |
  | ROW_NUMBER  | FIXED           |               | missing in contract |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro snowflake__create_view_as_with_temp_flag (macros/relations/view/create.sql)
  > called by macro snowflake__create_view_as (macros/relations/view/create.sql)
  > called by macro create_view_as (macros/relations/view/create.sql)
  > called by macro default__get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro snowflake__create_or_replace_view (macros/relations/view/create.sql)
  > called by macro materialization_view_snowflake (macros/materializations/view.sql)
  > called by model grouped_patients (models/analysis/grouped_patients.sql)
[0m16:06:07.440407 [info ] [MainThread]: 
[0m16:06:07.441046 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:06:07.441876 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.74236, "process_in_blocks": "0", "process_kernel_time": 0.772204, "process_mem_max_rss": "132857856", "process_out_blocks": "0", "process_user_time": 3.124305}
[0m16:06:07.442506 [debug] [MainThread]: Command `dbt run` failed at 16:06:07.442381 after 6.74 seconds
[0m16:06:07.442977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8814c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fdae40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e0a900>]}
[0m16:06:07.443587 [debug] [MainThread]: Flushing usage events
[0m16:07:30.368389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa84a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052586e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105258470>]}


============================== 16:07:30.376450 | e6af2362-a2eb-4dd0-9678-9a78f83b8ae4 ==============================
[0m16:07:30.376450 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:07:30.377098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'profiles_dir': '/Users/jonfernandez/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select grouped_patients', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:07:31.103956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6af2362-a2eb-4dd0-9678-9a78f83b8ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104826000>]}
[0m16:07:31.180380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6af2362-a2eb-4dd0-9678-9a78f83b8ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ad250>]}
[0m16:07:31.195047 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:07:31.361231 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:07:31.585925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m16:07:31.586726 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/grouped_patients.yml
[0m16:07:31.587256 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/results_patients.sql
[0m16:07:31.587732 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/grouped_patients.sql
[0m16:07:31.883104 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m16:07:31.886250 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m16:07:31.956424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6af2362-a2eb-4dd0-9678-9a78f83b8ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f4b30>]}
[0m16:07:32.058743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6af2362-a2eb-4dd0-9678-9a78f83b8ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606f4d0>]}
[0m16:07:32.059302 [info ] [MainThread]: Found 3 seeds, 5 models, 577 macros
[0m16:07:32.059722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6af2362-a2eb-4dd0-9678-9a78f83b8ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106462c30>]}
[0m16:07:32.061685 [info ] [MainThread]: 
[0m16:07:32.062387 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:07:32.063253 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m16:07:32.078597 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m16:07:32.079102 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m16:07:32.079498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:33.128762 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.049 seconds
[0m16:07:33.131290 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m16:07:33.225374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_public)
[0m16:07:33.236201 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m16:07:33.236799 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m16:07:33.237144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:33.650522 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.413 seconds
[0m16:07:33.652423 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m16:07:33.998289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_transform)
[0m16:07:34.001435 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m16:07:34.001888 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m16:07:34.002219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:35.064885 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.063 seconds
[0m16:07:35.066607 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m16:07:35.196470 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now list_CASPAR_HEALTH_analysis)
[0m16:07:35.199411 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m16:07:35.200715 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m16:07:35.201071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:35.685922 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.485 seconds
[0m16:07:35.688858 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m16:07:35.829183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6af2362-a2eb-4dd0-9678-9a78f83b8ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e84a0>]}
[0m16:07:35.829922 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:07:35.830368 [info ] [MainThread]: 
[0m16:07:35.833312 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.grouped_patients
[0m16:07:35.833932 [info ] [Thread-1 (]: 1 of 1 START sql view model analysis.grouped_patients .......................... [RUN]
[0m16:07:35.834494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now model.caspar_health_technical_challenge.grouped_patients)
[0m16:07:35.834846 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.grouped_patients
[0m16:07:35.845857 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.grouped_patients"
[0m16:07:35.847150 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.grouped_patients
[0m16:07:35.857383 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m16:07:35.857954 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
show parameters like 'query_tag' in session
[0m16:07:35.858338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:36.109871 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.251 seconds
[0m16:07:36.111688 [debug] [Thread-1 (]: Setting query_tag to 'grouped_patients'. Will reset to '' after materialization.
[0m16:07:36.112965 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m16:07:36.113467 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
alter session set query_tag = 'grouped_patients'
[0m16:07:36.266287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m16:07:36.311333 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m16:07:36.312092 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
select * from (
        SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.minutes) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.minutes) AS total_minutes,
    RANK() OVER (ORDER BY (SUM(fct_exercises.minutes) + SUM(fct_steps.minutes)) desc) AS total_minutes_rank
FROM  CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.transform.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.transform.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
    ) as __dbt_sbq
    where false
    limit 0
[0m16:07:36.445197 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.133 seconds
[0m16:07:36.459560 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m16:07:36.460196 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country, 
      
    cast(null as number(38, 0))
     as exercises_minutes, 
      
    cast(null as number(38, 3))
     as steps_minutes, 
      
    cast(null as number(38, 3))
     as total_minutes, 
      
    cast(null as number(38, 3))
     as total_minutes_rank
    ) as __dbt_sbq
    where false
    limit 0
[0m16:07:36.538785 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.078 seconds
[0m16:07:36.545460 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.grouped_patients"
[0m16:07:36.548503 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.grouped_patients"
[0m16:07:36.549218 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.grouped_patients"} */
create or replace   view CASPAR_HEALTH.analysis.grouped_patients
  
   as (
    SELECT
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country,
    SUM(fct_exercises.minutes) AS exercises_minutes,
    SUM(fct_steps.minutes) AS steps_minutes,
    SUM(fct_exercises.minutes) + SUM(fct_steps.minutes) AS total_minutes,
    RANK() OVER (ORDER BY (SUM(fct_exercises.minutes) + SUM(fct_steps.minutes)) desc) AS total_minutes_rank
FROM  CASPAR_HEALTH.transform.dim_patients
  AS dim_patients
LEFT JOIN  CASPAR_HEALTH.transform.fct_exercises
  AS fct_exercises
  ON fct_exercises.patient_id = dim_patients.id
LEFT JOIN  CASPAR_HEALTH.transform.fct_steps
  AS fct_steps
  ON fct_steps.patient_id = dim_patients.id
GROUP BY
    dim_patients.id,
    dim_patients.first_name,
    dim_patients.last_name,
    dim_patients.country
  );
[0m16:07:37.244304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.694 seconds
[0m16:07:37.271646 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.grouped_patients: Close
[0m16:07:37.354015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6af2362-a2eb-4dd0-9678-9a78f83b8ae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a3ef0>]}
[0m16:07:37.354830 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analysis.grouped_patients ..................... [[32mSUCCESS 1[0m in 1.52s]
[0m16:07:37.355607 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.grouped_patients
[0m16:07:37.357052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:37.357441 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.grouped_patients' was properly closed.
[0m16:07:37.357778 [info ] [MainThread]: 
[0m16:07:37.358177 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m16:07:37.359253 [debug] [MainThread]: Command end result
[0m16:07:37.412387 [info ] [MainThread]: 
[0m16:07:37.413012 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:37.413442 [info ] [MainThread]: 
[0m16:07:37.413814 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:07:37.414568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.153621, "process_in_blocks": "0", "process_kernel_time": 0.657022, "process_mem_max_rss": "132468736", "process_out_blocks": "0", "process_user_time": 3.112936}
[0m16:07:37.415154 [debug] [MainThread]: Command `dbt run` succeeded at 16:07:37.415046 after 7.15 seconds
[0m16:07:37.415731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d5ca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104737050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101c25010>]}
[0m16:07:37.416384 [debug] [MainThread]: Flushing usage events
[0m16:09:39.346595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec8af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d786b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d78470>]}


============================== 16:09:39.353818 | 9c3a15e2-dfca-43f3-a685-83daf546d653 ==============================
[0m16:09:39.353818 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:09:39.354832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select results_patients', 'send_anonymous_usage_stats': 'True'}
[0m16:09:40.040214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c3a15e2-dfca-43f3-a685-83daf546d653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d79dc0>]}
[0m16:09:40.104740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c3a15e2-dfca-43f3-a685-83daf546d653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d8cd10>]}
[0m16:09:40.106519 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:09:40.259959 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:09:40.473086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:09:40.473818 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/results_patients.sql
[0m16:09:40.743557 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m16:09:40.813146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c3a15e2-dfca-43f3-a685-83daf546d653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d03890>]}
[0m16:09:40.923734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c3a15e2-dfca-43f3-a685-83daf546d653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ebb9b0>]}
[0m16:09:40.924303 [info ] [MainThread]: Found 3 seeds, 5 models, 577 macros
[0m16:09:40.924709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c3a15e2-dfca-43f3-a685-83daf546d653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11283a840>]}
[0m16:09:40.926455 [info ] [MainThread]: 
[0m16:09:40.927170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:09:40.928214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m16:09:40.942715 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m16:09:40.943195 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m16:09:40.943559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:41.594069 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.650 seconds
[0m16:09:41.596078 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m16:09:41.681847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_analysis)
[0m16:09:41.692029 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m16:09:41.692645 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m16:09:41.693109 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:42.034567 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.341 seconds
[0m16:09:42.036420 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m16:09:42.125983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_public)
[0m16:09:42.129495 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m16:09:42.130070 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m16:09:42.130399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:42.436039 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.306 seconds
[0m16:09:42.437980 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m16:09:42.518563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_transform)
[0m16:09:42.521999 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m16:09:42.522481 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m16:09:42.523083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:42.812960 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.290 seconds
[0m16:09:42.814987 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m16:09:42.894329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c3a15e2-dfca-43f3-a685-83daf546d653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ebab10>]}
[0m16:09:42.895131 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:09:42.895643 [info ] [MainThread]: 
[0m16:09:42.899154 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.results_patients
[0m16:09:42.899928 [info ] [Thread-1 (]: 1 of 1 START sql view model analysis.results_patients .......................... [RUN]
[0m16:09:42.900491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now model.caspar_health_technical_challenge.results_patients)
[0m16:09:42.900888 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.results_patients
[0m16:09:42.908961 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.results_patients"
[0m16:09:42.910684 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.results_patients
[0m16:09:42.922376 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m16:09:42.922926 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
show parameters like 'query_tag' in session
[0m16:09:42.923360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:43.209145 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.286 seconds
[0m16:09:43.210778 [debug] [Thread-1 (]: Setting query_tag to 'results_patients'. Will reset to '' after materialization.
[0m16:09:43.212196 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m16:09:43.212790 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
alter session set query_tag = 'results_patients'
[0m16:09:43.292123 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m16:09:43.331911 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m16:09:43.332480 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
select * from (
        SELECT
  id AS patient_id,
  first_name,
  last_name,
  country,
  total_minutes
FROM CASPAR_HEALTH.analysis.grouped_patients
WHERE total_minutes_rank = 1
    ) as __dbt_sbq
    where false
    limit 0
[0m16:09:43.580273 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.247 seconds
[0m16:09:43.593599 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m16:09:43.594156 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country
    ) as __dbt_sbq
    where false
    limit 0
[0m16:09:43.661190 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.066 seconds
[0m16:09:43.668474 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: Close
[0m16:09:43.760357 [debug] [Thread-1 (]: Compilation Error in model results_patients (models/analysis/results_patients.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name   | definition_type | contract_type | mismatch_reason       |
  | ------------- | --------------- | ------------- | --------------------- |
  | ID            |                 | FIXED         | missing in definition |
  | PATIENT_ID    | FIXED           |               | missing in contract   |
  | TOTAL_MINUTES | FIXED           |               | missing in contract   |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro snowflake__create_view_as_with_temp_flag (macros/relations/view/create.sql)
  > called by macro snowflake__create_view_as (macros/relations/view/create.sql)
  > called by macro create_view_as (macros/relations/view/create.sql)
  > called by macro default__get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro snowflake__create_or_replace_view (macros/relations/view/create.sql)
  > called by macro materialization_view_snowflake (macros/materializations/view.sql)
  > called by model results_patients (models/analysis/results_patients.sql)
[0m16:09:43.762065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c3a15e2-dfca-43f3-a685-83daf546d653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11287bb30>]}
[0m16:09:43.762886 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analysis.results_patients ................. [[31mERROR[0m in 0.86s]
[0m16:09:43.763719 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.results_patients
[0m16:09:43.765714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:43.766178 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.results_patients' was properly closed.
[0m16:09:43.766556 [info ] [MainThread]: 
[0m16:09:43.767018 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m16:09:43.768014 [debug] [MainThread]: Command end result
[0m16:09:43.813965 [info ] [MainThread]: 
[0m16:09:43.814601 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:09:43.814983 [info ] [MainThread]: 
[0m16:09:43.815451 [error] [MainThread]:   Compilation Error in model results_patients (models/analysis/results_patients.sql)
  This model has an enforced contract that failed.
  Please ensure the name, data_type, and number of columns in your contract match the columns in your model's definition.
  
  | column_name   | definition_type | contract_type | mismatch_reason       |
  | ------------- | --------------- | ------------- | --------------------- |
  | ID            |                 | FIXED         | missing in definition |
  | PATIENT_ID    | FIXED           |               | missing in contract   |
  | TOTAL_MINUTES | FIXED           |               | missing in contract   |
  
  
  > in macro assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro default__get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro get_assert_columns_equivalent (macros/relations/column/columns_spec_ddl.sql)
  > called by macro snowflake__create_view_as_with_temp_flag (macros/relations/view/create.sql)
  > called by macro snowflake__create_view_as (macros/relations/view/create.sql)
  > called by macro create_view_as (macros/relations/view/create.sql)
  > called by macro default__get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro get_create_view_as_sql (macros/relations/view/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro snowflake__create_or_replace_view (macros/relations/view/create.sql)
  > called by macro materialization_view_snowflake (macros/materializations/view.sql)
  > called by model results_patients (models/analysis/results_patients.sql)
[0m16:09:43.816593 [info ] [MainThread]: 
[0m16:09:43.817101 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:09:43.817768 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.5607667, "process_in_blocks": "0", "process_kernel_time": 0.602452, "process_mem_max_rss": "133492736", "process_out_blocks": "0", "process_user_time": 2.947476}
[0m16:09:43.818266 [debug] [MainThread]: Command `dbt run` failed at 16:09:43.818164 after 4.56 seconds
[0m16:09:43.818679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d78350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d78440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec8af60>]}
[0m16:09:43.819431 [debug] [MainThread]: Flushing usage events
[0m16:10:30.208362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fd1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111658620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116583e0>]}


============================== 16:10:30.215098 | cc0ebd16-b701-457b-908c-bf31a48f27e2 ==============================
[0m16:10:30.215098 [info ] [MainThread]: Running with dbt=1.8.9
[0m16:10:30.216021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jonfernandez/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jonfernandez/Documents/caspar_health_technical_challenge/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select results_patients', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:10:30.927386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc0ebd16-b701-457b-908c-bf31a48f27e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eabca10>]}
[0m16:10:30.987201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc0ebd16-b701-457b-908c-bf31a48f27e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121ab830>]}
[0m16:10:30.989424 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:10:31.179316 [debug] [MainThread]: checksum: 132857a23e9d07220246854f7763165174ce9b737cfc7867629ace4294e520b1, vars: {}, profile: , target: , version: 1.8.9
[0m16:10:31.399212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:10:31.400011 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/grouped_patients.yml
[0m16:10:31.400551 [debug] [MainThread]: Partial parsing: updated file: caspar_health_technical_challenge://models/analysis/results_patients.yml
[0m16:10:31.694443 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m16:10:31.698274 [warn ] [MainThread]: [[33mWARNING[0m]: Constraint types are not supported for view materializations
and will be ignored.  Set 'warn_unsupported: false' on this constraint to ignore
this warning.
[0m16:10:31.770171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc0ebd16-b701-457b-908c-bf31a48f27e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f81d0>]}
[0m16:10:31.884692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc0ebd16-b701-457b-908c-bf31a48f27e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11243b410>]}
[0m16:10:31.885481 [info ] [MainThread]: Found 3 seeds, 5 models, 577 macros
[0m16:10:31.886047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc0ebd16-b701-457b-908c-bf31a48f27e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11268b530>]}
[0m16:10:31.888856 [info ] [MainThread]: 
[0m16:10:31.889693 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:10:31.891181 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_CASPAR_HEALTH'
[0m16:10:31.908798 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH"
[0m16:10:31.909289 [debug] [ThreadPool]: On list_CASPAR_HEALTH: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH"} */
show terse schemas in database CASPAR_HEALTH
    limit 10000
[0m16:10:31.909882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:32.486462 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.577 seconds
[0m16:10:32.488533 [debug] [ThreadPool]: On list_CASPAR_HEALTH: Close
[0m16:10:32.597925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH, now list_CASPAR_HEALTH_analysis)
[0m16:10:32.607283 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_analysis"
[0m16:10:32.620848 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_analysis"} */
show objects in CASPAR_HEALTH.analysis limit 10000
[0m16:10:32.621353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:32.979423 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.358 seconds
[0m16:10:32.981465 [debug] [ThreadPool]: On list_CASPAR_HEALTH_analysis: Close
[0m16:10:33.063991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_analysis, now list_CASPAR_HEALTH_public)
[0m16:10:33.067213 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_public"
[0m16:10:33.067656 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_public"} */
show objects in CASPAR_HEALTH.public limit 10000
[0m16:10:33.067970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:33.448602 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.381 seconds
[0m16:10:33.450349 [debug] [ThreadPool]: On list_CASPAR_HEALTH_public: Close
[0m16:10:33.945965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_public, now list_CASPAR_HEALTH_transform)
[0m16:10:33.948952 [debug] [ThreadPool]: Using snowflake connection "list_CASPAR_HEALTH_transform"
[0m16:10:33.949414 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "connection_name": "list_CASPAR_HEALTH_transform"} */
show objects in CASPAR_HEALTH.transform limit 10000
[0m16:10:33.949815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:10:34.465837 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.516 seconds
[0m16:10:34.467680 [debug] [ThreadPool]: On list_CASPAR_HEALTH_transform: Close
[0m16:10:34.557203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc0ebd16-b701-457b-908c-bf31a48f27e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11297d700>]}
[0m16:10:34.557902 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:10:34.558339 [info ] [MainThread]: 
[0m16:10:34.560971 [debug] [Thread-1 (]: Began running node model.caspar_health_technical_challenge.results_patients
[0m16:10:34.561629 [info ] [Thread-1 (]: 1 of 1 START sql view model analysis.results_patients .......................... [RUN]
[0m16:10:34.562190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_CASPAR_HEALTH_transform, now model.caspar_health_technical_challenge.results_patients)
[0m16:10:34.562723 [debug] [Thread-1 (]: Began compiling node model.caspar_health_technical_challenge.results_patients
[0m16:10:34.571778 [debug] [Thread-1 (]: Writing injected SQL for node "model.caspar_health_technical_challenge.results_patients"
[0m16:10:34.572852 [debug] [Thread-1 (]: Began executing node model.caspar_health_technical_challenge.results_patients
[0m16:10:34.584227 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m16:10:34.585330 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
show parameters like 'query_tag' in session
[0m16:10:34.585964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:35.134422 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m16:10:35.136107 [debug] [Thread-1 (]: Setting query_tag to 'results_patients'. Will reset to '' after materialization.
[0m16:10:35.137312 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m16:10:35.137822 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
alter session set query_tag = 'results_patients'
[0m16:10:35.238385 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m16:10:35.277326 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m16:10:35.277873 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
select * from (
        SELECT
  id AS patient_id,
  first_name,
  last_name,
  country,
  total_minutes
FROM CASPAR_HEALTH.analysis.grouped_patients
WHERE total_minutes_rank = 1
    ) as __dbt_sbq
    where false
    limit 0
[0m16:10:35.425413 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.147 seconds
[0m16:10:35.440843 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m16:10:35.441421 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
/* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
select * from (
        select
    
      
    cast(null as number(38, 0))
     as patient_id, 
      
    cast(null as varchar(16777216))
     as first_name, 
      
    cast(null as varchar(16777216))
     as last_name, 
      
    cast(null as varchar(16777216))
     as country, 
      
    cast(null as number(38, 3))
     as total_minutes
    ) as __dbt_sbq
    where false
    limit 0
[0m16:10:35.535904 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.094 seconds
[0m16:10:35.542090 [debug] [Thread-1 (]: Writing runtime sql for node "model.caspar_health_technical_challenge.results_patients"
[0m16:10:35.543401 [debug] [Thread-1 (]: Using snowflake connection "model.caspar_health_technical_challenge.results_patients"
[0m16:10:35.543874 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: /* {"app": "dbt", "dbt_version": "1.8.9", "profile_name": "caspar_health_technical_challenge", "target_name": "dev", "node_id": "model.caspar_health_technical_challenge.results_patients"} */
create or replace   view CASPAR_HEALTH.analysis.results_patients
  
   as (
    SELECT
  id AS patient_id,
  first_name,
  last_name,
  country,
  total_minutes
FROM CASPAR_HEALTH.analysis.grouped_patients
WHERE total_minutes_rank = 1
  );
[0m16:10:35.768043 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.224 seconds
[0m16:10:35.793988 [debug] [Thread-1 (]: On model.caspar_health_technical_challenge.results_patients: Close
[0m16:10:35.962665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc0ebd16-b701-457b-908c-bf31a48f27e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11207ae70>]}
[0m16:10:35.964092 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analysis.results_patients ..................... [[32mSUCCESS 1[0m in 1.40s]
[0m16:10:35.965132 [debug] [Thread-1 (]: Finished running node model.caspar_health_technical_challenge.results_patients
[0m16:10:35.967543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:35.968337 [debug] [MainThread]: Connection 'model.caspar_health_technical_challenge.results_patients' was properly closed.
[0m16:10:35.968821 [info ] [MainThread]: 
[0m16:10:35.969361 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.08 seconds (4.08s).
[0m16:10:35.970566 [debug] [MainThread]: Command end result
[0m16:10:36.024401 [info ] [MainThread]: 
[0m16:10:36.025547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:36.026439 [info ] [MainThread]: 
[0m16:10:36.027105 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:10:36.028074 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9046655, "process_in_blocks": "0", "process_kernel_time": 0.713651, "process_mem_max_rss": "132935680", "process_out_blocks": "0", "process_user_time": 3.240509}
[0m16:10:36.029117 [debug] [MainThread]: Command `dbt run` succeeded at 16:10:36.028881 after 5.91 seconds
[0m16:10:36.029770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fd1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111c5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111089a60>]}
[0m16:10:36.030782 [debug] [MainThread]: Flushing usage events
